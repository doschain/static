{"version":3,"sources":["components/GlobalContext/index.js","components/MaskLoading/index.js","components/index.js","Router.js","service/index.js","App.js","index.js","utils/elementToPageTop.js","utils/asyncComponent.js","utils/basicURL.js","utils/parseQuery.js","utils/toast.js","utils/axios.js","utils/index.js"],"names":["GlobalContext","React","createContext","connect","formatter","Component","forwardRef","props","ref","Consumer","updateStore","rest","store","Object","assign","domNode","document","getElementById","Loading","ReactDOM","createPortal","className","Home","asyncComponent","children","exact","path","component","hosts","window","apiHost","App","initial","useState","state","saveState","setState","useCallback","newState","prev","useSetState","address","balance","utxoLength","utxoSummary","utxoData","loadUtxo","useEffect","a","demos","getIdentity","currency","reloadData","toast","getAddress","getAddressBalance","getAddressUTXO","request","getBalance","then","data","getUTXO","obj","forEach","item","txid","vout","height","keys","length","i","reverse","slice","satoshis","j","toString","console","log","Provider","value","Router","html","getElementsByTagName","resize","style","fontSize","Math","min","body","clientWidth","addEventListener","initHtmlFontSize","render","elementToPageTop","importComponent","default","this","C","process","axios","create","baseURL","timeout","msg","duration","isNaN","m","createElement","innerHTML","cssText","appendChild","setTimeout","webkitTransition","opacity","removeChild","d"],"mappings":"yHACMA,EAAgBC,IAAMC,cAAc,MACpCC,EAAU,SAAAC,GACd,OAAO,SAAAC,GACL,OAAOC,sBAAW,SAACC,EAAOC,GAAR,OAChB,kBAACR,EAAcS,SAAf,MACG,YAA+B,IAA5BC,EAA2B,EAA3BA,YAAgBC,EAAW,+BACzBC,EAAQC,OAAOC,OAAO,GAAIH,GAI9B,MAHyB,oBAAdP,IACTQ,EAAQR,EAAUQ,IAGlB,kBAACP,EAAD,iBACME,EACAK,EAFN,CAGEF,YAAaA,EACbF,IAAKA,a,sCCXfO,G,MAAUC,SAASC,eAAe,SAEvB,SAASC,IAEpB,OAAOC,IAASC,aACZ,yBAAKC,UAAS,kBACV,yBAAKA,UAAU,uBACX,yBAAKA,UAAU,0BAGvBN,G,MCfR,uG,uSCIMO,EAAOC,aAAe,kBAAM,gCAEnB,cAAsB,EAAXC,SACtB,OACI,kBAAC,IAAD,KACI,yBAAKH,UAAU,WACX,yBAAKA,UAAU,QACX,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAOI,OAAK,EAACC,KAAK,IAAIC,UAAWL,SCRrDM,EAAQC,OAAOC,QCqHJC,MA3Gf,WAAgB,IAAD,EARG,WAAmB,IAAlBC,EAAiB,uDAAP,GAAO,EACLC,mBAASD,GADJ,mBACzBE,EADyB,KAClBC,EADkB,KAE1BC,EAAWC,uBAAY,SAACC,GAC5BH,GAAU,SAAAI,GAAI,sBAASA,EAAT,GAAkBD,QAC/B,IAEH,MAAO,CAACJ,EAAOE,GAGWI,CAAY,CAClCC,QAAS,GACTC,QAAS,EACTC,WAAY,EACZC,YAAa,EACbC,SAAU,GACVC,UAAU,IAPH,mBACJZ,EADI,KACGE,EADH,KAUL1B,EAAc,SAAA4B,GAChBF,EAASE,IAGbS,qBAAW,WAAM,4CASb,8BAAAC,EAAA,sEAEgBnB,OAAOoB,MAAMC,cAF7B,yDAGgBrB,OAAOoB,MAAMC,cAH7B,iCACST,EADT,EACSA,QAKW,QANpB,EACkBU,UAMVzC,EAAY,CAAC+B,YACbW,EAAWX,IAEXY,YAAM,sDAAe,KAV7B,6CATa,0DAuBbC,KACD,IAEH,IAAMF,EAAa,SAACX,GAChBc,EAAkBd,GAClBe,EAAef,IAGbc,EAAoB,SAACd,IDpDL,SAACA,GAEvB,OAAOZ,OAAOoB,MAAMQ,QAAQ,CAAC,OAAU,MAAO,IAAM,GAAN,OAAU7B,EAAV,qBAA4Ba,EAA5B,eCmD1CiB,CAAWjB,GAASkB,MAAK,SAACC,GACtBlD,EAAY,CAACgC,QAASkB,QAIxBJ,EAAiB,SAACf,GACpB/B,EAAY,CAACoC,UAAU,IDrDR,SAACL,GAEpB,OAAOZ,OAAOoB,MAAMQ,QAAQ,CAAC,OAAU,MAAO,IAAM,GAAN,OAAU7B,EAAV,qBAA4Ba,EAA5B,WCoD1CoB,CAAQpB,GAASkB,MAAK,SAACC,GACnBlD,EAAY,CAACoC,UAAU,IACvB,IAAIgB,EAAM,GACNlB,EAAc,GACjBgB,GAAQ,IAAIG,SAAQ,SAACC,GAAU,IACrBC,EAAsBD,EAAtBC,KAAMC,EAAgBF,EAAhBE,KAAgBF,EAAVG,SACPL,EAAI,GAAD,OAAIG,EAAJ,YAAYC,IAAUF,MAOzC,IAJA,IAAII,EAAOvD,OAAOuD,KAAKN,GACnBnB,EAAayB,EAAKC,OAClBxB,EAAW,GAEPyB,EAAE,EAAGA,EAAEF,EAAKC,OAAQC,IACxBzB,EAASyB,GAAIR,EAAIM,EAAKE,IAG1BzB,EAAS0B,UACT1B,EAAWA,EAAS2B,MAAM,EAAG,KAE7B,IAAI,IAAIF,EAAI,EAAGA,EAAIzB,EAASwB,OAAQC,IAAI,CACpC,IAAIN,EAAOnB,EAASyB,GAEpB1B,GADiBoB,EAAZS,SAQL,IADA,IAAIL,EAAOvD,OAAOuD,KAAKJ,GACfU,EAAI,EAAGA,EAAIN,EAAKC,OAAQK,IAC5BV,EAAKI,EAAKM,IAAMV,EAAKI,EAAKM,IAAIC,WAItCC,QAAQC,IAAIjC,GAEZlC,EAAY,CAACiC,aAAYC,cAAaC,gBAEvC,WACCnC,EAAY,CAACoC,UAAU,IACvBO,YAAM,4CAKd,OACI,kBAAC,IAAcyB,SAAf,CAAwBC,MAAK,eAAO7C,EAAP,CAAcxB,cAAa0C,WAAYA,KAC/DlB,EAAMY,UAAY,kBAAC,IAAD,MACnB,kBAACkC,EAAD,SC/Ga,WACrB,IAAMC,EAAOjE,SAASkE,qBAAqB,QAAQ,GAC7CC,EAAS,WACXF,EAAKG,MAAMC,SAAWC,KAAKC,IAAIvE,SAASwE,KAAKC,YAAc,IAAK,KAAO,MAE3E5D,OAAO6D,iBAAiB,SAAUP,GAAQ,GAC1CA,IAEJQ,GACAxE,IAASyE,OAAO,kBAAC,EAAD,MAAS5E,SAASC,eAAe,U,+BCVlC4E,I,gFCFA,WAAAC,GA0BX,OA1B8B,YAE1B,WAAYvF,GAAQ,IAAD,8BACf,4CAAMA,KAED2B,MAAQ,CACTP,UAAW,MAJA,EAFO,mNAWemE,IAXf,gBAWLnE,EAXK,EAWdoE,QAERC,KAAK5D,SAAS,CACVT,UAAWA,IAdO,qIAmBtB,IAAMsE,EAAID,KAAK9D,MAAMP,UAErB,OAAOsE,EAAI,kBAAEA,EAAMD,KAAKzF,OACnB,SAtBiB,GACDN,IAAMI,YCF5B,GAAD,OAAK6F,mDAAL,W,MC0CK,I,QC3CA,G,OCIEC,EAAMC,OAAO,CAI5BC,QAAS,WACTC,QAAS,MDTI,SAAUC,EAAKC,GAC5BA,EAAWC,MAAMD,GAAY,IAAOA,EACpC,IAAME,EAAI1F,SAAS2F,cAAc,OACjCD,EAAEE,UAAYL,EACdG,EAAEtB,MAAMyB,QAAQ,2RAChB7F,SAASwE,KAAKsB,YAAYJ,GAC1BK,YAAW,WAETL,EAAEtB,MAAM4B,iBAAmB,uDAC3BN,EAAEtB,MAAM6B,QAAU,IAClBF,YAAW,WAAa/F,SAASwE,KAAK0B,YAAYR,KAAMS,OACvDX,KEXL,sE","file":"static/js/main.1eb97476.chunk.js","sourcesContent":["import React, { forwardRef } from \"react\";\nconst GlobalContext = React.createContext(null);\nconst connect = formatter => {\n  return Component => {\n    return forwardRef((props, ref) => (\n      <GlobalContext.Consumer>\n        {({ updateStore, ...rest }) => {\n          let store = Object.assign({}, rest);\n          if (typeof formatter === \"function\") {\n            store = formatter(store);\n          }\n          return (\n            <Component\n              {...props}\n              {...store}\n              updateStore={updateStore}\n              ref={ref}\n            />\n          );\n        }}\n      </GlobalContext.Consumer>\n    ));\n  };\n};\n\nexport { GlobalContext, connect };\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\nimport './style.scss';\n\n// let domNode = document.body;\nlet domNode = document.getElementById('root');\n\nexport default function Loading () {\n\n    return ReactDOM.createPortal(\n        <div className={`c-mask-loading`}>\n            <div className='c-mask-loading-card'>\n                <div className='c-mask-loading-spin' />\n            </div>\n        </div>,\n        domNode\n    );\n\n}\n","export { GlobalContext, connect } from \"./GlobalContext\";\nexport {default as Card} from \"./Card\";\nexport {default as Loading} from \"./Loading\";\nexport {default as Input} from \"./Input\";\nexport {default as MaskLoading} from \"./MaskLoading\";\nexport {default as Modal} from \"./Modal\";\n","import React from \"react\";\nimport { HashRouter as Router, Route, Switch, Link } from \"react-router-dom\";\nimport { asyncComponent } from \"./utils\";\n\nconst Home = asyncComponent(() => import(\"./pages/Home\"));\n\nexport default function ({children}) {\n    return (\n        <Router>\n            <div className='wrapper'>\n                <div className='main'>\n                    <Switch>\n                        <Route exact path=\"/\" component={Home} />\n                    </Switch>\n                </div>\n            </div>\n        </Router>\n    )\n};\n","import {axios} from '../utils'\n\n// let hosts = 'http://proxy-mainnet.doschain.org/insight'; // 正式环境\n// let hosts = 'https://testnet.doschain.org/insight'; // 测试环境\nlet hosts = window.apiHost;\n\n/** 获取余额 **/\nexport const getBalance = (address) => {\n    // return axios.get(`/api/addr/${address}/balance`)\n    return window.demos.request({\"method\": \"GET\", \"url\": `${hosts}/api/addr/${address}/balance`});\n};\n\n/** 获取UTXO **/\nexport const getUTXO = (address) => {\n    // return axios.get(`/api/addr/${address}/utxo`);\n    return window.demos.request({\"method\": \"GET\", \"url\": `${hosts}/api/addr/${address}/utxo`});\n};\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { GlobalContext, MaskLoading } from \"./components\";\nimport Router from \"./Router\";\nimport {toast} from \"./utils\"\nimport \"./css/global.scss\";\nimport {getBalance, getUTXO} from \"./service\";\nlet useSetState = (initial = {}) => {\n    const [state, saveState] = useState(initial);\n    const setState = useCallback((newState) => {\n      saveState(prev => ({...prev, ...newState}))\n    }, []);\n\n    return [state, setState];\n  };\nfunction App() {\n    const [state, setState] = useSetState({\n        address: '',\n        balance: 0,\n        utxoLength: 0,\n        utxoSummary: 0,\n        utxoData: [],\n        loadUtxo: false\n    });\n\n    const updateStore = newState => {\n        setState(newState);\n    };\n\n    useEffect( () => {\n        function addr() {\n            return new Promise(function (resolve) {\n                setTimeout(function () {\n                    // resolve({address: 'TcS8a787PfU8b754FeqWHbQFSykGUDpY4Uu'})\n                    resolve({address: 'TcASfmyoFiNobNaCHeiPMkWgGmovoxk1sqk', currency: 'DOS'})\n                }, 100)\n            })\n        }\n        async function getAddress () {\n            let {address, currency} = process.env.NODE_ENV === 'production'\n                ? await window.demos.getIdentity()\n                : await window.demos.getIdentity();\n            // : await addr();\n\n            if(currency === 'DOS') {\n                updateStore({address});\n                reloadData(address);\n            } else {\n                toast('请切换到DOS钱包再试', 60000);\n            }\n        }\n\n        getAddress();\n    }, []);\n\n    const reloadData = (address) => {\n        getAddressBalance(address);\n        getAddressUTXO(address);\n    };\n\n    const getAddressBalance = (address) => {\n        getBalance(address).then((data) => {\n            updateStore({balance: data});\n        });\n    };\n\n    const getAddressUTXO = (address) => {\n        updateStore({loadUtxo: true});\n        getUTXO(address).then((data) => {\n            updateStore({loadUtxo: false});\n            let obj = {};\n            let utxoSummary = 0;\n            (data || []).forEach((item) => {\n                const {txid, vout, height} = item;\n                if (height) obj[`${txid}-${vout}`] = item;\n            });\n\n            let keys = Object.keys(obj);\n            let utxoLength = keys.length;\n            let utxoData = [];\n\n            for(let i=0; i<keys.length; i++) {\n                utxoData[i]= obj[keys[i]];\n            }\n\n            utxoData.reverse();\n            utxoData = utxoData.slice(0, 220);\n\n            for(let i = 0; i < utxoData.length; i++){\n                let item = utxoData[i];\n                let {satoshis} = item;\n                utxoSummary += satoshis;\n\n                // console.log('--------------');\n                // console.log(utxoSummary);\n                // console.log(satoshis);\n                // console.log('==============');\n                let keys = Object.keys(item);\n                for(let j = 0; j < keys.length; j++){\n                    item[keys[j]] = item[keys[j]].toString();\n                }\n            }\n\n            console.log(utxoSummary);\n\n            updateStore({utxoLength, utxoSummary, utxoData})\n\n        }, function () {\n            updateStore({loadUtxo: false});\n            toast('数据获取失败');\n        });\n    };\n\n\n    return (\n        <GlobalContext.Provider value={{ ...state, updateStore, reloadData: reloadData}}>\n            {state.loadUtxo && <MaskLoading />}\n            <Router />\n        </GlobalContext.Provider>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/global.scss';\nimport App from './App';\n\nconst initHtmlFontSize = () => {\n    const html = document.getElementsByTagName('html')[0];\n    const resize = () => {\n        html.style.fontSize = Math.min(document.body.clientWidth / 7.5, 100) + 'px';\n    };\n    window.addEventListener('resize', resize, false);\n    resize();\n};\ninitHtmlFontSize();\nReactDOM.render(<App />, document.getElementById('root'));\n","function elementToPageTop(el) {\n    return el.offsetParent ? elementToPageTop(el.offsetParent) + el.offsetTop : el.offsetTop\n}\n\nexport default elementToPageTop\n","import React from \"react\";\n\nexport default importComponent => {\n    class AsyncComponent extends React.Component {\n        constructor(props) {\n            super(props);\n\n            this.state = {\n                component: null\n            };\n        }\n\n        async componentDidMount() {\n            const { default: component } = await importComponent();\n\n            this.setState({\n                component: component\n            });\n        }\n\n        render() {\n            const C = this.state.component;\n\n            return C ? < C {...this.props }\n            /> : null;\n        }\n    }\n\n    return AsyncComponent;\n};","export default {\n    imgSrc: `${process.env.PUBLIC_URL}/images`\n};\n","function isObject(obj) {\n    if (obj === 0) return false;\n    return (\n        obj &&\n        obj.constructor &&\n        obj.constructor.toString().match(/function\\s*([^(]*)/)[1] === \"Object\"\n    );\n}\n\n/**\n *\n * @param {Object} params\n */\nfunction formatQuery(params) {\n    if (!isObject(params)) return \"\";\n\n    let query = \"\";\n    for (const key in params) {\n        query += `${key}=${params[key]}&`;\n    }\n    return query.slice(0, -1);\n}\n\n/**\n * @des 获取query参数\n */\n\nfunction getQuery(key) {\n    let query = window.location.search.slice(1);\n    query = query.split(\"&\");\n\n    if (query.length === 0) return null;\n    const queryObjs = {};\n\n    query.forEach(item => {\n        const [key, value] = item.split(\"=\");\n        queryObjs[key] = value;\n    });\n\n    if (!key) return queryObjs;\n    return queryObjs[key] || null;\n}\n\nexport default { formatQuery, getQuery };","export default function (msg, duration){\n  duration = isNaN(duration) ? 3000 : duration;\n  const m = document.createElement('div');\n  m.innerHTML = msg;\n  m.style.cssText=\"max-width:80%;min-width: 80px;padding: 10px 14px;word-break: break-all;line-height:1.5;color: rgb(255, 255, 255);text-align: center;border-radius: 4px;position: fixed;top: 50%;left: 50%;transform: translate(-50%, -50%);z-index: 999999;background: rgba(0, 0, 0,.7);font-size: 16px;\";\n  document.body.appendChild(m);\n  setTimeout(function() {\n    const d = 0.5;\n    m.style.webkitTransition = '-webkit-transform ' + d + 's ease-in, opacity ' + d + 's ease-in';\n    m.style.opacity = '0';\n    setTimeout(function() { document.body.removeChild(m) }, d * 1000);\n  }, duration);\n};\n","import axios from 'axios'\n// import {getAuth} from \"./auth\";\n// import {message} from \"antd\";\n// import history from \"../history\";\nconst instance = axios.create({\n  // baseURL: 'https://dapp.doschain.org/cracy/',\n  // baseURL: process.env.NODE_ENV === 'production' ? 'https://dapp.doschain.org/recharge' : '/recharge',\n  // baseURL: 'https://games-testnet.doschain.org/recharge',\n  baseURL: '/insight',\n  timeout: 10000,\n});\n\n// 拦截器\n// instance.interceptors.response.use((response) => {\n//   if (response.data && response.data.errCode === \"1\") {\n//     const msg = response.data.errMsg;\n//     msg && message.error(msg);\n//     history.push('/login');\n//   }\n//   return response\n// }, (error) => {\n//   return Promise.reject(error)\n// });\n//\n// instance.interceptors.request.use((config) => {\n//   if (config.data && config.method === 'post') {\n//     config.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n//     let ret = '';\n//     for (let it in config.data) {\n//       ret += encodeURIComponent(it) + '=' + encodeURIComponent(config.data[it]) + '&'\n//     }\n//     config.data = ret.substring(0, ret.length - 1);\n//   }\n//\n//   const token = getAuth();\n//   if (token) {\n//     if (config.method === 'get') {\n//       config.params = Object.assign(config.params || {}, {token});\n//     } else if (config.method === 'post'){\n//       config.data = `${config.data ? `${config.data}&` : ''}token=${token}`\n//     }\n//   }\n//\n//   return config\n// }, (error) => {\n//   return Promise.reject(error)\n// });\n\nexport default instance\n","export { default as className } from \"./className\";\nexport { default as elementToPageTop } from \"./elementToPageTop\";\nexport { default as addZero } from \"./addZero\";\nexport { default as asyncComponent } from \"./asyncComponent\";\nexport { default as basicURL } from \"./basicURL\";\nexport { default as parseQuery } from \"./parseQuery\";\nexport { default as axios } from \"./axios\";\nexport { default as toast } from \"./toast\";\nexport { default as returnTxCache } from \"./returnTxCache\";\n"],"sourceRoot":""}