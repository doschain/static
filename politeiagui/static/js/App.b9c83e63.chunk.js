(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{10:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"AccountActivityBox",function(){return ra}),a.d(n,"CommentArea",function(){return V}),a.d(n,"CommentForm",function(){return re}),a.d(n,"Content",function(){return Me}),a.d(n,"Expando",function(){return Re.a}),a.d(n,"Header",function(){return Ve}),a.d(n,"HeaderBottomLeft",function(){return He}),a.d(n,"Link",function(){return L}),a.d(n,"LoadingIcon",function(){return se}),a.d(n,"LoginForm",function(){return Ge}),a.d(n,"LoginFormSide",function(){return Je}),a.d(n,"LoginSignupPage",function(){return $e}),a.d(n,"Markdown",function(){return et.a}),a.d(n,"NavButtons",function(){return oa}),a.d(n,"NestedListing",function(){return tt}),a.d(n,"OrganicListing",function(){return ia}),a.d(n,"PageLoadingIcon",function(){return le}),a.d(n,"RecentlyViewedLinks",function(){return sa}),a.d(n,"RegisterForm",function(){return mt}),a.d(n,"Sidebar",function(){return pt}),a.d(n,"SidebarAd",function(){return la}),a.d(n,"SidebarSearch",function(){return bt}),a.d(n,"SidebarTitlebox",function(){return vt}),a.d(n,"SiteTable",function(){return yt}),a.d(n,"SrHeaderArea",function(){return ca}),a.d(n,"SubmitPage",function(){return Ft}),a.d(n,"SubmitLinkSidebox",function(){return ua}),a.d(n,"SubmitTextSidebox",function(){return Tt}),a.d(n,"Subreddit",function(){return Wt}),a.d(n,"Thing",function(){return Ht}),a.d(n,"ThingComment",function(){return Yt}),a.d(n,"ThingLink",function(){return ta}),a.d(n,"UserInfo",function(){return aa.a});var r=a(12),o=a(13),i=a(15),s=a(14),l=a(16),c=a(0),u=a.n(c),m=a(1275),d=a(1272),p=a(21),h=a(1137),f=a.n(h),b=a(331),v=a(17),y=a(24),g=a(221),E=a(55),O=a(33),w=a(41),j=a.n(w),C=a(38),k=a.n(C),x=a(36),S=a(18),P=a(19),N=a(166),I=Object(p.b)(S.Vd({token:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","token"]),Object(x.b)(1)),commentid:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","commentid"]),Object(x.b)(1)),tempThreadTree:S.wb,userid:S.pe,censoredComment:S.Q,loggedInAsEmail:S.Zc,isAdmin:S.Yb,record:S.Ad,comments:S.Cd,invoice:S.Sb,invoiceComments:S.Tb,commentslikes:S.S,error:Object(x.f)(S.Gd,S.x),isLoading:Object(x.f)(S.Hd,S.Zd,S.yc),markdownFile:S.pb,otherFiles:S.sb,commentsSortOption:S.T,openedModals:S.Ob,isCMS:S.Mc}),function(e){return Object(O.b)({onFetchData:P.A,onSetReplyParent:P.Eb,onFetchProposalVoteStatus:P.F,onFetchLikedComments:P.y,onSetCommentsSortOption:P.Bb,resetLastSubmittedProposal:P.Tb},e)}),A=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).handleViewAllClick=function(e){e&&e.preventDefault()&&e.stopPropagation(),a.props.isCMS?a.props.history.push("/invoices/".concat(a.props.token)):a.props.history.push("/proposals/".concat(a.props.token))},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.onSetReplyParent()}},{key:"render",value:function(){var e=this.props,t=e.Component,a=Object(y.a)(e,["Component"]),n=(a.isCMS?Object(N.a)(a.invoiceComments,a.commentid):Object(N.a)(a.comments,a.commentid)).tree,r=Object(N.b)(n);return u.a.createElement(t,Object(v.a)({},a,{onViewAllClick:this.handleViewAllClick,numofcomments:r.size}))}}]),t}(u.a.PureComponent),D=function(e){return Object(m.a)(I(function(t){return u.a.createElement(A,Object(v.a)({},t,{Component:e}))}))},F=a(109),T=a(23),M=a(60),R=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).scrollToCommentArea=function(){var e=document.getElementsByClassName("commentarea")[0];if(window.scrollTo(0,0),e&&e.scrollIntoView){e.scrollIntoView();window.scrollTo(0,window.scrollY-100)}},a.onSetCommentsSortOption=function(e){Object(M.d)("sort",e.value),a.props.onSetCommentsSortOption(e)},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.comments,t=Object(M.a)("comments");e&&t&&this.scrollToCommentArea();var a=Object(M.a)("sort");a&&[T.rb,T.sb,T.tb].find(function(e){return e===a})&&this.props.onSetCommentsSortOption({value:a,label:a})}},{key:"render",value:function(){var e=this,t=this.props,a=t.comments,n=t.loggedInAsEmail,r=t.record,o=t.commentsSortOption,i=t.commentid,s=t.onViewAllClick,l=t.token,c=t.numofcomments,m=t.invoice,d=Object(y.a)(t,["comments","loggedInAsEmail","record","commentsSortOption","commentid","onViewAllClick","token","numofcomments","invoice"]);return(0===Object.keys(r).length||r.status===T.eb||r.status===T.fb||r.status===T.cb)&&(0===Object.keys(m).length||m.status===T.q||m.status===T.s)?null:u.a.createElement(E.CommentArea,Object(v.a)({},d,{singleThread:i?u.a.createElement("span",null,"Single comment thread."," ",u.a.createElement("a",{href:d.isCMS?"invoices/".concat(l):"proposals/".concat(l),onClick:s},"View all")):null,locked:!n,name:F.a,num_comments:c,SorterComponent:function(){return a&&c>0?u.a.createElement("div",{className:"comments-sort"},u.a.createElement("span",{className:""},"Sort by:"),u.a.createElement(g.b,{onKeyDown:function(e){return 8===e.keyCode&&e.preventDefault()},classNamePrefix:"sort-select",isSearchable:!1,isClearable:!1,escapeClearsValue:!1,value:o,onChange:e.onSetCommentsSortOption,options:[T.rb,T.sb,T.tb].map(function(e){return{value:e,label:e}})})):null},hideSortOptions:!1}))}}]),t}(u.a.Component),V=D(R),U=a(1266),L=function(e){var t=e.href,a=Object(y.a)(e,["href"]);return a=Object.keys(a).filter(function(e){return e[0]===e[0].toLowerCase()}).reduce(function(e,t){return e[t]=a[t],e},{}),u.a.createElement(U.a,Object.assign({to:t},a))},_=a(27),q=a(338);function W(e){return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,24}$/i.test(e)}function H(e,t){var a=function(e){var t=e.reduce(function(e,t){return" "===t&&(t="\\s"),e+t},"");return t="[".concat(t,"]"),new RegExp(t,"g")}(t);return(e.match(a)||[]).length===e.length}var Y=function(e){var t=function(e){var t=e.match(/\[([^\][]*?)\]([ ]*)\((.*?)\)/gi);if(!t)return{error:!1};var a=!0,n=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value,l=s.match(/\(([^()]*)\)/gi)[0];l=l.slice(1,l.length-1);try{new URL(l);var c=document.createElement("a");if(c.href=l,!c.hostname)return{url:l,error:!0}}catch(u){return{url:l,error:!0}}}}catch(m){n=!0,r=m}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}return{error:!1}}(e);if(t.error)throw new q.a({_error:'The link "'.concat(t.url,'" is invalid. Make sure that it is a valid URL.')})};function z(e,t,a){var n=e.length>=t;return a&&(n&=e.length<=a),n}function B(e,t){return e===t}function K(e){return!!e}var Z,Q,X,G,J=function(e,t){var a=e.values,n=e.keyMismatch;if(!K(a.comment))throw new q.a({_error:"A comment body is required"});if(t.maxcommentlength&&a.comment.length>t.maxcommentlength)throw new q.a({_error:"The comment must be less than ".concat(t.maxcommentlength," characters long")});if(Y(a.comment),n)throw new q.a({_error:"Your local key does not match the one on the server.  Please generate a new one under account settings."})},$=Object(p.b)(S.Vd({commentid:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","commentid"]),Object(x.b)(1)),token:S.Md,proposalStatus:S.Ld,loggedInAsEmail:S.Zc,isAdmin:S.Yb,proposalAuthor:S.Bd,keyMismatch:S.nb,userCanExecuteActions:S.je,replyTo:S.Qd,policy:S.yd,isPostingComment:S.rc,userHasPaid:S.ke,getVoteStatus:S.tb,likeCommentError:S.o,likeCommentPayload:S.p,userAccessTime:S.Wc,lastVisit:S.ye,lastVisitInvoice:S.xe,userid:S.pe,invoice:S.Sb,invoiceToken:S.Xb,isCMS:S.Mc}),{onFetchData:P.Q,onSubmitComment:P.Ib,onSetReplyParent:P.Eb,onLikeComment:P.T,onCensorComment:P.h}),ee=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).toggleCommentForm=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&e.preventDefault&&e.preventDefault(),a.setState({showCommentForm:null!=t?t:!a.state.showCommentForm})},a.onCloseCommentForm=function(){return a.toggleCommentForm(null,!1)},a.onChange=function(e){a.setState({commentValue:e,validationError:""})},a.resetForm=function(){a.setState({commentValue:"",showCommentForm:!1}),a.props.onClose&&a.props.onClose()},a.state={isShowingMarkdownHelp:!1,commentValue:"",validationError:"",showCommentForm:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.policy||this.props.onFetchData()}},{key:"render",value:function(){var e=this.props,t=e.Component,a=e.error,n=Object(y.a)(e,["Component","error"]),r=this.state.validationError;return u.a.createElement(t,Object(v.a)({},n,this.state,{onChange:this.onChange,error:a||r,value:this.state.commentValue,onSave:this.onSave.bind(this),onToggleMarkdownHelp:this.onToggleMarkdownHelp.bind(this),showCommentForm:this.state.showCommentForm,toggleCommentForm:this.toggleCommentForm,onCloseCommentForm:this.onCloseCommentForm}))}},{key:"onSave",value:function(e){var t=this;e&&e.preventDefault&&e.preventDefault();var a=this.props,n=a.loggedInAsEmail,r=a.token,o=a.thingId,i=a.policy,s=a.commentid,l=a.invoiceToken,c=a.isCMS,u=this.state.commentValue.trim();try{J(Object(v.a)({values:{comment:u}},this.props),i)}catch(e){return void this.setState({validationError:e.errors._error})}return this.props.onSubmitComment(n,r||l,u,o,s,c).then(function(){return t.resetForm()})}},{key:"onToggleMarkdownHelp",value:function(){this.setState({isShowingMarkdownHelp:!this.state.isShowingMarkdownHelp})}}]),t}(u.a.PureComponent),te=k()(m.a,function(e){return $(function(t){return u.a.createElement(ee,Object(v.a)({},t,{Component:e}))})}),ae=a(568),ne=a(550),re=te(function(e){var t=e.Link,a=void 0===t?L:t,n=e.isPostingComment,r=e.isShowingMarkdownHelp,o=e.error,i=e.thingId,s=e.onSave,l=e.onToggleMarkdownHelp,c=e.userCanExecuteActions,m=e.getVoteStatus,d=e.token,p=e.proposalStatus,h=e.showContentPolicy,f=void 0!==h&&h,b=e.value,v=e.onChange,y=e.onClose,g=e.hide,E=void 0!==g&&g,O=e.invoice,w=!!e.isCMS&&(O.status===T.o||O.status===T.t||O.status===T.u),j=m(d)&&m(d).status===T.lb,C=p===T.bb;return u.a.createElement(u.a.Fragment,null,u.a.createElement("form",{className:"usertext cloneable warn-on-unload",style:E?{display:"none"}:{},onSubmit:s},o?u.a.createElement(_.a,{type:"error",header:"Error creating comment",body:o}):null,u.a.createElement("input",{name:"parentid",type:"hidden",defaultValue:i}),u.a.createElement("div",{className:"usertext-edit md-container"},n&&u.a.createElement("h2",null,"Posting comment..."),n||j||C||w?j?u.a.createElement(_.a,{height:"70px",type:"info"},u.a.createElement("span",null,"Voting has finished for this proposal. New comments and comment votes are not allowed.")):C?u.a.createElement(_.a,{height:"70px",type:"info"},u.a.createElement("span",null,"This proposal has been abandoned. New comments and comment votes are not allowed.")):null:u.a.createElement("div",{className:"md"},u.a.createElement(ae.a,{input:{value:b,onChange:v},toggledStyle:!0})),n||!m(d)||j||C||w?null:u.a.createElement("div",{className:"bottom-area"},u.a.createElement("span",{className:"help-toggle toggle"},u.a.createElement("span",{className:"linkish option active",tabIndex:100,onClick:function(e){l(),e.preventDefault()}},"formatting help")),f&&u.a.createElement(a,{className:"reddiquette",href:"/help/contentpolicy",tabIndex:100,target:"_blank"},"content policy"),u.a.createElement("div",{className:"usertext-buttons"},u.a.createElement("button",{className:"togglebutton access-required".concat(c?"":" not-active disabled"),type:"submit",style:{marginBottom:"5px"},disabled:!c},"save"),y&&u.a.createElement("button",{className:"togglebutton access-required".concat(c?"":" not-active disabled"),onClick:function(){return y()},type:"button",disabled:!c},"cancel")||null))),r&&u.a.createElement(ne.a,null)))}),oe=a(162),ie=a.n(oe),se=function(e){var t=e.hidden,a=e.width,n=e.className,r=e.style;return u.a.createElement("div",{className:"loading"+(n?" "+n:""),style:Object.assign({display:t?"none":"flex",width:1.4*a+"px",height:1.25*a+"px"},r)},u.a.createElement("div",{className:"hoverimage"}),u.a.createElement("div",{className:"logo",style:{width:1.4*a+"px",height:1.25*a+"px"}}))},le=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={show:a.props.hidden||!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.hidden||(this.loadingIconDelay=setTimeout(function(){e.setState({show:!0}),e.loadingIconDelay=0},1e3))}},{key:"componentWillUnmount",value:function(){this.loadingIconDelay&&(clearTimeout(this.loadingIconDelay),this.loadingIconDelay=0)}},{key:"render",value:function(){var e=this.state.show;return u.a.createElement(se,{hidden:!e,width:200,style:{paddingTop:"300px",margin:"0 auto"}})}}]),t}(u.a.Component),ce=a(35),ue=a(66),me=a.n(ue),de=a(168),pe=[{label:"unreviewed",value:T.eb},{label:"censored",value:T.cb},{label:"all proposals",value:T.Y}],he=[{label:"all proposals",value:T.Y},{label:"pre-voting",value:T.mb},{label:"active voting",value:T.jb},{label:"approved",value:T.X},{label:"rejected",value:T.ab},{label:"abandoned",value:T.bb}],fe=[{label:"submitted",value:T.ib},{label:"drafts",value:T.hb}],be=(Z={},Object(ce.a)(Z,T.y,pe),Object(ce.a)(Z,T.x,he),Object(ce.a)(Z,T.z,fe),Z),ve=(Q={},Object(ce.a)(Q,T.y,function(e,t){var a=e[t]||0;return t===T.eb?a+(e[T.fb]||0):a}),Object(ce.a)(Q,T.x,function(e,t){var a=e[t]||0;return t===T.mb?a+(e[T.kb]||0):a}),Object(ce.a)(Q,T.z,function(e,t){return e[t]||0}),Q),ye=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleUpdateFilterValueForQueryValue=function(e){var t=e.location,a=e.header,n=e.handleChangeFilterValue,r=me.a.parse(t.search).tab,o=be[a];if(o){var i=o.find(function(e){return e.label===r});i&&n(i.value)}},a.handleUpdateQueryForFilterValueChange=function(e){var t=a.props.header,n=e.filterValue!==a.props.filterValue,r=be[t];if(r){var o=(r&&r.find(function(e){return e.value===a.props.filterValue})||{}).label;n&&Object(M.d)("tab",o)}},a.handleUpdateFilterValueForQueryValue(e),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){this.handleUpdateQueryForFilterValueChange(e)}},{key:"render",value:function(){var e=this.props,t=e.handleChangeFilterValue,a=e.header,n=e.filterValue,r=e.proposalCounts;return be[a]?u.a.createElement(de.b,null,be[a].map(function(e){return u.a.createElement(de.a,{key:e.value,title:e.label,count:ve[a](r,e.value),selected:n===e.value,onTabChange:function(){return t(e.value)}})})):null}}]),t}(u.a.Component),ge=Object(m.a)(ye),Ee=[{label:"unreviewed",value:T.r},{label:"updated",value:T.w},{label:"disputed",value:T.p},{label:"approved",value:T.o},{label:"paid",value:T.t},{label:"rejected",value:T.u},{label:"all invoices",value:T.n},{label:"drafts",value:T.gb}],Oe=Ee.slice(0,-1),we=(X={},Object(ce.a)(X,T.e,Oe),Object(ce.a)(X,T.f,Ee),X),je=(G={},Object(ce.a)(G,T.e,function(e,t){return e[t]||0}),Object(ce.a)(G,T.f,function(e,t){return e[t]||0}),G),Ce=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleUpdateFilterValueForQueryValue=function(e){var t=e.location,a=e.header,n=e.handleChangeFilterValue,r=me.a.parse(t.search).tab,o=we[a];if(o){var i=o.find(function(e){return e.label===r});i&&n(i.value)}},a.handleUpdateQueryForFilterValueChange=function(e){var t=a.props.header,n=e.filterValue!==a.props.filterValue,r=we[t];if(r){var o=r&&r.find(function(e){return e.value===a.props.filterValue}),i=o&&o.label;n&&Object(M.d)("tab",i)}},a.handleUpdateFilterValueForQueryValue(e),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.filterValue,a=e.header,n=we[a]||[],r=n.find(function(e){return e&&e.value===t});n.length&&!r&&this.props.handleChangeFilterValue(n[0].value)}},{key:"componentDidUpdate",value:function(e){this.handleUpdateQueryForFilterValueChange(e)}},{key:"render",value:function(){var e=this.props,t=e.handleChangeFilterValue,a=e.header,n=e.filterValue,r=e.invoiceCounts;return we[a]?u.a.createElement(de.b,null,we[a].map(function(e){return u.a.createElement(de.a,{key:e.value,title:e.label,count:je[a](r,e.value),selected:n===e.value,onTabChange:function(){return t(e.value)}})})):null}}]),t}(u.a.Component),ke=Object(m.a)(Ce),xe=a(44),Se=a(34),Pe=T.J.reduce(function(e,t,a){return[].concat(Object(xe.a)(e),[{label:t,value:a+1}])},[]),Ne=T.zb.reduce(function(e,t){return[].concat(Object(xe.a)(e),[{label:t,value:parseInt(t,10)}])},[]),Ie=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).onSetMonthSortOption=function(e){var t=a.props.yearFilterValue;Object(M.d)("month",e.value),a.props.handleChangeDateFilter(e.value,t)},a.onSetYearSortOption=function(e){var t=a.props.monthFilterValue;Object(M.d)("year",e.value),a.props.handleChangeDateFilter(t,e.value)},a.onResetSortOptions=function(){a.props.handleChangeDateFilter(T.k,Object(Se.j)()),Object(M.c)(window.location.href,"year","month")},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.yearFilterValue,a=e.monthFilterValue,n=Object(M.a)("month"),r=Object(M.a)("year");n?this.props.handleChangeDateFilter(n,t):r?this.props.handleChangeDateFilter(a,r):n&&r?this.props.handleChangeDateFilter(n,r):n||r||this.props.handleResetDateFilter&&this.props.handleResetDateFilter()}},{key:"render",value:function(){var e=this.props,t=e.header,a=e.monthFilterValue,n=e.yearFilterValue,r=Ne.find(function(e){return e.value===n}),o=Pe.find(function(e){return e.value===a})||a===T.k;return t&&t!==T.d?u.a.createElement("div",{className:"dropdown-sort-wrapper"},u.a.createElement(g.b,{classNamePrefix:"sort-select",value:o,onChange:this.onSetMonthSortOption,options:Pe.map(function(e){return e}),components:{ClearIndicator:null}}),u.a.createElement(g.b,{classNamePrefix:"sort-select",value:r,onChange:this.onSetYearSortOption,options:Ne.map(function(e){return e}),components:{ClearIndicator:null}}),u.a.createElement("span",{onClick:this.onResetSortOptions},"Reset")):null}}]),t}(u.a.Component),Ae=Object(m.a)(Ie),De=a(313),Fe=function(e){var t=e.bodyClassName,a=void 0===t?"listing-page":t,n=e.listings,r=e.proposals,o=e.proposalCounts,i=e.emptyProposalsMessage,s=void 0===i?"There are no proposals yet":i,l=e.isLoading,c=e.error,m=e.userid,d=e.header,p=e.lastLoadedProposal,h=e.onChangeFilter,f=e.filterValue,b=e.activeVotes,g=e.onFetchData,O=e.onFetchUserProposals,w=e.count,j=e.showLookUp,C=e.commentid,k=e.comments,x=e.isCMS,S=e.invoices,P=e.invoiceCounts,I=e.onChangeDateFilter,A=e.onResetDateFilter,D=e.monthFilterValue,F=e.yearFilterValue,M=e.invoiceComments,R=e.loggedInAsEmail,V=Object(y.a)(e,["bodyClassName","listings","proposals","proposalCounts","emptyProposalsMessage","isLoading","error","userid","header","lastLoadedProposal","onChangeFilter","filterValue","activeVotes","onFetchData","onFetchUserProposals","count","showLookUp","commentid","comments","isCMS","invoices","invoiceCounts","onChangeDateFilter","onResetDateFilter","monthFilterValue","yearFilterValue","invoiceComments","loggedInAsEmail"]),U=!l&&C&&k&&!k.find(function(e){return e.commentid===C}),q=!l&&C&&M&&!M.find(function(e){return e.commentid===C}),W=n&&n.length>0||r&&r.length>0||S&&S.length>0||0!==(o&&f>=0&&o[f]),H=r&&(w&&w>r.length||o&&f>=0&&o[f]>r.length),Y=c?u.a.createElement(_.a,{type:"error",header:"Error loading proposals",body:c}):l?u.a.createElement(le,{key:"content"}):U&&q?u.a.createElement(_.a,{type:"error",header:"Comment not found",body:"Could not find comment"}):u.a.createElement("div",null,d&&u.a.createElement("div",{style:j?{display:"flex",justifyContent:"space-between",alignItems:"center"}:{}},u.a.createElement("h1",{className:"content-title"},d),j&&u.a.createElement("div",null,x&&R&&u.a.createElement(u.a.Fragment,null,u.a.createElement(L,{style:{marginRight:"24px"},href:"/admin/payouts",onClick:function(){return null}},"Generate payouts"),u.a.createElement(L,{style:{marginRight:"24px"},href:"/admin/invite",onClick:function(){return null}},"Invite new contractor")),u.a.createElement(L,{style:{marginRight:"24px"},href:"/admin/users",onClick:function(){return null}},u.a.createElement("i",{className:"fa fa-search right-margin-5"}),"Search users"))),x?u.a.createElement(u.a.Fragment,null,u.a.createElement(ke,{header:d,handleChangeFilterValue:h,filterValue:f,invoiceCounts:P}),f!==T.gb&&u.a.createElement(Ae,{header:d,monthFilterValue:D,yearFilterValue:F,handleChangeDateFilter:I,handleResetDateFilter:A})):u.a.createElement(ge,{header:d,handleChangeFilterValue:h,filterValue:f,proposalCounts:o}),W?x?u.a.createElement(u.a.Fragment,null,u.a.createElement(E.Content,Object(v.a)({},V,{highlightcomment:C,key:"content",lastBlockHeight:V.lastBlockHeight,listings:n||[{allChildren:S?S.map(function(e,t){return Object(N.d)(e,t)}):[]}]}))):u.a.createElement(u.a.Fragment,null,u.a.createElement(E.Content,Object(v.a)({},V,{highlightcomment:C,key:"content",lastBlockHeight:V.lastBlockHeight,listings:n||[{allChildren:r?r.map(function(e,t){return Object(N.e)(e,t,b)}):[]}]})),H&&u.a.createElement("div",{style:{width:"100%",maxWidth:"1000px",textAlign:"center"}},u.a.createElement("button",{style:{marginTop:"15px"},className:"c-btn c-btn-primary",onClick:function(){return g?g(p?p.censorshiprecord.token:null):O(m,p?p.censorshiprecord.token:null)}},"Load More"))):u.a.createElement("h1",{style:{textAlign:"center",paddingTop:"125px",color:"#777"}},s));return[u.a.createElement(ie.a,{className:a,key:"body"}),u.a.createElement("div",{className:"content",role:"main",key:"content"},Y)]},Te=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={isFetched:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.isProposalStatusApproved&&this.props.onChangeProposalStatusApproved(!1)}},{key:"componentDidUpdate",value:function(){var e=this.props.csrf,t=this.state.isFetched,a=this.props.getLastBlockHeight;t||e&&(this.setState({isFetched:!0}),this.props.onFetchData&&this.props.onFetchData(),this.props.onFetchStatus&&this.props.onFetchStatus(),!this.props.isCMS&&a&&a())}},{key:"render",value:function(){return u.a.createElement(Fe,this.props)}}]),t}(c.Component),Me=Object(De.a)(Te),Re=a(314),Ve=E.Header,Ue=a(56),Le=a(219),_e=Object(Le.a)(function(e){var t=e.subredditData,a=e.useStyle,n=e.isAdmin;return u.a.createElement("div",{id:"header-bottom-left"},a&&t&&t.header_img?u.a.createElement(L,{href:"/"},u.a.createElement("img",{id:"header-img",src:t.header_img,alt:t.display_name})):u.a.createElement(L,{className:"default-header",href:"/",id:"header-img"},"Demos"),u.a.createElement("span",{className:"hover pagename redditname"},u.a.createElement(L,{href:"/"},"DCC")),u.a.createElement("ul",{className:"tabmenu"},n?u.a.createElement("li",null,u.a.createElement(L,{className:"choice",href:"/admin/"},"Admin")):null))}),qe=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc,isAdmin:S.Yb,userHasPaid:S.ke,paywallAddress:S.ud,paywallAmount:S.vd,paywallTxNotBefore:S.wd})),We=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement(_e,null)}}]),t}(u.a.Component);Object(Ue.a)(We);var He=qe(We),Ye=a(565),ze=a(51),Be=a(132),Ke=a(566),Ze=function(e){if(!K(e.username)||!K(e.password))throw new q.a({_error:"All fields are required"});if(W(e.username))throw new q.a({_error:"Username must be used to login"})},Qe=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc,keyMismatch:S.nb,serverPubkey:S.Wd,email:S.cb,isAdmin:S.Yb,redirectedFrom:S.Pd,isApiRequestingLogin:Object(x.f)(S.kc,S.nc),apiLoginError:S.q}),{onLogin:P.W,resetRedirectedFrom:P.Wb}),Xe=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={showPrivacyPolicy:!1},a.onTogglePrivacyPolicy=function(){return a.setState({showPrivacyPolicy:!a.state.showPrivacyPolicy})},a.onHidePrivacyPolicy=function(){return a.setState({showPrivacyPolicy:!1})},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object.assign({},this.state,Object(v.a)({},this.props,{onLogin:this.onLogin.bind(this)}),{onTogglePrivacyPolicy:this.onTogglePrivacyPolicy,onHidePrivacyPolicy:this.onHidePrivacyPolicy}))}},{key:"onLogin",value:function(e){var t=this;return e=Object(v.a)({},e,{username:void 0===e.username?null:e.username.trim()}),Ze(e),this.props.onLogin(e).then(function(){var e=t.props.redirectedFrom;e?t.props.history.push(e):t.props.isAdmin?t.props.history.push("/admin/"):t.props.history.push("/")}).catch(function(e){throw new q.a({_error:e.message})})}}]),t}(c.Component),Ge=k()(m.a,Object(Ke.a)({form:"form/login"}),function(e){return Qe(function(t){return u.a.createElement(Xe,Object(v.a)({},t,{Component:e}))})})(function(e){var t=e.Link,a=e.formAction,n=void 0===a?"/post/login":a,r=e.error,o=e.isApiRequestingLogin,i=e.loggedInAsEmail,s=e.apiLoginError,l=e.onLogin,c=e.handleSubmit;return i?null:u.a.createElement("form",{action:n,className:"form-v2",id:"login-form",method:"post",name:"login-form",onSubmit:l?c(l):null},u.a.createElement("input",{name:"op",type:"hidden",defaultValue:"login"}),u.a.createElement("input",{name:"dest",type:"hidden",defaultValue:"/"}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"user_login"},"username:"),u.a.createElement(Ye.a,{autoFocus:!0,className:"c-form-control",id:"user_login",name:"username",component:"input",type:"text",placeholder:"Username",tabIndex:4})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"passwd_login"},"password:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"passwd_login",tabIndex:4,name:"password",component:"input",type:"password",placeholder:"Password"}),r||s?u.a.createElement(_.a,{type:"error",header:"Login error",body:r||s}):null,u.a.createElement(Ye.a,{name:"global",component:function(e){return u.a.createElement(Be.a,Object.assign({title:"Cannot login"},e))}})),u.a.createElement("div",{className:"c-checkbox"},u.a.createElement("input",{id:"rem_login",name:"rem",tabIndex:4,type:"checkbox"}),u.a.createElement("label",{htmlFor:"rem_login"},"remember me")),u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement(ze.a,{style:{marginRight:"0px"},className:"c-btn c-btn-primary c-pull-right",tabIndex:7,text:"LOGIN",isLoading:o}),u.a.createElement(t,{className:"c-pull-right reset-password-link",href:"/password",tabIndex:4},"Reset Password"),u.a.createElement(t,{className:"c-pull-right reset-password-link",href:"/privacy-policy",tabIndex:4},"Privacy Policy")))}),Je=null,$e=function(e){return u.a.createElement(E.LoginSignupPage,Object(v.a)({},e))},et=a(218),tt=te(function(e){var t=e.replyTo,a=Object(y.a)(e,["replyTo"]);return u.a.createElement(E.NestedListing,Object(v.a)({},a,{replyTo:t,name:a.name||0}))}),at=function(e,t,a){if(a){if(!K(t.email)||!K(t.verificationtoken)||!K(t.username)||!K(t.password)||!K(t.password_verify))throw new q.a({_error:"All fields are required"});if(!z(t.password,e.minpasswordlength))throw new q.a({_error:"Your password must be at least "+e.minpasswordlength+" characters."});if(!z(t.username,e.minusernamelength,e.maxusernamelength))throw new q.a({_error:"Your username must be at least "+e.minusernamelength+" and less than "+e.maxusernamelength+"."});if(!B(t.password,t.password_verify))throw new q.a({_error:"Passwords do not match"});if(!W(t.email))throw new q.a({_error:"Invalid email address"})}else{if(!K(t.email)||!K(t.password)||!K(t.password_verify))throw new q.a({_error:"All fields are required"});if(!z(t.password,e.minpasswordlength))throw new q.a({_error:"Your password must be at least "+e.minpasswordlength+" characters."});if(!B(t.password,t.password_verify))throw new q.a({_error:"Passwords do not match"});if(!W(t.email))throw new q.a({_error:"Invalid email address"})}},nt=Object(p.b)(S.Vd({email:S.cb,loggedInAsEmail:S.Zc,isAdmin:S.Yb,policy:S.yd,newUserResponse:S.pd,isApiRequestingLogin:S.nc,isApiRequestingNewUser:Object(x.f)(S.kc,S.sc),isApiRequestingVerifyNewUser:S.Lc,apiNewUserError:S.u,apiVerifyNewUserError:S.O,isShowingSignupConfirmation:S.Qc,csrf:S.U,isCMS:S.Mc}),{onFetchData:P.Q,onSignup:P.Fb,onSignupConfirm:P.Gb,onResetSignup:P.pb}),rt=Object(p.b)(S.Vd({isCMS:S.Mc,loggedInAsEmail:S.Zc}),function(e){return Object(O.b)({},e)}),ot=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={hasFetchedPolicy:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.csrf&&(this.props.policy||this.props.onFetchData())}},{key:"componentDidUpdate",value:function(){this.props.loggedInAsEmail?this.props.isAdmin?this.props.history.push("/admin/"):this.props.history.push("/user/proposals"):this.props.newUserResponse&&this.props.history.push("/user/signup/next"),this.state.hasFetchedPolicy||this.props.csrf&&(this.setState({hasFetchedPolicy:!0}),this.props.policy||this.props.onFetchData())}},{key:"componentWillUnmount",value:function(){this.props.isShowingSignupConfirmation&&this.props.onResetSignup()}},{key:"onSignup",value:function(e){e=Object(v.a)({},e,{email:(e.email||"").trim()});var t=this.props.policy||{};if(at(t,e,this.props.isCMS),this.props.error&&this.props.clearSubmitErrors(),!this.props.isShowingSignupConfirmation&&!this.props.isCMS)return this.props.onSignup();var a=this.props.onSignupConfirm(e,this.props.isCMS);return a?a.catch(function(e){throw new q.a({_error:e.message})}):void 0}},{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object(v.a)({},this.props,{onSignup:this.onSignup.bind(this)}))}}]),t}(c.Component),it=Object(M.b)(),st=it.email,lt=it.verificationtoken,ct=k()(Object(Ke.a)({form:"form/signup",initialValues:{email:st,verificationtoken:lt}}),m.a,function(e){return rt(function(t){var a=nt(function(a){return u.a.createElement(ot,Object(v.a)({},a,t,{Component:e}))});return u.a.createElement(a,null)})}),ut=function(){return u.a.createElement("div",null,u.a.createElement("p",null,"DCC will send you a link to verify your email address.",u.a.createElement("span",{style:{fontWeight:"bold"}}," ","You must open this link in the same browser.")," ","After verifying your email, DCC will create your DCC \u201cidentity\u201d, which consists of a public/private cryptographic key pair and browser cookie. This is necessary to verify your identity and allow submission of proposals, commenting, voting, and other DCC functions. After completing the signup process, you can export your identity (public/private keys) to another browser at any time."))},mt=ct(function(e){var t=e.Link,a=e.error,n=e.isApiRequestingNewUser,r=e.apiNewUserError,o=e.apiVerifyNewUserError,i=e.policy,s=e.loggedInAsEmail,l=e.passwdError,c=e.passwd2Error,m=e.isShowingSignupConfirmation,d=e.onSignup,p=e.handleSubmit,h=e.isCMS;return s?null:u.a.createElement("form",{action:"/post/reg",className:"form-v2",id:"register-form",method:"post",name:"register-form",onSubmit:p(d)},u.a.createElement("input",{name:"op",type:"hidden",defaultValue:"reg"}),u.a.createElement("input",{name:"dest",type:"hidden",defaultValue:"/"}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"user_reg"},"email address:"),u.a.createElement(Ye.a,{name:"email",placeholder:"Email Address",component:"input",type:"text",className:"c-form-control",id:"user_reg",tabIndex:2})),h&&u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"user_reg"},"token:"),u.a.createElement(Ye.a,{name:"verificationtoken",placeholder:"Invitation Token",component:"input",type:"text",className:"c-form-control",id:"user_reg",tabIndex:2})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"user_reg"},"username:"),u.a.createElement(Ye.a,{name:"username",placeholder:Object(Se.p)(i),component:"input",type:"text",className:"c-form-control",id:"username_reg",tabIndex:2})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"passwd_reg"},"password:"),u.a.createElement(Ye.a,{name:"password",placeholder:Object(Se.m)(i),component:"input",type:"password",className:"c-form-control",id:"passwd_reg",tabIndex:2}),u.a.createElement("div",{className:"c-form-control-feedback-wrapper"},l?u.a.createElement("span",{className:"c-form-control-feedback c-form-control-feedback-error",title:l}):null)),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"passwd2_reg"},"verify password:"),u.a.createElement(Ye.a,{name:"password_verify",component:"input",type:"password",className:"c-form-control",id:"passwd2_reg",placeholder:"Verify Password",tabIndex:2}),u.a.createElement("div",{className:"c-form-control-feedback-wrapper"},c?u.a.createElement("span",{className:"c-form-control-feedback c-form-control-feedback-error",title:c}):null)),u.a.createElement("div",{className:"c-form-group"},u.a.createElement(Ye.a,{name:"global",component:function(e){return u.a.createElement(Be.a,Object.assign({title:"Cannot sign up"},e))}}),a||r||o?u.a.createElement(_.a,{type:"error",header:"Signup error",body:a||r||o}):null),m?u.a.createElement(_.a,{type:"info",header:"Before you sign up..."},u.a.createElement(ut,null),u.a.createElement(ze.a,{style:{marginRight:"0px",overflow:"hidden"},className:"c-btn c-btn-primary c-pull-right",tabIndex:3,text:"I understand, sign me up",isLoading:n})):u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement(ze.a,{style:{marginRight:"0px"},className:"c-btn c-btn-primary c-pull-right",tabIndex:3,text:"Sign up",isLoading:!1}),!h&&u.a.createElement(t,{className:"c-pull-right resend-verification-link",href:"/user/resend",tabIndex:2},"Resend verification email")),u.a.createElement("div",null,u.a.createElement("div",{className:"c-alert c-alert-danger"})))}),dt=a(321),pt=Object(dt.a)(function(e){var t=e.loggedInAsEmail,a=Object(y.a)(e,["loggedInAsEmail"]);return u.a.createElement(E.Sidebar,Object(v.a)({},a,{username:t}))}),ht=function(e){if(!K(e.censorship))throw new q.a({_error:"Please enter a censorship token"});if(64!==e.censorship.length)throw new q.a({_error:"Censorship tokens must be 64 characters long"})},ft=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object(v.a)({},this.props,{onFind:this.onFind.bind(this)}))}},{key:"onFind",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];ht.apply(void 0,t),this.props.history.push("/proposals/".concat(t[0].censorship))}}]),t}(c.Component),bt=k()(m.a,Object(Ke.a)({form:"form/record-find"}),function(e){return function(t){return u.a.createElement(ft,Object(v.a)({},t,{Component:e}))}})(function(e){var t=e.error,a=e.isSaving,n=e.onFind,r=e.handleSubmit;return u.a.createElement("div",{className:"spacer"},u.a.createElement("form",{className:"search-form",id:"search",role:"search",onSubmit:r(n)},u.a.createElement(Ye.a,{name:"censorship",component:"input",type:"text",placeholder:"Censorship token",size:80,tabIndex:20}),a?u.a.createElement(se,{width:20,style:{display:"block",position:"absolute",top:"14px",right:"12px"}}):u.a.createElement("input",{tabIndex:22,type:"submit",value:""}),t&&u.a.createElement(_.a,{type:"error",header:"Cannot search for proposal",body:t}),u.a.createElement("div",{className:"infobar",id:"searchexpando"},u.a.createElement("div",{id:"moresearchinfo"}))))}),vt=function(){return u.a.createElement("div",null)},yt=E.SiteTable,gt=a(322);function Et(e,t){var a=t.name.trim();return e.policy.minproposalnamelength&&a.length<e.policy.minproposalnamelength||e.policy.maxproposalnamelength&&a.length>e.policy.maxproposalnamelength||e.policy.proposalnamesupportedchars&&!H(a,e.policy.proposalnamesupportedchars)}var Ot=function(e,t,a){if(!K(e.name&&e.name.trim())||!K(e.description))throw new q.a({_error:"You must provide both a proposal name and description."});if(Et(a,e))throw new q.a({_error:"The proposal name must be between ".concat(a.policy.minproposalnamelength," and ").concat(a.policy.maxproposalnamelength," characters long ")+"and only contain the following characters: ".concat(a.policy.proposalnamesupportedchars.join(" "))});if(Y(e.description),e.files){if(e.files.length>a.policy.maximages)throw new q.a({_error:"Only ".concat(a.policy.maximages," attachments are allowed.")});var n=e.files.reduce(function(e,t){var n=Object(gt.b)(t,a.policy);return n.valid?e:[].concat(Object(xe.a)(e),[n.errorMsg])},[]);if(n&&n.length>0)throw new q.a({_error:n.length>1?n:n[0]})}if(a.keyMismatch)throw new q.a({_error:"Your local key does not match the one on the server.  Please generate a new one under account settings."});return null},wt=a(71),jt=a(88),Ct=/[A-z]*\[[0-9]*\]\.[A-z]*/gm,kt=function(e,t,a){var n=t.split(".")[1],r=+/\[([0-9])*\]/gm.exec(t)[1]+1,o="'".concat(n,"' of item ").concat(r," ").concat(a.replace(Ct,""));return(e.lineitems||[]).concat([o])};var xt=function(e,t){var a=t.policy;if(!a)return{waiting:"policy"};var n=function(e){var t,a,n,r,o,i,s=e.cmscontactsupportedchars,l=e.cmsnamelocationsupportedchars,c=e.maxlocationlength,u=e.minlocationlength,m=e.mincontactlength,d=e.maxcontactlength,p=e.minnamelength,h=e.maxnamelength,f=e.minlineitemcollength,b=e.maxlineitemcollength,v=e.invoicefieldsupportedchars;return wt.object().shape({name:(t=wt.string().required("required").min(p).max(h)).matches.apply(t,Object(xe.a)(Object(jt.c)("Name",l))),location:(a=wt.string().required("required").min(u).max(c)).matches.apply(a,Object(xe.a)(Object(jt.c)("Location",l))),contact:(n=wt.string().required("required").min(m).max(d)).matches.apply(n,Object(xe.a)(Object(jt.c)("Contact",s))),rate:wt.number().required("required").min(5).max(500).typeError("rate must be a number"),address:wt.string().required("required"),lineitems:wt.array().of(wt.object().shape({type:wt.string().required("required").oneOf(["1","2","3"]),domain:(r=wt.string().required("required").min(f).max(b)).matches.apply(r,Object(xe.a)(Object(jt.c)("Domain",v))),subdomain:(o=wt.string().required("required").min(f).max(b)).matches.apply(o,Object(xe.a)(Object(jt.c)("Sub domain",v))),description:(i=wt.string().min(f).max(b)).matches.apply(i,Object(xe.a)(Object(jt.c)("Description",v))),labour:wt.number(),expense:wt.number()})).min(1)})}(a);try{return n.validateSync(e,{abortEarly:!1}),{}}catch(r){return function(e){var t={};if(0===e.inner.length)return Object(v.a)({},t,Object(ce.a)({},e.path,e.message));var a=!0,n=!1,r=void 0;try{for(var o,i=e.inner[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value;t[s.path]||(t=Ct.test(s.path)?Object(v.a)({},t,{lineitems:kt(t,s.path,s.message)}):Object(v.a)({},t,Object(ce.a)({},s.path,s.message)))}}catch(s){n=!0,r=s}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}return t}(r)}},St=function(e,t,a){return a.isCMS?function(){}:Ot(e,t,a)},Pt=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc,userCanExecuteActions:S.je,policy:S.yd,userid:S.pe,username:S.ad,keyMismatch:S.nb,proposalCredits:S.Fd}),{onFetchData:P.Q,openModal:P.Ob,onSaveProposalDraft:P.vb,onSaveInvoiceDraft:P.ub,onDeleteDraftProposal:P.p,onDeleteDraftInvoice:P.o}),Nt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onSaveProposalDraft=function(){var e;St.apply(void 0,arguments);var t=(e=a.props).onSaveProposalDraft.apply(e,arguments).payload;a.draftButtonTextAnimation(a.props.isCMS,t.id)},a.onSaveInvoiceDraft=function(){var e;St.apply(void 0,arguments);var t=(e=a.props).onSaveInvoiceDraft.apply(e,arguments).payload;a.draftButtonTextAnimation(a.props.isCMS,t.id)},a.draftButtonTextAnimation=function(e,t){var n=e?"/invoices/new?draftid=":"/proposals/new?draftid=";a.setState({isDraftSaving:!0,draftButtonText:"\u2714 saved"}),setTimeout(function(){a.setState({isDraftSaving:!1}),setTimeout(function(){a.setState({draftButtonText:"Save as Draft"}),""===a.props.location.search&&a.props.history.replace(n+t)},500)},700)},a.state={isDraftSaving:!1,draftButtonText:"Save as Draft"},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.policy||this.props.onFetchData()}},{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object(v.a)({},this.props,{onSaveProposalDraft:this.onSaveProposalDraft,onSaveInvoiceDraft:this.onSaveInvoiceDraft,isDraftSaving:this.state.isDraftSaving,draftButtonText:this.state.draftButtonText}))}}]),t}(c.Component),It=k()(Pt,rt,m.a,Object(Ke.a)({form:"form/record",touchOnChange:!0,validate:function(e,t){return t.isCMS?xt(e,t):function(e,t){var a={_error:"Errors found"};return K(e.name&&e.name.trim())?t.policy&&Et(t,e)?a.name="The proposal name must be between 8 and 80 characters long and only contain the following characters: a-z A-Z 0-9 & . , : ; - @ + # / \\ ^ _ ` ( ) ! [ ].":K(e.description)?a._error=null:a.description="You must provide a description.":a.name="You must provide a proposal name.",a}(e,t)},enableReinitialize:!0,destroyOnUnmount:!1,warn:function(e,t){var a={};if(t.policy){var n=t.policy.maxproposalnamelength-10;e.name&&e.name.trim().length>n&&(a.name="The proposal name is close to the limit of ".concat(t.policy.maxproposalnamelength," characters. Current Length: ").concat(e.name.length,"."))}return a}}),function(e){return function(t){return u.a.createElement(Nt,Object(v.a)({},t,{Component:e}))}}),At=Object(c.lazy)(function(){return a.e(13).then(a.bind(null,1269))}),Dt=Object(c.lazy)(function(){return a.e(15).then(a.bind(null,1278))}),Ft=It(function(e){var t=e.isCMS,a=Object(y.a)(e,["isCMS"]);return u.a.createElement(c.Suspense,{fallback:u.a.createElement(le,null)},t?u.a.createElement(At,a):u.a.createElement(Dt,a))}),Tt=Object(dt.a)(function(e){var t=e.Link,a=e.loggedInAsEmail,n=e.userPaywallStatus===T.U;return a?u.a.createElement("div",{className:"spacer"},u.a.createElement("div",{className:"sidebox submit submit-text"},u.a.createElement("div",{className:"morelink ".concat(n?"":" not-active disabled")},u.a.createElement(t,{className:"login-required access-required","data-event-action":"submit","data-event-detail":"self","data-type":"subreddit",href:"/proposals/new"}),u.a.createElement("div",{className:"nub"})))):null}),Mt=a(1276),Rt=a(879),Vt=a(199),Ut=Object(p.b)(S.Vd({isCMS:S.Mc}),{onRouteChange:Vt.w,onLoadMe:Vt.p}),Lt=a(157),_t=function(e){return function(t){return u.a.createElement(E.Subreddit,Object.assign({},Object(v.a)({},t,e),{useSidebar:!1}))}},qt=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){e.location.pathname!==this.props.location.pathname&&(this.props.onRouteChange(),window.scrollTo(0,0));var t=Object(Lt.c)();t&&t.api&&t.api.me&&this.props.onLoadMe(t.api.me)}},{key:"render",value:function(){return u.a.createElement(Mt.a,null,u.a.createElement(Rt.a,{path:"/user/signup",component:_t(this.props)}),u.a.createElement(Rt.a,{path:"/user/login",component:_t(this.props)}),u.a.createElement(Rt.a,{path:"*",component:this.props.isCMS?_t(this.props):(e=this.props,function(t){return u.a.createElement(E.Subreddit,Object.assign({},Object(v.a)({},t,e),{useSidebar:!0}))})}));var e}}]),t}(c.Component),Wt=Object(m.a)(Ut(qt)),Ht=E.Thing,Yt=te(function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).handlePermalinkClick=function(e){e&&e.preventDefault&&e.preventDefault(),a.props.isCMS?a.props.history.push("/invoices/".concat(a.props.invoiceToken,"/comments/").concat(a.props.id)):a.props.history.push("/proposals/".concat(a.props.token,"/comments/").concat(a.props.id))},a.handleCommentCensor=function(e){e&&e.preventDefault&&e.preventDefault(),a.props.onCensorComment(a.props.loggedInAsEmail,a.props.token||a.props.invoiceToken,a.props.id,a.props.isCMS)},a.handleCommentMaxHeight=function(){Array.prototype.slice.call(document.querySelectorAll(".entry > .usertext ")).filter(function(e){return e.scrollHeight>e.clientHeight&&e.scrollHeight>530}).forEach(function(e){var t,a,n=document.createElement("a");n.innerHTML="Read More",e.className="collapsed",n.className+="readMore",t=n,(a=e).parentNode.insertBefore(t,a.nextSibling),n.addEventListener("click",function(){e.classList.toggle("expanded")}),n.addEventListener("click",function(){"Read More"===n.innerHTML?n.innerHTML="Read less":n.innerHTML="Read More"})})},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.handleCommentMaxHeight()}},{key:"render",value:function(){var e=this.props,t=e.onLikeComment,a=e.loggedInAsEmail,n=e.token,r=e.keyMismatch,o=e.getVoteStatus,i=e.likeCommentError,s=e.likeCommentPayload,l=e.lastVisit,c=e.commentid,m=e.showCommentForm,d=e.toggleCommentForm,p=e.onCloseCommentForm,h=e.proposalAuthor,f=e.proposalStatus,b=e.created_utc,g=e.invoice,O=e.lastVisitInvoice,w=Object(y.a)(e,["onLikeComment","loggedInAsEmail","token","keyMismatch","getVoteStatus","likeCommentError","likeCommentPayload","lastVisit","commentid","showCommentForm","toggleCommentForm","onCloseCommentForm","proposalAuthor","proposalStatus","created_utc","invoice","lastVisitInvoice"]),j=!!w.isCMS&&(g.status===T.o||g.status===T.t||g.status===T.u),C=f===T.bb,k=l?l<b&&w.authorid!==w.userid:!!O&&(O<b&&w.authorid!==w.userid),x=c===w.id;return u.a.createElement("div",{style:w.isCMS?{padding:"0 16px"}:null},i&&s.token===n&&s.commentid===w.id&&u.a.createElement(_.a,{key:"comment-vote-error",type:"error",header:"Comment vote failed",body:i}),u.a.createElement(E.ThingComment,Object(v.a)({},w,{created_utc:b,showCensorLink:!!w.isAdmin&&!w.censored,showArrows:!w.censored&&!C&&!w.isCMS,grayBody:w.censored||C,highlightcomment:x||k,showReply:!w.censored&&!C&&!j,onShowReply:d,onCensorComment:this.handleCommentCensor,onCloseCommentForm:p,showCommentForm:m,proposalAuthor:h,isNewComment:k,user:a,authorHref:"/user/".concat(w.authorid),score_hidden:w.isCMS,blockvote:r||o(n).status===T.lb||C,handleVote:t,token:n,onPermalinkClick:this.handlePermalinkClick})))}}]),t}(u.a.PureComponent)),zt=a(567),Bt=a(54),Kt=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc,email:S.cb,userid:S.pe,isAdmin:S.Yb,userCanExecuteActions:S.je,isApiRequestingSetInvoiceStatusByToken:S.Dc}),{onChangeStatus:P.Cb,openModal:P.Ob,onDeleteDraftInvoice:P.o}),Zt=a(169),Qt=(a(1238),function(){return u.a.createElement("div",{className:"field-separator"})}),Xt=function(e){var t=e.label,a=e.children;return u.a.createElement("div",{className:"field"},u.a.createElement("label",{className:"field-label"},t&&t+":"),u.a.createElement("div",{className:"field-value"},a),u.a.createElement("div",{className:"clear"}))},Gt=a(572),Jt=a(134),$t=function(e){var t=e.contractorcontact,a=e.contractorlocation,n=e.contractorname,r=e.contractorrate,o=e.lineitems,i=e.month,s=e.paymentaddress,l=e.year,c=e.exchangerate,m=e.expanded;return void 0===m||m?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{padding:"5px",marginTop:"20px"}},u.a.createElement(Xt,{label:"Invoice month"},"".concat(i,"/").concat(l)),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Exchange rate"},"".concat(Object(Se.g)(c)," USD")),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Contractor name"},n),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Contractor contact"},t),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Contractor location"},a),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Contractor rate"},"".concat(Object(Se.g)(r)," USD")),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Payment address"},s)),u.a.createElement(Gt.a,{readOnly:!0,value:Object(Jt.e)(o,r)})):null},ea=Kt(function(e){var t=e.id,a=e.title,n=e.author,r=e.authorid,o=e.userId,i=e.created_utc,s=e.input,l=e.review_status,c=e.otherFiles,m=e.version,d=e.Link,p=e.url,h=e.location,f=e.isAdmin,b=e.confirmWithModal,v=e.onChangeStatus,y=e.userCanExecuteActions,g=e.loggedInAsEmail,O=e.isApiRequestingSetInvoiceStatusByToken,w=e.rank,j=void 0===w?0:w,C=e.draftId,k=e.onDeleteDraftInvoice,x=r===o&&(l===T.v||l===T.p||l===T.w),S="invoices"===h.pathname.split("/")[1],P=l===T.v||l===T.w,N=O(t),I=N===T.u,A=N===T.o,D=N===T.p;return u.a.createElement("div",{className:"thing thing-proposal id-".concat(t," odd link")},u.a.createElement("div",{className:"entry unvoted"},u.a.createElement("span",{className:"title",style:{display:"flex",overflow:"visible"}},u.a.createElement(d,{className:"title may-blank loggedin",href:p,tabIndex:j},a),x&&u.a.createElement("div",{style:{flex:"1",display:"flex",justifyContent:"flex-end",alignItems:"flex-start"}},u.a.createElement(d,{href:"/invoices/".concat(t,"/edit"),className:"edit-proposal right-margin-10",onClick:function(){return null}},u.a.createElement("i",{className:"fa fa-edit right-margin-5"}),"Edit"))),u.a.createElement("span",{style:{display:"flex",flexDirection:"column"},className:"tagline"},u.a.createElement("span",{className:"submitted-by"},n&&u.a.createElement("span",null," by ",u.a.createElement(d,{href:"/user/".concat(r)},n))),i&&u.a.createElement("span",{className:"submitted-by"},"submitted ",u.a.createElement(E.DateTooltip,{createdAt:i})),l&&Object(Se.t)(l),s&&u.a.createElement($t,Object.assign({expanded:S},s)),c&&u.a.createElement(Zt.a,{readOnly:!0,files:c})),C&&u.a.createElement("div",{className:"tagline proposal-draft"},"Saved as draft",u.a.createElement("span",{className:"delete-draft",onClick:function(){b(Bt.c,{message:"Are you sure you want to delete this draft?"}).then(function(e){return e&&k(C)})}},u.a.createElement("i",{className:"fa fa-trash"}),"Delete")),f&&u.a.createElement("ul",{style:{display:"flex"}},P&&u.a.createElement("li",{key:"spam"},u.a.createElement(ze.a,{className:"c-btn c-btn-primary".concat(y?"":" not-active disabled"),onClick:function(e){return b(Bt.d,{reasonPlaceholder:"Please provide a reason to reject this invoice"}).then(function(e){var a=e.reason;return e.confirm&&v(r,g,t,T.u,m,a,T.qb)})&&e.preventDefault()},text:"Reject","data-event-action":"spam",isLoading:I})),P&&u.a.createElement("li",null,u.a.createElement(ze.a,{className:"c-btn c-btn-primary".concat(y?"":" not-active disabled"),onClick:function(e){return b(Bt.c,{message:"Are you sure you want to approve this invoice?"}).then(function(e){return e&&v(r,g,t,T.o,m,"",T.qb)})&&e.preventDefault()},text:"approve","data-event-action":"approve",isLoading:A})),P&&u.a.createElement("li",null,u.a.createElement(ze.a,{className:"c-btn c-btn-primary".concat(y?"":" not-active disabled"),onClick:function(e){return b(Bt.c,{message:"Are you sure you want to dispute this invoice?"}).then(function(e){return e&&v(r,g,t,T.p,m,"",T.qb)})&&e.preventDefault()},text:"dispute","data-event-action":"dispute",isLoading:D})))))}),ta=Object(m.a)(Object(De.a)(function(e){var t=e.isCMS,a=Object(y.a)(e,["isCMS"]);return t?u.a.createElement(ea,a):u.a.createElement(zt.a,a)})),aa=a(561),na=function(){return null},ra=na,oa=na,ia=na,sa=na,la=na,ca=na,ua=na,ma=Object(v.a)({},n),da=function(e){return function(t){return e?u.a.createElement(e,Object(v.a)({},ma,t)):null}},pa=(ma.AccountActivityBox=da(ma.AccountActivityBox),ma.CommentArea=da(ma.CommentArea),ma.CommentForm=da(ma.CommentForm),ma.Content=da(ma.Content)),ha=(ma.Expando=da(ma.Expando),ma.Header=da(ma.Header),ma.HeaderBottomLeft=da(ma.HeaderBottomLeft),ma.Link=da(ma.Link)),fa=(ma.LoadingIcon=da(ma.LoadingIcon),ma.LoginForm=da(ma.LoginForm)),ba=(ma.LoginFormSide=da(ma.LoginFormSide),ma.LoginSignupPage=da(ma.LoginSignupPage)),va=(ma.Markdown=da(ma.Markdown),ma.NavButtons=da(ma.NavButtons),ma.NestedListing=da(ma.NestedListing),ma.OrganicListing=da(ma.OrganicListing),ma.LoadingIcon=da(ma.PageLoadingIcon)),ya=(ma.RecentlyViewedLinks=da(ma.RecentlyViewedLinks),ma.RegisterForm=da(ma.RegisterForm),ma.Sidebar=da(ma.Sidebar),ma.SidebarAd=da(ma.SidebarAd),ma.SidebarSearch=da(ma.SidebarSearch),ma.SidebarTitlebox=da(ma.SidebarTitlebox),ma.SiteTable=da(ma.SiteTable),ma.SrHeaderArea=da(ma.SrHeaderArea),ma.SubmitLinkSidebox=da(ma.SubmitLinkSidebox),ma.SubmitPage=da(ma.SubmitPage)),ga=(ma.SubmitTextSidebox=da(ma.SubmitTextSidebox),ma.Subreddit=da(ma.Subreddit)),Ea=(ma.Thing=da(ma.Thing),ma.ThingComment=da(ma.ThingComment),ma.ThingLink=da(ma.ThingLink),ma.UserInfo=da(ma.UserInfo),a(25)),Oa=a.n(Ea),wa=function(e){return u.a.createElement("div",{className:"header-alert ".concat(e.className),style:e.style},u.a.createElement(_.a,{type:"error",header:"Action needed",body:e.children}))};wa.prototypes={children:Oa.a.any,style:Oa.a.object,className:Oa.a.string};var ja=wa,Ca=a(286),ka=a.n(Ca),xa=a(562),Sa=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).getTimeLeft=function(e,t){return t+e+5-Date.now()/1e3},a.intervalProcedure=function(){var e=a.state.timer,t=a.props,n=t.sessionMaxAge,r=t.lastLoginTime,o=a.getTimeLeft(n,r),i=!isNaN(o),s=o<20;if(null!=e&&i){var l=--e;return l<=0?a.setState({activateInterval:!1}):a.setState({timer:l})}i&&s?a.setState({timer:o}):i||a.setState({timer:null})},a.finishInterval=function(){var e=a.props,t=e.loggedInAsEmail,n=e.handleLogout;a.setState({timer:null}),t&&n()},a.state={timer:null,activateInterval:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.loggedInAsEmail;!e.loggedInAsEmail&&t?this.setState({activateInterval:!0}):e.loggedInAsEmail&&!t&&this.setState({activateInterval:!1})}},{key:"render",value:function(){var e=this.state.timer;return u.a.createElement(xa.a,{intervalPeriod:1e3,onInterval:this.intervalProcedure,onFinishInterval:this.finishInterval,active:this.state.activateInterval},e?u.a.createElement("div",{className:"session-expiration"},"current session expires ",ka()(1e3*e+Date.now(),{addSuffix:!0})):null)}}]),t}(u.a.Component),Pa=Object(m.a)(Object(Le.a)(Sa)),Na=Object(p.b)(S.Vd({userId:k()(j()(["match","params","userId"]),Object(x.b)(1)),loggedInAsUserId:S.pe,user:S.ie,error:S.K,errorRescan:S.C,isLoadingRescan:S.Bc,isLoading:Object(x.f)(S.Hc,S.qc),isLoadingProposals:Object(x.f)(S.ne,S.Ac),isTestnet:S.Rc,loggedInAsEmail:S.Zc,userProposals:S.Ib,isAdmin:S.Yb,lastLoadedUserDetailProposal:S.Uc,lastLoadedProposal:S.Vc,getSubmittedUserProposals:S.vb,identityImportError:S.Pb,identityImportSuccess:S.Qb,keyMismatch:S.nb,updateUserKey:S.fe,updateUserKeyError:S.ge,shouldAutoVerifyKey:S.be,verificationToken:S.qe,userPubkey:S.oe,userPaywallStatus:S.Fb,loggedInAsUsername:S.ad,amountOfCreditsAddedOnRescan:S.b,rescanUserId:S.D,isApiRequestingUpdateUserKey:S.Gc,isApiRequestingMarkAsPaid:function(e){return S.pc(e)&&S.bd(e)===T.C},isApiRequestingMarkNewUserAsExpired:function(e){return S.pc(e)&&S.bd(e)===T.E},isApiRequestingMarkUpdateKeyAsExpired:function(e){return S.pc(e)&&S.bd(e)===T.G},isApiRequestingMarkResetPasswordAsExpired:function(e){return S.pc(e)&&S.bd(e)===T.F},isApiRequestingUnlockUser:function(e){return S.pc(e)&&S.bd(e)===T.I},isApiRequestingDeactivateUser:function(e){return S.pc(e)&&S.bd(e)===T.D},isApiRequestingReactivateUser:function(e){return S.pc(e)&&S.bd(e)===T.H},manageUserResponse:S.cd,isCMS:S.Mc}),function(e){return Object(O.b)({onFetchUserProposals:P.M,onFetchData:P.K,openModal:P.Ob,closeModal:P.b,keyMismatchAction:P.f,onIdentityImported:P.R,confirmWithModal:P.c,onUpdateUserKey:P.Jb,onManageUser:P.Y,onRescan:P.db,onResetRescan:P.ob},e)}),Ia=k()(m.a,Na),Aa=Object(p.b)(S.Vd({isAdmin:S.Yb,proposals:S.R,error:S.ve,isLoading:S.we}),function(e){return Object(O.b)({onFetchData:P.I},e)}),Da=Object(p.b)(S.Vd({isAdmin:S.Yb,proposals:S.ce,error:S.ve,isLoading:S.we}),function(e){return Object(O.b)({onFetchData:P.I,onSetProposalStatus:P.Db},e)}),Fa=Object(p.b)(S.Vd({proposals:S.yb,showLookUp:S.Zc,proposalCounts:S.zb,error:S.de,isLoading:Object(x.f)(S.ee),filterValue:S.hb,header:function(){return T.y},emptyProposalsMessage:S.xb,lastLoadedProposal:S.Tc}),{onFetchStatus:P.J,onFetchData:P.I,onChangeFilter:P.i,onStartVote:P.Hb}),Ta=a(156),Ma=Object(p.b)(S.Vd({draftProposal:S.X,isLoading:Object(x.f)(S.Nc,S.jd),policy:S.yd,userid:S.pe,username:S.ad,keyMismatch:S.nb,name:S.ld,description:S.gd,files:S.id,submitError:S.hd,merkle:S.kd,token:S.nd,signature:S.md,proposalCredits:S.Fd,draftProposalById:S.X,userPaywallStatus:S.Fb,userHasPaid:S.ke}),{onFetchData:P.Q,onSave:P.yb,onResetProposal:P.nb,onSaveDraftProposal:P.vb,onDeleteDraftProposal:P.p}),Ra=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onChange=function(){a.setState({validationError:""})},a.onSaveProposal=function(){var e;try{Ot.apply(void 0,arguments)}catch(t){return void a.setState({validationError:t.errors._error})}return(e=a.props).onSave.apply(e,arguments)},a.state={initialValues:e.draftProposal||Object(Ta.b)(),validationError:""},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.token,n=t.draftProposal;if(a)return this.props.draftProposalById&&this.props.onDeleteDraftProposal(this.props.draftProposalById.draftId),this.props.onResetProposal(),this.props.history.push("/proposals/"+a);!e.draftProposal&&n&&this.setState({initialValues:n})}},{key:"render",value:function(){var e=this.props.Component,t=this.state.validationError;return u.a.createElement(e,Object(v.a)({},this.props,{onSave:this.onSaveProposal.bind(this),initialValues:this.state.initialValues,validationError:t,onChange:this.onChange}))}}]),t}(c.Component),Va=k()(Ma,function(e){return function(t){return u.a.createElement(Ra,Object(v.a)({},t,{Component:e}))}}),Ua=Object(p.b)(S.Vd({token:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","token"]),Object(x.b)(1)),editedProposalToken:S.ab,submitError:S.i,proposal:S.Ad,initialValues:Object(x.f)(S.lb),isLoading:Object(x.f)(S.Nc,S.Hd),loggedInAsEmail:S.Zc,userCanExecuteActions:S.je,policy:S.yd,userid:S.pe,username:S.ad,keyMismatch:S.nb,proposalCredits:S.Fd,draftProposalById:S.X,isApiRequestingMe:S.qc}),{onFetchData:P.Q,onFetchProposal:P.z,onResetProposal:P.nb,onSave:P.r,onSaveDraftProposal:P.vb,onDeleteDraftProposal:P.p}),La=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onChange=function(){a.setState({validationError:""})},a.onSave=function(){try{for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ot.apply(void 0,n),(e=a.props).onSave.apply(e,n.concat([a.props.token]))}catch(o){a.setState({validationError:o.errors._error})}},a.state={validationError:""},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.token;this.props.policy||this.props.onFetchData(),this.props.onFetchProposal&&this.props.onFetchProposal(e)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.editedProposalToken,a=e.proposal,n=e.isApiRequestingMe;if(t)return this.props.onResetProposal(),this.props.history.push("/proposals/"+t);var r=a&&a.censorshiprecord&&a.censorshiprecord.token===this.props.token,o=a&&a.userid===this.props.userid;!r||o||n||this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object(v.a)({},this.props,{validationError:this.state.validationError,editingMode:!0,onSave:this.onSave,onChange:this.onChange}))}}]),t}(c.Component),_a=k()(Ua,m.a,function(e){return function(t){return u.a.createElement(La,Object(v.a)({},t,{Component:e}))}}),qa=Object(p.b)(S.Vd({isCMS:S.Mc}),function(e){return Object(O.b)({},e)}),Wa=Object(p.b)(S.Vd({isLoading:S.oc,error:S.s}),function(e){return Object(O.b)({onLogout:P.X},e)})(function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.error;return t?u.a.createElement(le,null):u.a.createElement("div",{className:"content",role:"main"},a?u.a.createElement(_.a,{type:"error",header:"Logout error",body:a}):u.a.createElement("div",{className:"page logout-page"},u.a.createElement("h1",null,"Logged out"),u.a.createElement("h3",null,"Thanks for stopping by, and have a great day."),u.a.createElement("p",null,"Here are some links that might be useful for you:"),u.a.createElement("div",{className:"logout-links"},u.a.createElement("div",{className:"item-link"},u.a.createElement("div",null,u.a.createElement("span",{className:"fa fa-user fa-2x","aria-hidden":"true"})),u.a.createElement("div",null,u.a.createElement("a",{href:"/user/signup"}," log back in"))),u.a.createElement("div",{className:"item-link"},u.a.createElement("div",null,u.a.createElement("span",{className:"fa fa-home fa-2x","aria-hidden":"true"})),u.a.createElement("div",null,u.a.createElement("a",{href:"https://www.doschain.org/"}," doschain.org"))),u.a.createElement("div",{className:"item-link"},u.a.createElement("div",null,u.a.createElement("span",{className:"fa fa-github fa-2x","aria-hidden":"true"})),u.a.createElement("div",null,u.a.createElement("a",{href:"https://github.com/decred/politeia"}," dcc")," and"," ",u.a.createElement("a",{href:"https://github.com/decred/politeiagui"},"politeiagui"))))))}}]),t}(c.Component)),Ha=Object(p.b)(S.Vd({userSearch:S.N,loggedInAsEmail:S.Zc,error:S.M,isLoading:S.Kc}),function(e){return Object(O.b)({onSearchUser:P.Ab},e)}),Ya=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).handleSubmit=function(e){a.props.onSearchUser(Object(ce.a)({},e.parameter,e.searchusers))},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.userSearch,a=e.loggedInAsEmail,n=e.error,r=e.isLoading,o=e.handleSubmit;return a?u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("form",{className:"search-form",style:{display:"flex",justifyContent:"center",width:"100%"},id:"searchusers",role:"search",onSubmit:o(this.handleSubmit)},r?u.a.createElement(se,{hidden:!r,width:200,style:{paddingTop:"50px",margin:"0 auto"}}):u.a.createElement("div",null,u.a.createElement("div",{style:{marginBottom:"10px",display:"flex",justifyContent:"space-around"}},"Search by:",u.a.createElement("label",null,u.a.createElement(Ye.a,{name:"parameter",component:"input",type:"radio",value:"email"})," ","Email"),u.a.createElement("label",null,u.a.createElement(Ye.a,{name:"parameter",component:"input",type:"radio",value:"username"})," ","Username")),u.a.createElement("div",null,u.a.createElement(Ye.a,{name:"searchusers",component:"input",type:"text",placeholder:"user email or username",size:80,tabIndex:1}),u.a.createElement("input",{tabIndex:"2",type:"submit",value:""})))),n&&u.a.createElement(_.a,{type:"error",header:"Cannot search for user",body:n}),t&&!r&&u.a.createElement("div",{className:"search-results"},u.a.createElement("h3",null,"Matches ",t.totalmatches," of ",t.totalusers," users"),t.users.length>0&&u.a.createElement("table",null,u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"ID"),u.a.createElement("th",null,"Email"),u.a.createElement("th",null,"Username"))),u.a.createElement("tbody",null,t.users.map(function(e){return u.a.createElement("tr",{key:e.id},u.a.createElement("td",null,u.a.createElement(L,{href:"/user/".concat(e.id)},e.id)),u.a.createElement("td",null,e.email),u.a.createElement("td",null,e.username))}))))):u.a.createElement("div",{className:"content"},u.a.createElement(_.a,{type:"error",header:"Forbidden",body:"This is an admin protected area. Please login to your account."}))}}]),t}(u.a.PureComponent),za=Object(Ke.a)({form:"form/user-search",initialValues:{parameter:"email"}})(Ha(Ya)),Ba=Object(p.b)(S.Vd({email:S.od,isTestnet:S.Rc,verificationToken:S.qe,isRequestingVerifyNewUser:S.Lc,isCMS:S.Mc}),function(e){return Object(O.b)({onResetNewUser:P.kb},e)}),Ka=k()(m.a,Ba)(function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isTestnet,a=e.email,n=e.verificationToken,r=e.history;t&&a&&n&&r.push("/user/verify?email=".concat(encodeURIComponent(a),"&verificationtoken=").concat(n))}},{key:"componentWillUnmount",value:function(){this.props.onResetNewUser()}},{key:"render",value:function(){var e=this.props,t=e.email,a=e.isCMS;return u.a.createElement("div",{className:"content page signup-next-step-page",role:"main",style:{minHeight:"calc(100vh - 350px)"}},u.a.createElement("div",{className:"text-wrapper"},u.a.createElement("div",{className:"centered"},a?u.a.createElement(u.a.Fragment,null,u.a.createElement("h3",null,"Congratulations, you have fully registered for the Contractor Manangement System!"),u.a.createElement("p",null,"You may now log in",u.a.createElement(L,{href:"/user/signup",className:"login-required"}," ","here")),u.a.createElement("br",null),u.a.createElement("p",null,"If you're having trouble accessing your account, use the"," ",u.a.createElement("code",null,"#support:doschain.org")," channel on"," ",u.a.createElement("a",{href:"https://www.decred.org/matrix/"},"Matrix")," to get assistance from DCC administrators.")):u.a.createElement(u.a.Fragment,null,u.a.createElement("h3",null,"Please check your inbox to verify your registration."),u.a.createElement("p",null,"Note that, for privacy reasons, DCC does not disclose whether an email address has already been registered. If you don't receive an email:"),u.a.createElement("ul",null,t?u.a.createElement("li",null,"Check that ",u.a.createElement("span",{className:"email-address"},t)," ","is the correct address."):null,u.a.createElement("li",null,"Check your spam folder!"),u.a.createElement("li",null,"The verification link needs to be opened with the same browser that you used to sign up."),u.a.createElement("li",null,"Make sure you don't already have an account on DCC with this email address. If you do, you should"," ",u.a.createElement("a",{href:"/password"},"reset your account")," instead.")),u.a.createElement("p",null,"If you're sure you should have received an email, join the"," ",u.a.createElement("code",null,"#support:doschain.org")," channel on"," ",u.a.createElement("a",{href:"https://www.decred.org/matrix/"},"Matrix")," to get assistance from DCC administrators.")))))}}]),t}(u.a.Component)),Za=function(e){var t=e.error,a=e.handleSubmit,n=e.isRequesting,r=e.onForgottenPassword;return n?u.a.createElement(va,null):u.a.createElement("form",{className:"forgotten-password-form",onSubmit:a(r)},t&&u.a.createElement(_.a,{type:"error",header:"Forgotten password error",body:t}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"email"},"Username:"),u.a.createElement(Ye.a,{autoFocus:!0,className:"c-form-control",id:"username",name:"username",component:"input",type:"text",placeholder:"Username",tabIndex:3})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"email"},"Email Address:"),u.a.createElement(Ye.a,{autoFocus:!0,className:"c-form-control",id:"email",name:"email",component:"input",type:"text",placeholder:"Email Address",tabIndex:3})),u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement("button",{className:"c-btn c-btn-primary c-pull-right",tabIndex:3,type:"submit"},"Reset Password")))};Object(Ue.a)(Za);var Qa=Object(Ke.a)({form:"form/forgottenPassword"})(Za),Xa=Object(p.b)(S.Vd({resetPasswordResponse:S.Td,isRequesting:S.ic}),{onForgottenPasswordRequest:P.O,onResetPassword:P.lb});function Ga(e){return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)}function Ja(e){return!!e}var $a=function(e){if(!Ga(e.email))throw new q.a({_error:"Invalid email address"})},en=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(){this.props.resetPasswordResponse&&this.props.history.push("/user/forgotten/password/next")}},{key:"render",value:function(){var e={initialValues:{email:this.props.email}};return u.a.createElement(Qa,Object.assign({},e,{onForgottenPassword:this.onForgottenPassword,isRequesting:this.props.isRequesting}))}},{key:"onForgottenPassword",value:function(e){return $a(e),this.props.onResetPassword(e).catch(function(e){throw new q.a({_error:e.message})})}}]),t}(c.Component);Object(Ue.a)(en);var tn=Xa(Object(m.a)(en)),an=function(e){function t(e){var a;Object(r.a)(this,t),a=Object(i.a)(this,Object(s.a)(t).call(this,e));var n=me.a.parse(e.location.search).email;return a.state={email:n},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.email;return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page forgotten-password-page"},u.a.createElement("h1",null,"Reset Password"),u.a.createElement(tn,{email:e})))}}]),t}(c.Component),nn=Object(p.b)(S.Vd({email:S.Sd||S.fb}),function(e){return Object(O.b)({resetForgottenPassword:P.Sb,resetPasswordReset:P.Ub},e)}),rn=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetPasswordReset(),this.props.resetForgottenPassword()}},{key:"render",value:function(){var e=this.props,t=e.Component,a=Object(y.a)(e,["Component"]);return u.a.createElement(t,Object(v.a)({},a))}}]),t}(c.Component),on=function(e){return nn(function(t){return u.a.createElement(rn,Object(v.a)({},t,{Component:e}))})}(function(e){var t=e.email;return u.a.createElement("div",{className:"page forgotten-password-next-step-page content"},u.a.createElement("div",{className:"text-wrapper"},u.a.createElement("div",{className:"centered"},u.a.createElement("h3",null,"Please check your inbox to reset your password."),u.a.createElement("p",null,"Note that, for privacy reasons, DCC does not disclose whether an email address has been registered. If you don't receive an email:"),u.a.createElement("ul",null,t?u.a.createElement("li",null,"Check that ",u.a.createElement("span",{className:"email-address"},t)," is the correct address."):null,u.a.createElement("li",null,"Check your spam folder!")),u.a.createElement("p",null,"If you're sure you should have received an email, join the"," ",u.a.createElement("code",null,"#support:doschain.org")," channel on"," ",u.a.createElement("a",{href:"https://www.decred.org/matrix/"},"Matrix")," to get assistance from DCC administrators."))))}),sn=a(563),ln=a.n(sn),cn=Object(Ke.a)({form:"form/passwordReset"})(function(e){var t=e.error,a=e.handleSubmit,n=e.onPasswordReset;return e.isRequesting?u.a.createElement(va,null):u.a.createElement("form",{className:"reset-password-form",onSubmit:a(n)},t&&u.a.createElement(_.a,{type:"error",header:"Password reset error",body:t}),u.a.createElement(Ye.a,{name:"global",component:Be.a}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"password"},"Password:"),u.a.createElement(Ye.a,{autoFocus:!0,className:"c-form-control",id:"newPassword",name:"newPassword",component:"input",type:"password",placeholder:"Password",tabIndex:3})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"newPasswordVerify"},"Verify Password:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"newPasswordVerify",name:"newPasswordVerify",component:"input",type:"password",placeholder:"Verify Password",tabIndex:3})),u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement("button",{className:"c-btn c-btn-primary c-pull-right",tabIndex:3,type:"submit"},"Reset Password")))}),un=Object(p.b)(S.Vd({verifyResetPasswordResponse:S.se,isRequesting:S.tc,policy:S.yd}),{resetPasswordReset:P.Ub,onPasswordResetRequest:P.ab,onVerifyResetPassword:P.Mb,onFetchData:P.Q}),mn=function(e,t){if(a=e.newPassword,n=e.newPasswordVerify,a!==n)throw new q.a({_error:"Passwords do not match"});var a,n;if(!z(e.newPassword,t.minpasswordlength))throw new q.a({_error:"Your password must be at least "+t.minpasswordlength+" characters."})},dn=function(e){function t(e){var a;Object(r.a)(this,t);var n=(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).getQueryParams();return Ja(n.username)&&Ja(n.verificationtoken)?Object(i.a)(a):(e.history.push("/"),a)}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetPasswordReset()}},{key:"componentDidUpdate",value:function(){this.props.verifyResetPasswordResponse&&this.props.history.push("/user/password/reset/next")}},{key:"componentDidMount",value:function(){this.props.onFetchData()}},{key:"render",value:function(){return u.a.createElement(cn,{onPasswordReset:this.onPasswordReset,isRequesting:this.props.isRequesting})}},{key:"getQueryParams",value:function(){return me.a.parse(this.props.location.search)}},{key:"onPasswordReset",value:function(e){var t=this.props.policy;return mn(e,t),this.props.onVerifyResetPassword(ln()({newpassword:e.newPassword},this.getQueryParams())).catch(function(e){throw new q.a({_error:e.message})})}}]),t}(c.Component);Object(Ue.a)(dn);var pn=un(Object(m.a)(dn)),hn=function(){return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page reset-password-page"},u.a.createElement("h1",null,"Reset Password"),u.a.createElement(pn,null)))},fn=function(){return u.a.createElement("div",{className:"page reset-password-next-step-page content"},u.a.createElement(_.a,{type:"success",className:"account-page-message",header:"Password reset completed",body:u.a.createElement("div",null,u.a.createElement("p",null,"Your password has been changed. You can now"," ",u.a.createElement("a",{href:"/user/signup"},"login")," with your new password."))}))},bn=function(e){var t=e.error,a=e.handleSubmit,n=e.isRequesting,r=e.onResendVerificationEmail,o=e.isShowingConfirmation;return u.a.createElement("form",{className:"resend-verification-form",onSubmit:a(r)},t&&u.a.createElement(_.a,{type:"error",header:"Resend verification error",body:t}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"email"},"Email Address:"),u.a.createElement(Ye.a,{autoFocus:!0,className:"c-form-control",id:"email",name:"email",component:"input",type:"text",placeholder:"Email Address",tabIndex:3})),o?u.a.createElement(_.a,{type:"info",header:"Before you continue..."},u.a.createElement(ut,null),u.a.createElement(ze.a,{style:{marginRight:"0px"},className:"c-btn c-btn-primary c-pull-right",tabIndex:3,text:"I understand, continue",isLoading:n})):u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement("button",{className:"c-btn c-btn-primary c-pull-right",tabIndex:3,type:"submit"},"Resend verification email")))};Object(Ue.a)(bn);var vn=Object(Ke.a)({form:"form/resendVerificationEmail"})(bn),yn=Object(p.b)(S.Vd({resendVerificationEmailResponse:S.Rd,isRequesting:S.Cc,isShowingConfirmation:S.Qc}),{onResendVerificationEmail:P.eb,onResendVerificationEmailConfirm:P.fb}),gn=function(e){if(!Ga(e.email))throw new q.a({_error:"Invalid email address"})},En=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(){this.props.resendVerificationEmailResponse&&this.props.history.push("/user/resend/next")}},{key:"render",value:function(){return u.a.createElement(vn,{onResendVerificationEmail:this.onResendVerificationEmail,isShowingConfirmation:this.props.isShowingConfirmation,isRequesting:this.props.isRequesting})}},{key:"onResendVerificationEmail",value:function(e){if(gn(e),!this.props.isShowingConfirmation)return this.props.onResendVerificationEmail();var t=this.props.onResendVerificationEmailConfirm(e);return t?t.catch(function(e){throw new q.a({_error:e.message})}):void 0}}]),t}(c.Component);Object(Ue.a)(En);var On=yn(Object(m.a)(En)),wn=function(){return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page resend-verification-email-page"},u.a.createElement("h1",null,"Resend Verification Email"),u.a.createElement(On,null)))},jn=Object(p.b)(S.Vd({email:S.db}),function(e){return Object(O.b)({resetResendVerificationEmail:P.Xb},e)}),Cn=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetResendVerificationEmail()}},{key:"render",value:function(){var e=this.props,t=e.Component,a=Object(y.a)(e,["Component"]);return u.a.createElement(t,Object(v.a)({},a))}}]),t}(c.Component),kn=function(e){return jn(function(t){return u.a.createElement(Cn,Object(v.a)({},t,{Component:e}))})}(function(e){var t=e.email;return u.a.createElement("div",{className:"page resend-verification-next-step-page content"},u.a.createElement("div",{className:"text-wrapper"},u.a.createElement("div",{className:"centered"},u.a.createElement("h3",null,"Please check your inbox for your verification email."),u.a.createElement("p",null,"Note that, for privacy reasons, DCC does not disclose whether an email address has been registered. If you don't receive an email:"),u.a.createElement("ul",null,t?u.a.createElement("li",null,"Check that ",u.a.createElement("span",{className:"email-address"},t)," is the correct address."):null,u.a.createElement("li",null,"Check your spam folder!")),u.a.createElement("p",null,"If you're sure you should have received an email, join the"," ",u.a.createElement("code",null,"#support:doschain.org")," channel on"," ",u.a.createElement("a",{href:"https://www.decred.org/matrix/"},"Matrix")," to get assistance from DCC administrators."))))}),xn=a(564),Sn=a.n(xn),Pn=function(e){var t=e.verifyNewUser,a=e.isRequestingVerifyNewUser,n=e.verifyNewUserError;return a?u.a.createElement(le,null):n?u.a.createElement("div",{className:"page verification-failure-page"},23===n.errorCode?u.a.createElement(_.a,{type:"error",header:"Verification failed"},u.a.createElement("p",null,"The provided signature was invalid, which is usually caused from the local data on your browser being cleared or by using a different browser from the one you registered with."),u.a.createElement("p",null,"Please open the link from your verification email in the same browser that you used to register.")):u.a.createElement(_.a,{type:"error",header:"Verification failed",body:n.message})):t?u.a.createElement("div",{className:"page verification-success-page"},u.a.createElement("h3",null,"Your email has been successfully verified."),u.a.createElement("p",null,"To complete your registration and to be able to submit proposals and comments, you must pay a small fee in DOS, which is used to help deter spam in DCC."),u.a.createElement("p",null,"Please log in to find instructions on how to pay the registration fee.")):null},Nn=Object(p.b)(S.Vd({verifyNewUser:S.re,isRequestingVerifyNewUser:S.Lc,verifyNewUserError:S.O,isCMS:S.Mc}),function(e){return Object(O.b)({onVerify:P.Lb},e)}),In=function(e){function t(e){var a;Object(r.a)(this,t),a=Object(i.a)(this,Object(s.a)(t).call(this,e));var n=me.a.parse(e.location.search),o=n.verificationtoken,l=n.email;return!Sn()(e.location.search)&&l&&o&&"string"===typeof l&&"string"===typeof o?(e.onVerify(l,o).catch(function(e){console.error(e.stack||e)}),a):(e.history.push("/user/login"),Object(i.a)(a))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement(Pn,this.props))}}]),t}(c.Component),An=Nn(Object(m.a)(In)),Dn=Object(p.b)(S.Vd({userid:S.pe,loggedInAsEmail:S.Zc,isAdmin:S.Yb,error:S.me,isLoading:Object(x.f)(S.ne),proposals:S.Ib,proposalCounts:S.Hb,filterValue:S.Bb,lastLoadedProposal:S.Vc,header:function(){return T.z},emptyProposalsMessage:function(){return"You have not created any proposals yet"}}),function(e){return Object(O.b)({onFetchUserProposals:P.M,onChangeFilter:P.l},e)}),Fn=function(e){var t=e.userid,a=e.onFetchUserProposals;return Object(c.useEffect)(function(){t&&a(t)},[t,a]),u.a.createElement("div",{className:"page content user-proposals-page"},u.a.createElement(e.Component,Object(v.a)({},e,{userid:t})))},Tn=function(e){return Dn(function(t){return u.a.createElement(Fn,Object(v.a)({},t,{Component:e}))})},Mn=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"page content"},u.a.createElement(pa,this.props))}}]),t}(c.Component);Object(Ue.a)(Mn);var Rn=Tn(Object(m.a)(Mn)),Vn=a(78),Un=Object(p.b)(S.Vd({email:S.Zc,verifyUserKey:S.te,apiMeResponse:S.t,loggedInAsEmail:S.Zc,verifyUserKeyError:S.ue,keyMismatch:S.nb,userPubkey:S.oe}),function(e){return Object(O.b)({onVerifyUserKey:P.Nb,updateMe:P.bc,keyMismatchAction:P.f},e)}),Ln=function(e){function t(e){var a;Object(r.a)(this,t),a=Object(i.a)(this,Object(s.a)(t).call(this));var n=me.a.parse(e.location.search).verificationtoken;!Sn()(e.location.search)&&n&&"string"===typeof n||e.history.push("/user/login");var o=e.email;return o&&n&&e.onVerifyUserKey(o,n),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(!e.email&&this.props.email){var a=me.a.parse(this.props.location.search).verificationtoken,n=this.props.email;this.props.onVerifyUserKey(n,a)}var r=this.props,o=r.verifyUserKey,i=r.apiMeResponse,s=r.loggedInAsEmail,l=r.userPubkey,c=r.keyMismatchAction;o&&o.success&&i&&s&&(Object(Se.x)(s,l,c),Vn.f(s).then(function(e){e!==i.publickey&&t.props.updateMe(Object(v.a)({},t.props.apiMeResponse,{publickey:e}))}))}},{key:"render",value:function(){var e=this.props,t=e.verifyUserKey,a=e.verifyUserKeyError;return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page verification-page"},!t&&!a&&u.a.createElement(le,null),a&&u.a.createElement(_.a,{type:"error",header:"Verification failed",body:a.message}),t&&t.success&&u.a.createElement(_.a,{type:"success",header:"Verification successful",body:"You have verified and activated your new identity."})))}}]),t}(c.Component),_n=Un(Object(m.a)(Ln)),qn=function(){return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page error-page"},u.a.createElement(_.a,{type:"error",header:"Page not found",body:"The requested page does not exist."})))},Wn=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.error;return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page error-page"},u.a.createElement(_.a,{type:"error",header:"Internal server error",children:u.a.createElement("div",null,e&&u.a.createElement("p",null,e),u.a.createElement("p",null,"You can try reloading the page. If the error persists, please try again in a few minutes."))})))}}]),t}(c.Component),Hn=Object(p.b)(S.Vd({apiError:S.l})),Yn=k()(m.a,Hn),zn=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.apiError,a=e.history;t||a.goBack()}},{key:"render",value:function(){var e=this.props.apiError;return u.a.createElement(Wn,{error:e&&e.message})}}]),t}(c.Component);Object(Ue.a)(zn);var Bn=Yn(zn),Kn=a(201),Zn=a.n(Kn),Qn=a(268),Xn=a.n(Qn),Gn=function(e,t){return e.map(function(e){return t.find(function(t){return t.commentid===e.commentid})||e})},Jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.reduce(function(e,a){var n=t.find(function(e){return a.commentid===e.commentid});return n?e.concat(n):e},[])},$n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=a?function(e,t){return t?e.map(function(e){var a=t.find(function(t){return t.commentid===e.commentid});return a?Object(v.a)({},e,{vote:a.action}):Object(v.a)({},e,{vote:0})}):e}(e,a):e,o=function(e){var t,a=(t={},Object(ce.a)(t,T.rb,Xn()(["timestamp"],["desc"])),Object(ce.a)(t,T.sb,Xn()(["timestamp"],["asc"])),Object(ce.a)(t,T.tb,Xn()(["resultvotes","timestamp"],["desc","desc"])),t);return a[e.value]||a[T.tb]}(t);return(n?o(r):r)||[]},er=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).resolveTabTitle=function(e){var t=a.props,n=t.isCMS,r=t.record,o=!n&&r;(o&&e.record&&e.record.name!==o.name||o&&o.name!==document.title)&&(document.title=o.name||T.i)},a.resolveFetchProposalVoteStatus=function(){var e=a.props,t=e.isCMS,n=e.onFetchProposalVoteStatus,r=e.token;t||n(r)},a.resolveFetchLikedComments=function(e){!e.loggedInAsEmail&&a.props.loggedInAsEmail&&a.props.onFetchLikedComments(a.props.token)},a.resolveFetchProposalVoteStatus=function(e){var t=a.props,n=t.isCMS,r=t.record,o=t.onFetchProposalVoteStatus,i=t.token,s=!n&&r,l=s.status===T.db;s&&(!e.record||0===Object.keys(e.record).length)&&l&&o(i)},a.handleUpdateOfComments=function(e,t){var n;if(t.comments&&0!==t.comments.length){if(e.commentsSortOption!==t.commentsSortOption&&(n=$n(a.state.sortedComments,t.commentsSortOption)),e.comments.length!==t.comments.length){var r=0===e.comments.length,o=r?t.comments:[t.comments[t.comments.length-1]].concat(a.state.sortedComments);n=$n(o,e.commentsSortOption,t.commentslikes,r)}if(e.comments!==t.comments&&(n=$n(t.comments,e.commentsSortOption,t.commentslikes)),t.commentslikes&&!Zn()(e.commentslikes,t.commentslikes)){var i=Jn(t.commentslikes,t.comments),s=Gn(a.state.sortedComments,i);n=$n(s,e.commentsSortOption,t.commentslikes,!1)}t.censoredComment&&!Zn()(e.censoredComment,t.censoredComment)&&(n=$n(t.comments,e.commentsSortOption,t.commentslikes,!0)),n&&a.setState({sortedComments:n})}},a.state={sortedComments:[],accessTime:0},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){this.resolveTabTitle(e),!this.props.isCMS&&this.resolveFetchLikedComments(e),this.resolveFetchProposalVoteStatus(e),this.handleUpdateOfComments(e,this.props)}},{key:"componentDidMount",value:function(){!this.props.isCMS&&this.props.loggedInAsEmail&&this.props.onFetchLikedComments(this.props.token)}},{key:"componentWillUnmount",value:function(){this.props.resetLastSubmittedProposal(),document.title=T.i}},{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.record,n=e.token,r=e.error,o=e.markdownFile,i=e.otherFiles,s=e.onFetchData,l=e.commentid,c=e.tempThreadTree,m=e.isCMS,d=Object(y.a)(e,["isLoading","record","token","error","markdownFile","otherFiles","onFetchData","commentid","tempThreadTree","isCMS"]),p=this.state.sortedComments,h=c[l],f=m?Object(N.f)(a,0).data:Object(N.g)(a,0).data,b=o?Object(Se.o)(o):null;return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page proposal-page"},r?u.a.createElement(_.a,{type:"error",header:"Proposal not found",body:r}):u.a.createElement(pa,Object(v.a)({isLoading:t,error:r,commentid:l,comments:p,bodyClassName:"single-page comments-page",onFetchData:function(){return s(n)},listings:t?[]:[{allChildren:[{kind:"t3",data:Object(v.a)({},f,{otherFiles:i,selftext:b,selftext_html:b})}]},{allChildren:Object(N.c)(p,l,h)}]},d))))}}]),t}(u.a.Component),tr=Object(m.a)(er),ar=function(e){var t=e.children,a=e.filename,n=void 0===a?"download.txt":a,r=e.mime,o=void 0===r?"text/plain;charset=utf-8":r,i=e.data;return u.a.createElement("a",{className:"download-link",href:"data:".concat(o,",").concat(encodeURIComponent(i)),download:n},t)},nr=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchKeys().then(function(t){e.unmounting||e.setState({keyData:t})})}},{key:"componentWillUnmount",value:function(){this.unmounting=!0}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"private-key-identity clearfloat"},this.state&&this.state.keyData&&!this.props.keyMismatch&&u.a.createElement(ar,{filename:"politeia-pki.json",mime:"application/json;charset=utf-8",data:this.state.keyData},u.a.createElement("button",null,"Download Identity")),u.a.createElement("button",{className:"ReactFileReader",onClick:function(){return e.props.openModal(Bt.f)}},"Import Identity"))}},{key:"fetchKeys",value:function(){return Vn.c(this.props.loggedInAsEmail).then(function(e){return JSON.stringify(e,null,2)})}}]),t}(c.Component),rr=Ia(nr),or=function(e){var t=e.time;return u.a.createElement("span",null,new Date(1e3*t).toUTCString())},ir=function(e){var t=e.tokenLabel,a=e.token,n=e.expiry,r=e.userId,o=e.action,i=e.isRequesting,s=e.onManageUser;return u.a.createElement("div",null,u.a.createElement(Xt,{label:t},a),(new Date).getTime()>1e3*n?u.a.createElement(Xt,{label:"Expired"},"Yes"):u.a.createElement(Xt,{label:"Expires"},u.a.createElement(or,{time:n}),u.a.createElement(ze.a,{className:"c-btn c-btn-primary button-small",text:"Mark as expired",disabled:i,isLoading:i,onClick:function(){return s(r,o)}})))},sr=function(e){var t=e.email;return u.a.createElement("span",null,u.a.createElement("p",null,"Your new identity has been requested, please check your email at"," ",u.a.createElement("b",null,t)," to verify and activate it."),u.a.createElement("p",null,"The verification link needs to be open with the same browser that you used to generate this new identity."))},lr=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).updatePubkey=function(e,t,n){if(e&&n){var r=n.verificationtoken;if(t&&r!==t.verificationtoken||!t&&r)return a.setState({openedVerification:!0}),void a.props.history.push("/user/key/verify/?verificationtoken=".concat(r))}},a.refreshPubKey=function(){Object(Vn.a)(a.props.loggedInAsEmail).then(function(e){e&&Object(Vn.f)(a.props.loggedInAsEmail).then(function(e){a.unmounting||a.setState({pubkey:e,pubkeyStatus:T.ob})})})},a.onGenerateNewIdentity=function(){var e=a.props,t=e.onUpdateUserKey,n=e.loggedInAsEmail;(0,e.confirmWithModal)(Bt.c,{message:"Are you sure you want to generate a new identity?"}).then(function(e){return e&&t(n)})},a.identityHelpPrompt="Manage Identity",a.state={showIdentityHelpText:!1,openedVerification:!1,pubkey:"",pubkeyStatus:T.pb,showPastUserIdentities:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.loggedInAsEmail&&Object(Se.x)(this.props.loggedInAsEmail,this.props.userPubkey,this.props.keyMismatchAction)}},{key:"componentWillUnmount",value:function(){Object(Se.x)(this.props.loggedInAsEmail,this.props.userPubkey,this.props.keyMismatchAction),this.unmounting=!0,this.props.onIdentityImported(null),this.props.onResetRescan()}},{key:"componentDidUpdate",value:function(e){!e.loggedInAsEmail&&this.props.loggedInAsEmail&&Object(Se.x)(this.props.loggedInAsEmail,this.props.userPubkey,this.props.keyMismatchAction),this.state.openedVerification||(this.updatePubkey(this.props.shouldAutoVerifyKey,e.updateUserKey,this.props.updateUserKey),!e.identityImportSuccess&&this.props.identityImportSuccess&&this.refreshPubKey(),this.props.userPubkey!==this.state.pubkey&&this.refreshPubKey())}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.isApiRequestingMarkAsPaid,r=t.isApiRequestingMarkNewUserAsExpired,o=t.isApiRequestingMarkUpdateKeyAsExpired,i=t.isApiRequestingMarkResetPasswordAsExpired,s=t.isApiRequestingUpdateUserKey,l=t.isApiRequestingUnlockUser,c=t.onManageUser,m=t.isAdmin,d=t.loggedInAsEmail,p=t.onUpdateUserKey,h=t.updateUserKey,f=t.updateUserKeyError,b=t.onIdentityImported,v=t.identityImportSuccess,y=t.userPubkey,g=t.keyMismatch,E=t.isApiRequestingDeactivateUser,O=t.isApiRequestingReactivateUser,w=t.loggedInAsUserId,j=t.isLoadingRescan,C=t.onRescan,k=t.errorRescan,x=t.amountOfCreditsAddedOnRescan,S=t.onResetRescan,P=t.rescanUserId,N=t.isCMS,I=this.state,A=I.showIdentityHelpText,D=I.pubkey,F=I.pubkeyStatus,M=I.showPastUserIdentities,R=!N&&a&&a.newuserpaywalladdress&&a.newuserpaywallamount,V=w===a.id,U=void 0!==x&&P===a.id,L=a&&(m||w===a.id);return u.a.createElement("div",{className:"detail-tab-content"},!N&&L&&u.a.createElement(Xt,{label:"Proposal credits"},a.proposalcredits,m&&u.a.createElement(ze.a,{className:"c-btn c-btn-primary button-small",isLoading:j,onClick:function(){return C(a.id)},text:"rescan"})),U&&u.a.createElement(_.a,{type:"success",body:u.a.createElement("div",null,0===x?u.a.createElement("span",null,"User credits are up to date."):u.a.createElement("span",null,u.a.createElement("b",null,x," proposal credits "),"were found by the rescan and added to the user account.")),onDismissClick:S}),k&&u.a.createElement(_.a,{type:"error",body:k}),u.a.createElement(Qt,null),g&&!v&&V?u.a.createElement(Xt,{label:"Active Key"},u.a.createElement("div",{style:{color:"red"},className:"monospace"},"Your key is invalid or inexistent. Please create/import one under 'Manage Identity'")):w?u.a.createElement(Xt,{className:"account-info",label:"Active Public Key"},V?u.a.createElement("div",{className:"monospace no-text-overflow"},F===T.ob?D:"Loading public key..."):u.a.createElement("div",{className:"monospace no-text-overflow"},F!==T.ob||a.identities[a.identities.length-1].pubkey!==D?a.identities[a.identities.length-1].pubkey:"Loading public key...")):null,u.a.createElement(Xt,null,V&&u.a.createElement("div",null,A?u.a.createElement("div",null,u.a.createElement("span",{style:{fontWeight:"bold",maxWidth:"7em"},className:"ident-value"},this.identityHelpPrompt)," ",u.a.createElement("span",{className:"linkish",onClick:function(){return e.setState({showIdentityHelpText:!1})}},"(hide)")):u.a.createElement("span",{className:"linkish ident-value",style:{maxWidth:"7em"},onClick:function(){return e.setState({showIdentityHelpText:!0})}},this.identityHelpPrompt))),A&&V&&u.a.createElement("div",{className:"identity-help"},u.a.createElement("p",null,u.a.createElement("br",null),u.a.createElement("b",null,"What is an Identity:")," Each user has a unique ",u.a.createElement("i",null,"identity")," ","which is necessary for proving who the author of a proposal is. An identity was generated automatically for you when you created an account. Every identity is made up of a pair of keys: one public & one private."),u.a.createElement("br",null),u.a.createElement("ul",null,u.a.createElement("li",null,u.a.createElement("b",null,"Private key:"),' A key only you have access to that is used for creating a "signature" whenever you submit a proposal.'),u.a.createElement("br",null),u.a.createElement("li",null,u.a.createElement("b",null,"Public key:")," A key that you share with others (and DCC) which proves your proposal was signed with your private key.")),u.a.createElement("br",null),u.a.createElement("p",null,u.a.createElement("b",null,"Note:")," If you've lost your identity (because you've switched browsers or cleared your cookies, for example), you can create a new one. This new identity will replace your existing one, but note that DCC keeps a record of all your past public keys. You can also download your current identity for future use or import an existing one."),u.a.createElement("br",null),g&&!v&&u.a.createElement(_.a,{type:"error",className:"account-page-message",header:"Action needed",body:u.a.createElement("div",null,u.a.createElement("p",null,"The public key on the DCC server differs from the key on your browser. This is usually caused from the local data on your browser being cleared or by using a different browser."),u.a.createElement("p",null,"You can fix this by importing your old identity, logging in with the proper browser, or by creating a new identity (destroying your old identity)."))}),h&&h.success&&u.a.createElement(_.a,{type:"info",header:"Verification required",body:u.a.createElement(sr,{email:d})}),f&&u.a.createElement(_.a,{type:"error",header:"Error generating new identity",body:f.message}),v&&u.a.createElement(_.a,{type:"success",header:v}),u.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},u.a.createElement(ze.a,{className:"c-btn c-btn-primary",text:s?"":"Create new identity",disabled:h&&h.success||this.state.openedVerification,isLoading:s,onClick:this.onGenerateNewIdentity,style:{width:"250px"}}),u.a.createElement(rr,{loggedInAsEmail:d,onUpdateUserKey:p,onIdentityImported:b,userPubkey:y})),u.a.createElement(Qt,null)),u.a.createElement(Qt,null),w?u.a.createElement(Xt,{label:"Past Public Keys",style:{float:"left"}},M?u.a.createElement("span",null,u.a.createElement("span",{style:{fontWeight:"bold"}},"Expanded"),u.a.createElement("span",{className:"linkish",style:{paddingLeft:"1em"},onClick:function(){return e.setState({showPastUserIdentities:!1})}},"(hide)")):u.a.createElement("span",{className:"linkish",onClick:function(){return e.setState({showPastUserIdentities:!0})}},"Expand"),M&&u.a.createElement("ul",null,a.identities.map(function(e,t){return u.a.createElement("ul",{key:e.pubkey,style:{lineHeight:"2em"}},u.a.createElement("li",{style:{float:"left",fontWeight:"bold",marginRight:".75em",lineHeight:"1.5em"}},t+1,")"),u.a.createElement("li",{className:"monospace"},e.pubkey))}))):null,u.a.createElement(Qt,null),L&&u.a.createElement("div",null,u.a.createElement(ir,{tokenLabel:"Registration token",token:" "+a.newuserverificationtoken+" ",expiry:a.newuserverificationexpiry,userId:a.id,action:T.E,isRequesting:r,onManageUser:c}),a.newuserverificationtoken?u.a.createElement("div",null,u.a.createElement(Xt,{label:"Verified email"},"No"),u.a.createElement(ir,{tokenLabel:"Registration token",token:" "+a.newuserverificationtoken+" ",expiry:a.newuserverificationexpiry,userId:a.id,action:T.E,isRequesting:r,onManageUser:c})):u.a.createElement(Xt,{label:"Verified email"},"Yes")),!N&&L&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Has paid"},a&&""!==a.newuserpaywalltx?"Yes":[u.a.createElement("span",null,"No"),m&&u.a.createElement(ze.a,{className:"c-btn c-btn-primary button-small",text:"Mark as paid",disabled:n,isLoading:n,onClick:function(){return c(a.id,T.C)}})])),R?u.a.createElement("div",null,u.a.createElement(Xt,{label:"Address"},u.a.createElement("div",{className:"monospace"}," "+a.newuserpaywalladdress+" ")),u.a.createElement(Xt,{label:"Amount"},a.newuserpaywallamount/1e8," DOS"),!a.newuserpaywalltx&&[u.a.createElement(Xt,{label:"Pay after"},u.a.createElement(or,{time:a.newuserpaywalltxnotbefore})),u.a.createElement(Qt,null)]):null,!N&&a.newuserpaywalltx&&[u.a.createElement(Xt,{label:"Transaction",key:0},"cleared_by_admin"===a.newuserpaywalltx?u.a.createElement("span",null,"Cleared by admin"):null),u.a.createElement(Qt,{key:2})],L&&u.a.createElement(Xt,{label:"Failed login attempts"},a.failedloginattempts)&&u.a.createElement(Xt,{label:"Locked"},a.islocked?[u.a.createElement("span",null,"Yes"),u.a.createElement(ze.a,{className:"c-btn c-btn-primary button-small",text:"Unlock user",disabled:l,isLoading:l,onClick:function(){return c(a.id,T.I)}})]:"No"),m&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"Deactivated"},a.isdeactivated?u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{style:{fontWeight:"bold",color:"red"}},"Yes"),u.a.createElement(ze.a,{className:"c-btn c-btn-primary button-small",text:"Re-activate account",disabled:O,isLoading:O,onClick:function(){return c(a.id,T.H)}})):u.a.createElement(u.a.Fragment,null,u.a.createElement("span",null,"No"),u.a.createElement(ze.a,{className:"c-btn c-btn-primary button-small",text:"Deactivate account",disabled:E,isLoading:E,onClick:function(){return c(a.id,T.D)}})))),!V&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Xt,{label:"Admin (Y/N)"},a&&a.isadmin?u.a.createElement("div",null,"Yes"):u.a.createElement("div",null,"No"))),u.a.createElement(Qt,null),u.a.createElement(Xt,{label:"User ID"},u.a.createElement("div",{className:"monospace"},a.id)),a.updatekeyverificationtoken&&[u.a.createElement(ir,{tokenLabel:"Update key token",token:" "+a.updatekeyverificationtoken+" ",expiry:a.updatekeyverificationexpiry,userId:a.id,action:T.G,isRequesting:o,onManageUser:c}),u.a.createElement(Qt,null)],a.resetpasswordverificationtoken&&u.a.createElement(u.a.Fragment,null,u.a.createElement(ir,{tokenLabel:"Reset password token",token:" "+a.resetpasswordverificationtoken+" ",expiry:a.resetpasswordverificationexpiry,userId:a.id,action:T.F,isRequesting:i,onManageUser:c}),u.a.createElement(Qt,null)))}}]),t}(u.a.Component),cr=Ia(lr),ur=a(1246),mr=Object(p.b)(S.Vd({userId:Object(ur.compose)(Object(ur.get)(["match","params","userId"]),Object(x.b)(1)),loggedInAsUserId:S.pe,user:S.ie,isAdmin:S.Yb,isApiRequestingEditUser:S.gc,editUserResponse:S.k,editUserError:S.bb,initialValues:S.mb}),{onEditUser:P.t}),dr=Object(ur.compose)(mr,Object(Ke.a)({form:"form/user-preferences"})),pr=function(e){var t=e.children;return u.a.createElement("div",{style:{marginBottom:24}},t)},hr=function(e){var t=e.children;return u.a.createElement("h3",{style:{marginBottom:8}},t)},fr=function(e){var t=e.label,a=e.fieldWidth,n=void 0===a?30:a,r=e.children;return u.a.createElement("div",{className:"field"},u.a.createElement("label",{className:"field-label",style:{minHeight:1,width:220}},t&&t+":"),u.a.createElement("div",{className:"field-value",style:{width:n}},r),u.a.createElement("div",{className:"clear"}))},br=dr(function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).onEditUser=function(){var e;return a.setState({showEditUserMessage:!0}),(e=a.props).onEditUser.apply(e,arguments)},a.onChange=function(){a.setState({formChanged:!0})},a.formRef=u.a.createRef(),a.state={showEditUserMessage:!1,formChanged:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.handleSubmit,n=e.editUserResponse,r=e.editUserError,o=e.isApiRequestingEditUser,i=e.isAdmin,s=e.loggedInAsUserId,l=t&&s===t.id;return u.a.createElement("form",{className:"detail-tab-content",onSubmit:a(this.onEditUser)},this.state.showEditUserMessage&&u.a.createElement(c.Fragment,null,r&&u.a.createElement(_.a,{type:"error",header:"Error saving preferences",body:r}),n&&u.a.createElement(_.a,{type:"success",header:"Preferences saved"})),u.a.createElement("p",{style:{marginBottom:16}},u.a.createElement("b",null,"Note:")," Currently, each notification email is only attempted to be sent once. If the email cannot be delivered in the initial attempt, for whatever reason, DCC won't try to resend it."),u.a.createElement(pr,null,u.a.createElement(hr,null,"Email notifications for my proposals"),u.a.createElement(fr,{label:"Proposal approved or censored"},u.a.createElement(Ye.a,{autoFocus:!0,name:"myproposalnotifications-statuschange",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange})),u.a.createElement(fr,{label:"Voting started for proposal"},u.a.createElement(Ye.a,{name:"myproposalnotifications-votestarted",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange}))),u.a.createElement(pr,null,u.a.createElement(hr,null,"Email notifications for others' proposals"),u.a.createElement(fr,{label:"New proposal published"},u.a.createElement(Ye.a,{name:"regularproposalnotifications-vetted",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange})),u.a.createElement(fr,{label:"Proposal edited"},u.a.createElement(Ye.a,{name:"regularproposalnotifications-edited",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange})),u.a.createElement(fr,{label:"Voting started for proposal"},u.a.createElement(Ye.a,{name:"regularproposalnotifications-votestarted",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange}))),i&&l&&u.a.createElement(pr,null,u.a.createElement(hr,null,"Admin email notifications"),u.a.createElement(fr,{label:"New proposal submitted"},u.a.createElement(Ye.a,{name:"adminproposalnotifications-new",component:"input",type:"checkbox",onChange:this.onChange})),u.a.createElement(fr,{label:"Voting authorized for proposal"},u.a.createElement(Ye.a,{name:"adminproposalnotifications-voteauthorized",component:"input",type:"checkbox",onChange:this.onChange}))),u.a.createElement(pr,null,u.a.createElement(hr,null,"Comment email notifications"),u.a.createElement(fr,{label:"New comment on your proposal"},u.a.createElement(Ye.a,{name:"commentnotifications-proposal",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange})),u.a.createElement(fr,{label:"New comment reply to your comment"},u.a.createElement(Ye.a,{name:"commentnotifications-comment",component:"input",type:"checkbox",disabled:!l,onChange:this.onChange}))),l&&u.a.createElement(fr,{fieldWidth:250},u.a.createElement(ze.a,{className:"c-btn c-btn-primary c-pull-left",type:"submit",disabled:o||!this.state.formChanged,isLoading:o,text:"Save preferences"})))}}]),t}(u.a.Component)),vr=Ia(function(e){var t=e.user,a=e.loggedInAsEmail,n=e.isAdmin,r=e.onFetchUserProposals,o=e.count,i=e.lastLoadedProposal,s=e.lastLoadedUserDetailProposal,l=e.getSubmittedUserProposals,c=e.isLoadingProposals;return u.a.createElement(pa,{isLoading:c,loggedInAsEmail:a,isAdmin:n,count:o,userid:t.id,lastLoadedProposal:i&&Object.keys(i).length>0?i:s,proposals:l(t.id),onFetchUserProposals:r,emptyProposalsMessage:"This user has not submitted any proposals"})}),yr=Ia(function(e){var t=e.isLoading,a=e.user,n=e.loggedInAsUserId,r=e.loggedInAsUsername,o=e.error,i=e.tabId,s=e.onTabChange,l=e.dcrdataTxUrl,c=e.getSubmittedUserProposals,m=e.isCMS,d=a&&a.id&&c(a.id);return u.a.createElement("div",{className:"content user-page",role:"main"},t&&u.a.createElement(le,null),o&&u.a.createElement(_.a,{type:"error",header:"Error loading user",body:o}),a&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"detail-header"},u.a.createElement("h1",{className:"content-title"},n===a.id?r:a.username,a.isadmin&&u.a.createElement("span",{className:"detail-admin"},"(admin user)"))),u.a.createElement("div",{className:"content-subtitle"},a.email),u.a.createElement(de.b,null,u.a.createElement(de.a,{title:"General",selected:i===T.wb,tabId:T.wb,onTabChange:s}),m?null:u.a.createElement(de.a,{title:"Preferences",selected:i===T.xb,tabId:T.xb,onTabChange:s}),m?null:u.a.createElement(de.a,{title:"Proposals",count:d.length,selected:i===T.yb,tabId:T.yb,onTabChange:s})),i===T.wb&&u.a.createElement(cr,{dcrdataTxUrl:l}),i===T.xb&&u.a.createElement(br,null),i===T.yb&&u.a.createElement(vr,{count:d.length})))}),gr=(a(1248),[{label:"general",value:T.wb},{label:"preferences",value:T.xb},{label:"proposals",value:T.yb}]),Er=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleUpdateFilterValueForQueryValue=function(){var e=Object(M.a)("tab"),t=gr.find(function(t){return t.label===e});return t?t.value:T.wb},a.handleUpdateQueryForFilterValueChange=function(e){var t=e.tabId!==a.state.tabId,n=gr.find(function(e){return e.value===a.state.tabId});t&&Object(M.d)("tab",n.label)},a.state={tabId:a.handleUpdateFilterValueForQueryValue(e)},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){this.handleUpdateQueryForFilterValueChange(e)}},{key:"componentDidMount",value:function(){this.props.onFetchData(this.props.userId),!this.props.isCMS&&this.props.onFetchUserProposals(this.props.userId)}},{key:"onTabChange",value:function(e){this.setState({tabId:e})}},{key:"componentWillUnmount",value:function(){this.unmounting=!0}},{key:"render",value:function(){var e=this.props.isTestnet?"https://testnet.doschain.org/tx/":"https://mainnet.doschain.org/tx/";return u.a.createElement(yr,Object(v.a)({},this.props,{dcrdataTxUrl:e,tabId:this.state.tabId,onTabChange:this.onTabChange}))}}]),t}(c.Component);Object(Ue.a)(Er);var Or=Ia(Er),wr=a(97),jr=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc,isAdmin:S.Yb,apiMeResponse:S.t,apiLoginResponse:S.r,openedModals:S.Ob}),{redirectedFrom:wr.pb}),Cr=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).checkAuthentication(e),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.loggedInAsEmail&&this.props.location===e.location||this.checkAuthentication(this.props)}},{key:"checkAuthentication",value:function(e){var t=e.loggedInAsEmail,a=e.apiMeResponse,n=e.apiLoginResponse,r=e.history,o=e.location,i=a||n,s=Object(Lt.c)(),l=i&&t,c=s&&s.api&&s.api.me&&s.api.me.response;return!(!l&&!c)||(!l&&!c&&this.props.openedModals.length>0||(this.props.redirectedFrom(this.props.location.pathname),void r.replace({pathname:"/user/login",state:{from:o}})))}},{key:"render",value:function(){var e=this.props,t=e.component,a=Object(y.a)(e,["component"]);return u.a.createElement(Rt.a,Object.assign({},a,{render:function(e){return u.a.createElement(t,e)}}))}}]),t}(c.Component),kr=jr(Object(m.a)(Cr)),xr=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.props,t=e.apiMeResponse,a=e.apiLoginResponse,n=e.isAdmin;!(t||a)||n||this.props.history.replace({pathname:"/"})}}]),t}(Cr),Sr=jr(Object(m.a)(xr)),Pr=Object(m.a)(jr(function(e){var t=e.loggedInAsEmail,a=e.history,n=Object(y.a)(e,["loggedInAsEmail","history"]);return Object(c.useEffect)(function(){t&&a.push("/")},[t,a]),u.a.createElement(Rt.a,n)})),Nr=(a(1249),function(){return u.a.createElement("div",{className:"content"},u.a.createElement("h1",{className:"content-title"},"Public Proposals"),u.a.createElement(de.b,null,u.a.createElement(de.a,{title:"In Discusssion",count:""}),u.a.createElement(de.a,{title:"Voting",count:""}),u.a.createElement(de.a,{title:"Approved",count:""}),u.a.createElement(de.a,{title:"Rejected",count:""}),u.a.createElement(de.a,{title:"Abandoned",count:""})),u.a.createElement(se,{width:200,style:{paddingTop:"100px",margin:"0 auto"}}))}),Ir=a(204),Ar=Object(c.lazy)(function(){return a.e(14).then(a.bind(null,1273))}),Dr=function(){return u.a.createElement(c.Suspense,{fallback:u.a.createElement(Nr,null)},u.a.createElement("div",{className:"content"},u.a.createElement("h1",{className:"content-title"},"Public Proposals"),u.a.createElement(Ir.a,{title:"Failed to fetch public proposals"},u.a.createElement(Ar,null))))},Fr=Object(p.b)(S.Vd({isCMS:S.Mc,isTestnet:S.Rc}),function(e){return Object(O.b)({},e)})(function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isCMS,a=e.isTestnet;return u.a.createElement("div",{className:"content page signup-next-step-page",role:"main",style:{minHeight:"calc(100vh - 350px)"}},u.a.createElement("div",{className:"text-wrapper"},u.a.createElement("div",{className:"centered"},t?u.a.createElement(u.a.Fragment,null,u.a.createElement("h3",null,"Privacy Policy"),u.a.createElement("ul",null,u.a.createElement("li",null,"The ",u.a.createElement(L,{href:"/"},"dcc.doschain.org")," database stores your account email address, username, cryptographic identity public key(s), IP addresses and invoice transaction details - and associates this data with all of your invoices, comments and up/down votes."),u.a.createElement("li",null,"Your email address will be kept private and will not be shared with any third parties."))):u.a.createElement(u.a.Fragment,null,u.a.createElement("h3",null,"Privacy Policy"),u.a.createElement("ul",null,u.a.createElement("li",null,"The ",u.a.createElement(L,{href:"/"},"dcc.doschain.org")," database stores your account email address, username, cryptographic identity public key(s), IP addresses and payment transaction details - and associates this data with all of your proposals, comments and up/down votes."),u.a.createElement("li",null,"Your email address will be kept private and will not be shared with any third parties."),u.a.createElement("li",null,"In the interests of transparency, data associating your public key with content contributions will be published openly in the Demos-proposals repository here:"," ",u.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:a?T.vb:T.B,style:{fontSize:"1.01em"}},"".concat(a?T.vb:T.B))))))))}}]),t}(u.a.Component)),Tr=Object(p.b)(S.Vd({invoices:S.ib,showLookUp:S.Zc,invoiceCounts:S.jb,error:S.de,isLoading:Object(x.f)(S.Zb),filterValue:S.hb,header:function(){return T.e},emptyProposalsMessage:function(){return"No invoices"},lastLoadedProposal:S.Tc,monthFilterValue:S.qb,yearFilterValue:S.Nb}),{onFetchData:P.u,onChangeFilter:P.i,onChangeDateFilter:P.j,onResetDateFilter:P.hb}),Mr=Object(p.b)(S.Vd({token:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","token"]),Object(x.b)(1)),commentid:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","commentid"]),Object(x.b)(1)),tempThreadTree:S.wb,loggedInAsEmail:S.Zc,isAdmin:S.Yb,record:S.Sb,error:Object(x.f)(S.Gd,S.x),isLoading:S.Wb,otherFiles:S.rb,commentsSortOption:S.T,openedModals:S.Ob,isCMS:S.Mc,comments:S.Tb}),function(e){return Object(O.b)({onFetchData:P.x,onSetReplyParent:P.Eb,onFetchLikedComments:P.y,onSetCommentsSortOption:P.Bb,resetLastSubmittedProposal:P.Tb,onDeleteDraftInvoice:P.o},e)}),Rr=Object(p.b)(S.Vd({isLoading:Object(x.f)(S.Nc,S.ed),description:S.gd,error:S.dd,submitError:S.dd,policy:S.yd,token:S.fd,month:S.Ub,year:S.Vb,exchangeRate:S.eb,loadingExchangeRate:S.hc,exchangeRateError:S.m,draftInvoiceById:S.V,draftInvoice:S.V}),{onFetchData:P.Q,onSave:P.xb,onResetInvoice:P.jb,onFetchExchangeRate:P.v,onSaveInvoiceDraft:P.ub,onDeleteDraftInvoice:P.o}),Vr=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onSaveInvoice=function(){for(var e,t=a.props.exchangeRate,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r[0].exchangerate=t,(e=a.props).onSave.apply(e,r)},a.state={initialValues:e.draftInvoice||Object(Ta.a)(),validationError:""},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.token,n=t.onResetInvoice,r=t.draftInvoice;if(a)return this.props.draftInvoiceById&&this.props.onDeleteDraftInvoice(this.props.draftInvoiceById.draftId),n(),this.props.history.push("/invoices/"+a);!e.draftInvoice&&r&&this.setState({initialValues:r})}},{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object(v.a)({},this.props,{onSave:this.onSaveInvoice.bind(this),initialValues:this.state.initialValues,onChange:this.onChange}))}}]),t}(c.Component),Ur=k()(Rr,function(e){return function(t){return u.a.createElement(Vr,Object(v.a)({},t,{Component:e}))}}),Lr=Object(p.b)(S.Vd({token:k()(function(e){return e?e.toLowerCase():e},j()(["match","params","token"]),Object(x.b)(1)),editedInvoiceToken:S.Z,submitError:S.h,invoice:S.Sb,otherFiles:S.rb,isLoading:Object(x.f)(S.Nc,S.fc),loggedInAsEmail:S.Zc,userCanExecuteActions:S.je,policy:S.yd,userid:S.pe,username:S.ad,keyMismatch:S.nb,month:S.Ub,year:S.Vb,exchangeRate:S.eb,loadingExchangeRate:S.hc,exchangeRateError:S.m}),{onFetchData:P.Q,onFetchInvoice:P.w,onResetInvoice:P.jb,onSave:P.q,onFetchExchangeRate:P.v,onDeleteDraftInvoice:P.o}),_r=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onSave=function(){for(var e,t=a.props.exchangeRate,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];r[0].exchangerate=t,(e=a.props).onSave.apply(e,r.concat([a.props.token]))},a.onCancel=function(){return a.props.history.push("/invoices/".concat(a.props.token))},a.state={},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.token;this.props.policy||this.props.onFetchData(),this.props.onFetchInvoice&&this.props.onFetchInvoice(e)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.editedInvoiceToken,a=e.invoice;if(t)return this.props.onResetInvoice(),this.props.history.push("/invoices/"+t);var n=null!==this.props.userid,r=a&&a.censorshiprecord&&a.censorshiprecord.token===this.props.token,o=a&&a.userid===this.props.userid;if(r&&!this.state.initialValues){var i=a.input;this.setState({initialValues:{month:i.month,year:i.year,name:i.contractorname,contact:i.contractorcontact,location:i.contractorlocation,rate:Object(Se.g)(i.contractorrate),address:i.paymentaddress,lineitems:Object(Jt.e)(i.lineitems,i.contractorrate),files:this.props.otherFiles}})}r&&n&&!o&&this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.Component;return u.a.createElement(e,Object(v.a)({},this.props,{validationError:this.state.validationError,initialValues:this.state.initialValues,editingMode:!0,onSave:this.onSave,onCancel:this.onCancel}))}}]),t}(c.Component),qr=k()(Lr,function(e){return function(t){return u.a.createElement(_r,Object(v.a)({},t,{Component:e}))}}),Wr=Object(p.b)(S.Vd({userid:S.pe,loggedInAsEmail:S.Zc,isAdmin:S.Yb,error:S.me,isLoading:Object(x.f)(S.Ic),invoices:S.Cb,invoiceCounts:S.Db,filterValue:S.Bb,lastLoadedInvoice:S.Vc,header:function(){return T.f},emptyInvoicesMessage:function(){return"You have not created any invoices yet"},monthFilterValue:S.qb,yearFilterValue:S.Nb}),function(e){return Object(O.b)({onFetchUserInvoices:P.L,onChangeFilter:P.l,onChangeDateFilter:P.j,onResetDateFilter:P.hb},e)}),Hr=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e.onChangeFilter,n=e.userid;t.params&&"undefined"!==typeof t.params.filter&&a({drafts:T.gb}[t.params.filter]),n&&this.props.onFetchUserInvoices(n)}},{key:"componentDidUpdate",value:function(e){var t=this.props.userid;!e.userid&&this.props.userid&&this.props.onFetchUserInvoices(t)}},{key:"render",value:function(){var e=this.props,t=e.Component,a=Object(y.a)(e,["Component"]);return u.a.createElement("div",{className:"page content user-proposals-page"},u.a.createElement(t,Object(v.a)({},a)))}}]),t}(c.Component),Yr=function(e){return Wr(function(t){return u.a.createElement(Hr,Object(v.a)({},t,{Component:e}))})},zr=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"page content"},u.a.createElement(pa,this.props))}}]),t}(c.Component);Object(Ue.a)(zr);var Br=Yr(Object(m.a)(zr)),Kr=Object(Ke.a)({form:"form/inviteuser"})(function(e){var t=e.error,a=e.handleSubmit,n=e.onInviteUser,r=e.isRequesting,o=e.isShowingInviteUserConfirmation,i=e.isApiRequestingInviteUser;return r?u.a.createElement(va,null):u.a.createElement("div",null,u.a.createElement("form",{className:"reset-password-form",onSubmit:a(n)},t&&u.a.createElement(_.a,{type:"error",header:" error",body:t}),u.a.createElement(Ye.a,{name:"global",component:Be.a}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"email"},"Email:"),u.a.createElement(Ye.a,{autoFocus:!0,className:"c-form-control",id:"email",name:"email",component:"input",type:"test",placeholder:"Email",tabIndex:3})),u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement("button",{className:"c-btn c-btn-primary c-pull-right",tabIndex:3,type:"submit"},"Invite User"))),o?u.a.createElement(_.a,{type:"info",header:"Before you continue please confirm..."},u.a.createElement(ze.a,{style:{marginRight:"0px",overflow:"hidden"},className:"c-btn c-btn-primary c-pull-right",tabIndex:3,text:"Confirm, invite user",isLoading:i})):null)}),Zr=Object(p.b)(S.Vd({inviteUserResponse:S.Rb,isRequesting:S.lc,loggedInAsEmail:S.Zc,policy:S.yd,isApiRequestingInviteUser:S.lc}),{onInviteUserConfirm:P.S,resetInviteUser:P.ib,onFetchData:P.Q}),Qr=function(e){if(!K(e.email))throw new q.a({_error:"All fields are required"});if(!W(e.email))throw new q.a({_error:"Invalid email address"})},Xr=a(1250),Gr=function(e){function t(e){var a;Object(r.a)(this,t);var n=(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).getQueryParams();return Ja(n.email)&&Ja(n.verificationtoken)?Object(i.a)(a):a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetInviteUser()}},{key:"componentDidUpdate",value:function(){this.props.inviteUserResponse&&this.props.history.push("/admin/invite/next")}},{key:"componentDidMount",value:function(){this.props.onFetchData()}},{key:"render",value:function(){return this.props.loggedInAsEmail?u.a.createElement(Kr,{onInviteUser:this.onInviteUser,isRequesting:this.props.isRequesting}):u.a.createElement("div",{className:"content"},u.a.createElement(_.a,{type:"error",header:"Forbidden",body:"This is an admin protected area. Please login to your account."}))}},{key:"getQueryParams",value:function(){return Xr.parse(this.props.location.search)}},{key:"onInviteUser",value:function(e){var t=this.props.policy;return Qr(e,t),this.props.onInviteUserConfirm(ln()({email:e.email},this.getQueryParams())).catch(function(e){throw new q.a({_error:e.message})})}}]),t}(c.Component);Object(Ue.a)(Gr);var Jr=Zr(Object(m.a)(Gr)),$r=function(){return u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("div",{className:"page reset-password-page"},u.a.createElement("h1",null,"Invite User"),u.a.createElement(Jr,null)))},eo=function(){return u.a.createElement("div",{className:"page reset-password-next-step-page content"},u.a.createElement(_.a,{type:"success",className:"account-page-message",header:"Invite new contractor completed!",body:u.a.createElement("div",null,u.a.createElement("p",null,"You have successfully invited a user!"))}))},to=Object(p.b)(S.Vd({userid:S.pe,loggedInAsEmail:S.Zc,isAdmin:S.Yb,error:Object(x.f)(S.le,S.a),isLoading:Object(x.f)(S.Ic,S.Zb),userInvoices:S.L,adminInvoices:S.c}),function(e){return Object(O.b)({onFetchUserInvoices:P.L,onFetchAdminInvoices:P.u},e)}),ao=function(e){var t=e.children,a=e.title;return u.a.createElement(u.a.Fragment,null,u.a.createElement("h2",{className:"reminders-title"},a),u.a.createElement("ul",{className:"reminder-list"},t))},no=function(e){var t=e.text,a=e.doneText,n=e.done,r=e.actionText,o=e.actionLink,i=e.isAdmin;return u.a.createElement("li",{className:"reminder-item"},u.a.createElement("span",{className:"reminder-item_icon ".concat(n?"done":"")},function(e){return e?"\u2714":"\u2139\ufe0e"}(n)),u.a.createElement("span",{className:"reminder-item_text"},"".concat(i?"[admin] ":"").concat(n&&a?a:t)),!!r&&!!o&&!n&&u.a.createElement(ha,{href:o},r))},ro=j()(["input","year"]),oo=j()(["input","month"]),io=function(){var e=Object(Se.i)(),t=Object(Se.j)();return{month:1===e?12:e-1,year:1===e?t-1:t}},so=function(e){var t=e.invoices,a=io(),n=a.month,r=a.year,o=t.find(function(e){return ro(e)===r&&oo(e)===n});return u.a.createElement(u.a.Fragment,null,u.a.createElement(no,{done:!!o,text:"You have not yet submitted your invoice for the previous month.",doneText:"You already submitted an invoice for the previous month.",actionText:"Submit now",actionLink:"invoices/new",isAdmin:!1}))},lo=function(e){var t=e.invoices,a=io(),n=a.month,r=a.year,o=t.filter(function(e){return e.status===T.r}),i=t.filter(function(e){return ro(e)===r&&oo(e)===n}),s=i.filter(function(e){return e.status===T.r});return u.a.createElement(u.a.Fragment,null,u.a.createElement(no,{isAdmin:!0,done:!o.length,text:"".concat(o.length," invoice(s) with pending review."),doneText:"All invoices are reviewed.",actionText:"Review",actionLink:"admin/?tab=unreviewed"}),u.a.createElement(no,{isAdmin:!0,done:!s.length,text:"".concat(i.length," invoice(s) int the previous month. ").concat(s.length," with pending review."),doneText:"".concat(i.length," invoice(s) in the previous month. All reviewed."),actionText:"Review",actionLink:"admin/?month=".concat(n,"&year=").concat(r)}))},co=function(e){var t=e.userid,a=e.onFetchUserInvoices,n=e.onFetchAdminInvoices,r=e.isAdmin,o=e.error,i=e.isLoading,s=e.userInvoices,l=e.adminInvoices,m=e.loggedInAsEmail,d=e.history;return Object(c.useEffect)(function(){t?(a(t),r&&n()):t||m||d.replace({pathname:"/user/login"})},[t]),t&&m?u.a.createElement("div",{className:"content"},u.a.createElement("h1",{className:"content-title"},"Contractor Management System"),i?u.a.createElement(va,null):o?u.a.createElement(_.a,{header:"Error fetching invoices",type:"error",body:o}):u.a.createElement("div",{style:{paddingLeft:"24px"}},u.a.createElement(ao,{title:"Reminders"},u.a.createElement(so,{invoices:s}),r&&u.a.createElement(lo,{invoices:l})))):null};co.defaultProps={userInvoices:[],adminInvoices:[]};var uo,mo,po,ho=to(co),fo=(a(1253),ho),bo=(a(1254),Object(p.b)(S.Vd({payouts:S.td,error:S.gb,loading:S.jc,loggedInAsEmail:S.Zc,isApiRequestingPayInvoices:S.uc}),{onGeneratePayouts:P.P,onPayApprovedInvoices:P.bb,confirmWithModal:P.c})),vo=function(e){var t=e.year,a=e.month,n=e.contractorname,r=e.contractorrate,o=e.labortotal,i=e.expensetotal,s=e.address,l=e.exchangerate,c=e.dcrtotal,m=e.approvedtime;return u.a.createElement("tr",null,u.a.createElement("td",null,new Date(1e3*m).toString()),u.a.createElement("td",null,t),u.a.createElement("td",null,a),u.a.createElement("td",null,n),u.a.createElement("td",null,r/100),u.a.createElement("td",null,o/100),u.a.createElement("td",null,i/100),u.a.createElement("td",null,(i+o)/100),u.a.createElement("td",null,l/100),u.a.createElement("td",null,c/1e8),u.a.createElement("td",null,s))},yo=function(e){var t=e.payouts;return u.a.createElement("table",{className:"payouts-table"},u.a.createElement("tbody",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Approved Time"),u.a.createElement("th",null,"Year"),u.a.createElement("th",null,"Month"),u.a.createElement("th",null,"Name"),u.a.createElement("th",null,"Rate (USD)"),u.a.createElement("th",null,"Labor total (USD)"),u.a.createElement("th",null,"Expense total (USD)"),u.a.createElement("th",null,"Combined total (USD)"),u.a.createElement("th",null,"Exchange Rate (USD)"),u.a.createElement("th",null,"Total Payment (DOS)"),u.a.createElement("th",null,"Address")),t.map(function(e,t){return u.a.createElement(vo,Object.assign({key:"payout-".concat(t)},e))})))},go=function(e){var t=e.children,a=e.data,n=e.fields,r=e.filename;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{onClick:function(){!function(e,t,a){var n=e.reduce(function(e,a){var n="";return t.forEach(function(e){return n+='"'.concat(a[e],'",')}),e+n+"\n"},""),r=t.reduce(function(e,t){return e+'"'.concat(t,'",')},""),o=encodeURI("data:text/csv;charset=utf-8,"+r+"\n"+n),i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download",a),document.getElementById("csv-hidden-div").appendChild(i),i.click()}(a,n,r)}},t),u.a.createElement("div",{id:"csv-hidden-div",style:{display:"none"}}))},Eo=bo(function(e){var t=e.payouts,a=void 0===t?[]:t,n=e.error,r=e.loading,o=e.loggedInAsEmail,i=e.onGeneratePayouts,s=e.onPayApprovedInvoices,l=e.confirmWithModal,m=e.isApiRequestingPayInvoices;Object(c.useEffect)(function(){i()},[]);var d=a.map(function(e){return Object(v.a)({},e,{approvedtime:new Date(1e3*e.approvedtime).toString(),combinedtotal:e.labortotal+e.expensetotal})});return o?r?u.a.createElement(va,null):n?u.a.createElement("div",{className:"content"},u.a.createElement(_.a,{type:"error",header:"Could not generate payouts",body:n})):u.a.createElement("div",{className:"content"},u.a.createElement("h1",{className:"content-title"},"Payouts"),u.a.createElement("div",{style:{paddingLeft:"24px"}},u.a.createElement(go,{data:d,fields:["approvedtime","year","month","contractorname","contractorrate","labortotal","expensetotal","combinedtotal","exchangerate","dcrtotal","address"],filename:"payouts"},u.a.createElement("button",{className:"inverse payouts-btn-export-to-csv "},"Export to CSV")),a&&u.a.createElement(yo,{payouts:a})),u.a.createElement("div",{id:"csv-hidden-div",style:{display:"none"}}),a.length>0?u.a.createElement("div",{className:" payouts-btn-pay-invoices"},u.a.createElement(ze.a,{className:"inverse",onClick:function(e){return l(Bt.c,{message:"Are you sure you want to set all of these approved invoices to paid?"}).then(function(e){return e&&s()})&&e.preventDefault()},text:"Set invoices to paid",isLoading:m})):null):u.a.createElement("div",{className:"content"},u.a.createElement(_.a,{type:"error",header:"Forbidden",body:"This is an admin protected area. Please login to your account."}))}),Oo=function(){return u.a.createElement(Mt.a,null,u.a.createElement(Rt.a,{path:"/",component:fo,exact:!0}),u.a.createElement(Pr,{path:"/login",component:ba}),u.a.createElement(Pr,{path:"/register",component:ba}),u.a.createElement(Pr,{path:"/user/login",component:ba}),u.a.createElement(Pr,{path:"/user/logout",component:Wa}),u.a.createElement(Pr,{path:"/user/signup/next",component:Ka}),u.a.createElement(Pr,{path:"/user/signup",component:ba}),u.a.createElement(Pr,{exact:!0,path:"/password",component:an}),u.a.createElement(Pr,{exact:!0,path:"/user/forgotten/password",component:an}),u.a.createElement(Pr,{exact:!0,path:"/user/forgotten/password/next",component:on}),u.a.createElement(Pr,{exact:!0,path:"/user/password/reset",component:hn}),u.a.createElement(Pr,{exact:!0,path:"/user/password/reset/next",component:fn}),u.a.createElement(Rt.a,{path:"/user/verify",component:An,exact:!0}),u.a.createElement(Rt.a,{path:"/user/key/verify",component:_n,exact:!0}),u.a.createElement(Rt.a,{path:"/privacy-policy/",component:Fr}),u.a.createElement(Sr,{path:"/admin",component:Tr(pa),exact:!0}),u.a.createElement(Sr,{path:"/admin/users",component:za}),u.a.createElement(Sr,{path:"/admin/payouts",component:Eo}),u.a.createElement(kr,{path:"/user/invoices/:filter?",component:Br,exact:!0}),u.a.createElement(Rt.a,{path:"/user/:userId/:filter?",component:Ia(Or),exact:!0}),u.a.createElement(kr,{path:"/invoices/new",component:Ur(ya),exact:!0}),u.a.createElement(kr,{path:"/invoices/:token/edit",component:qr(ya)}),u.a.createElement(Rt.a,{path:"/invoices/:token",component:Mr(tr),exact:!0}),u.a.createElement(Rt.a,{path:"/invoices/:token/comments/:commentid",component:Mr(tr)}),u.a.createElement(Sr,{path:"/admin/invite",component:Tr($r),exact:!0}),u.a.createElement(Sr,{path:"/admin/invite/next",component:Tr(eo),exact:!0}),u.a.createElement(Rt.a,{path:"/500",component:Bn}),u.a.createElement(Rt.a,{path:"*",component:qn}))},wo=function(){return u.a.createElement(Mt.a,null,u.a.createElement(Rt.a,{path:"/",component:Dr,exact:!0}),u.a.createElement(Pr,{path:"/login",component:ba}),u.a.createElement(Pr,{path:"/user/login",component:ba}),u.a.createElement(Pr,{path:"/user/logout",component:Wa}),u.a.createElement(Pr,{path:"/user/signup/next",component:Ka}),u.a.createElement(Pr,{path:"/user/signup",component:ba}),u.a.createElement(Pr,{exact:!0,path:"/password",component:an}),u.a.createElement(Pr,{exact:!0,path:"/user/forgotten/password",component:an}),u.a.createElement(Pr,{exact:!0,path:"/user/forgotten/password/next",component:on}),u.a.createElement(Pr,{exact:!0,path:"/user/password/reset",component:hn}),u.a.createElement(Pr,{exact:!0,path:"/user/password/reset/next",component:fn}),u.a.createElement(Rt.a,{path:"/user/verify",component:An,exact:!0}),u.a.createElement(Rt.a,{path:"/user/key/verify",component:_n,exact:!0}),u.a.createElement(Rt.a,{path:"/user/resend",component:wn,exact:!0}),u.a.createElement(Rt.a,{path:"/user/resend/next",component:kn}),u.a.createElement(Rt.a,{path:"/privacy-policy/",component:Fr}),u.a.createElement(kr,{path:"/user/proposals/:filter?",component:Rn}),u.a.createElement(Sr,{path:"/admin",component:Fa(pa),exact:!0}),u.a.createElement(Sr,{path:"/admin/users",component:za}),u.a.createElement(Rt.a,{path:"/user/:userId/:filter?",component:Ia(Or)}),u.a.createElement(kr,{path:"/proposals/new",component:Va(ya)}),u.a.createElement(kr,{path:"/proposals/:token/edit",component:_a(ya)}),u.a.createElement(Sr,{path:"/admin/censored",component:Aa(pa)}),u.a.createElement(Sr,{path:"/admin/unreviewed",component:Da(pa)}),u.a.createElement(Rt.a,{path:"/proposals/:token",component:D(tr),exact:!0}),u.a.createElement(Rt.a,{path:"/proposals/:token/comments/:commentid",component:D(tr)}),u.a.createElement(Rt.a,{path:"/500",component:Bn}),u.a.createElement(Rt.a,{path:"*",component:qn}))},jo=qa(function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.isCMS?u.a.createElement(Oo,null):u.a.createElement(wo,null)}}]),t}(c.Component)),Co=Object(p.b)(S.Vd({userPubkey:S.oe,loggedInAsEmail:S.Zc,keyMismatch:S.nb,apiError:S.l,loggedInAsUserId:S.pe,userCanExecuteActions:S.je,lastLoginTime:S.Xc,onboardViewed:S.qd,identityImportSuccess:S.Qb,isCMS:S.Mc,isModeFetched:S.Oc,apiInfo:S.n}),function(e){return Object(O.b)({onInit:P.Rb,onRequestMe:P.cb,keyMismatchAction:P.f,openModal:P.Ob,confirmWithModal:P.c,setOnboardAsViewed:P.Yb,onLoadDraftProposals:P.V,onLoadDraftInvoices:P.U},e)}),ko=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleOnClick=function(e){var t=a.state.clicks,n=a.props.disabled;a.setState({clicks:t+1}),!e.target.closest(".modal-content")&&t>0&&!n&&(e.target.closest(".right")||e.target.closest(".left")||a.props.onClick())},a.state={clicks:0,isEventListener:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.disabled||this.setState({isEventListener:!0},function(){return window.addEventListener("click",e.handleOnClick)})}},{key:"componentDidUpdate",value:function(){!0===this.state.isEventListener&&this.state.clicks>1&&window.removeEventListener("click",this.handleOnClick)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleOnClick)}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.ID;return u.a.createElement("div",{id:a},t)}}]),t}(u.a.Component),xo=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleKeyUp=function(e){var t=a.props,n=t.keyCode,r=t.disabled,o=t.onKeyPress;e.keyCode===n&&!r&&o&&o()},a.state={isEventListener:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.disabled||this.setState({isEventListener:!0},function(){return window.addEventListener("keyup",e.handleKeyUp)})}},{key:"componentDidUpdate",value:function(){!0===this.state.isEventListener&&window.removeEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keyup",this.handleKeyUp)}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.ID;return u.a.createElement("div",{id:a},t)}}]),t}(u.a.Component),So=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.onCancel,n=e.disableCloseOnEsc,r=e.disableCloseOnClick,o=e.children,i=e.style;return u.a.createElement("div",null,u.a.createElement(xo,{keyCode:27,onKeyPress:t||a,disabled:n}),u.a.createElement(ko,{onClick:t||a,disabled:r}),u.a.createElement("div",{className:"modal"},u.a.createElement("div",{className:"modal-overlay"},u.a.createElement("div",{className:"modal-container",style:i},o))))}}]),t}(u.a.Component),Po=function(e){var t=e.onClick,a=e.text;return u.a.createElement("button",{className:"btn",onClick:t},a)},No=function(e){var t=e.onClick,a=e.text,n=e.disabled;return u.a.createElement("button",{className:"btn ".concat(n?"not-active disabled":""),onClick:t,disabled:n},a)},Io=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.onCancel,n=e.onSubmit,r=e.submitDisabled,o=void 0!==r&&r,i=e.title,s=e.submitText,l=void 0===s?"OK":s,c=e.cancelText,m=void 0===c?"Cancel":c,d=e.children,p=e.style;return u.a.createElement("div",{className:"modal-content",style:Object(v.a)({minWidth:"803px"},p)},u.a.createElement("div",{className:"modal-content-header"},u.a.createElement("h2",{style:{fontSize:"18px",textTransform:"uppercase"}},i),u.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",flex:1}},u.a.createElement("span",{style:{fontSize:"18px",cursor:"pointer"},onClick:t},"\u2716"))),d,(a||n)&&u.a.createElement("div",{className:"modal-content-actions"},a&&u.a.createElement(Po,{onClick:a,text:m}),n&&u.a.createElement(No,{onClick:n,text:l,disabled:o})))}}]),t}(u.a.Component),Ao=a(50),Do=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).handleCancel=function(){a.props.me.callback&&a.props.me.callback(!1),a.props.closeModal()},a.handleConfirm=function(){a.props.me.callback&&a.props.me.callback(!0),a.props.closeModal()},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.me;return u.a.createElement(Io,{style:e.payload.style,title:e.payload.title||"Confirm Action",submitText:e.payload.submitText||"Yes",cancelText:e.payload.cancelText||"No",onCancel:this.handleCancel,onSubmit:this.handleConfirm,onClose:this.handleCancel},u.a.createElement("div",{style:e.payload.altStyle||{display:"flex",justifyContent:"center",padding:"10px 8px",minHeight:"80px",alignItems:"center"}},u.a.createElement("span",{style:{fontSize:"16px",textAlign:"center",maxWidth:"100%",wordBreak:"break-word"}},e.payload.message||"Do you confirm this action?")))}}]),t}(u.a.Component),Fo=Object(Ao.a)(Do),To=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleChange=function(e){a.setState({reason:e.target.value})},a.handleCancel=function(){a.props.me.callback&&a.props.me.callback({confirm:!1}),a.props.closeModal()},a.handleConfirm=function(){var e=(a.state.reason||"").trim();0!==e.length?(a.props.me.callback&&a.props.me.callback({confirm:!0,reason:e}),a.props.closeModal()):a.setState({error:"You must provide a reason for this action."})},a.state={error:null,reason:""},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.textAreaRef.focus()}},{key:"render",value:function(){var e=this,t=this.props.me;return u.a.createElement(Io,{title:t.payload.title||"Confirm Action",submitText:"Submit",cancelText:"Cancel",onCancel:this.handleCancel,onSubmit:this.handleConfirm},this.state.error&&u.a.createElement(_.a,{type:"error",title:"Error",body:this.state.error}),u.a.createElement("div",{style:{width:"90%"}},u.a.createElement("textarea",{className:"modal-reason",placeholder:t.payload.reasonPlaceholder||"Please provide a reason for this action",ref:function(t){return e.textAreaRef=t},value:this.state.reason,onChange:this.handleChange})))}}]),t}(u.a.Component),Mo=Object(Ao.a)(To),Ro=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc}),{redirectedFrom:P.Qb,resetRedirectFrom:P.Wb}),Vo=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).handleClose=function(){a.props.resetRedirectFrom(),a.props.closeModal()},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){!e.loggedInAsEmail&&this.props.loggedInAsEmail&&this.handleClose()}},{key:"componentDidMount",value:function(){var e=this.props.me.payload,t=e&&e.redirectAfterLogin||this.props.pathname;this.props.redirectedFrom(t)}},{key:"render",value:function(){var e=this.props,t=e.me.payload,a=e.closeModal,n=t.title||"You must be logged in to perform this action";return u.a.createElement(Io,{title:n,cancelText:"Close",onClose:this.handleClose},u.a.createElement("div",{style:{display:"flex",flexDirection:"column",padding:"20px 8px",minHeight:"360px",alignItems:"center"}},u.a.createElement("div",{style:{width:"320px"}},u.a.createElement("div",{style:{marginBottom:"34px"}},u.a.createElement("h1",{style:{margin:"0px"}},"Login"),"or"," ",u.a.createElement(ha,{onClick:a,href:"/user/signup",className:"login-required"},"create an account")),u.a.createElement(fa,Object.assign({style:{marginTop:"10px"}},this.props)))))}}]),t}(u.a.Component),Uo=Ro(Object(Ao.a)(Vo)),Lo=a(447),_o=a.n(Lo),qo=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=_o.a.imageSync("https://qr.doschain.com/?action=transfer&name=DOS&currency=DOS&address=".concat(this.props.addr),{type:"svg"});return u.a.createElement("div",{className:"receive-content-nest-qrimage",dangerouslySetInnerHTML:{__html:e}})}}]),t}(u.a.Component),Wo=a(170),Ho=(uo={},Object(ce.a)(uo,T.V,"Waiting for payment"),Object(ce.a)(uo,T.T,"Waiting for more confirmations"),uo),Yo=(mo={},Object(ce.a)(mo,T.V,"paywall-payment-status-waiting"),Object(ce.a)(mo,T.T,"paywall-payment-status-confirmations"),mo),zo=function(e){var t=e.userPaywallStatus,a=e.userPaywallConfirmations,n=Yo[t],r=Ho[t];return u.a.createElement("div",{className:"paywall-payment-status "+n},"Status: ",r,t===T.T&&u.a.createElement("span",null," (".concat(a,"/2)")))},Bo=function(e){var t=e.isTestnet,a=e.txId,n=t?"testnet":"mainnet";return e.isTxId?u.a.createElement("a",{href:"https://".concat(n,".doschain.org/tx/").concat(a),target:"_blank",rel:"noopener noreferrer"},a):u.a.createElement("span",null,a)},Ko={display:"flex",justifyContent:"center",width:"100%"},Zo=function(e){var t=e.paywallAddress,a=e.amount,n=e.paywallStatus,r=e.paywallConfirmations,o=e.paywallTxid,i=e.isTestnet,s=u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{className:"payment-panel__label"},"Send this exact amount of DOS: ",u.a.createElement("b",null,a)),u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("span",{className:"payment-panel__label"},"To this address: "),u.a.createElement("div",{className:"address-viewer"},u.a.createElement("span",{id:"paywall-address",className:"address-viewer_text"},t),u.a.createElement("div",{className:"address-viewer_menu"},u.a.createElement(Wo.a,{tipStyle:{fontSize:"11px",top:"20px",left:"20px",width:"100px"},text:"Copy address to clipboard",position:"bottom"},u.a.createElement("span",{className:"address-viewer_menu_option fa fa-copy",onClick:function(){return function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(t)}}))))),u.a.createElement("div",{style:Ko},u.a.createElement(qo,{addr:t}))),l=u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{className:"payment-panel__label"},"Transaction: ",u.a.createElement(Bo,{isTestnet:i,txId:o})));return u.a.createElement("div",{className:"payment-panel"},n===T.T?l:s,u.a.createElement("div",{style:Ko},u.a.createElement(zo,{userPaywallStatus:n,userPaywallConfirmations:r})))},Qo=Object(p.b)(S.Vd({isTestnet:S.Rc,isApiRequestingPayWithFaucet:S.vc,payWithFaucetTxId:S.sd,payWithFaucetError:S.rd}),function(e){return Object(O.b)({payWithFaucet:P.Pb,resetFaucet:P.Vb},e)}),Xo=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetFaucet()}},{key:"render",value:function(){var e=this.props,t=e.Component,a=Object(y.a)(e,["Component"]);return u.a.createElement(t,Object(v.a)({},a))}}]),t}(u.a.Component),Go=Qo((po=function(e){var t,a=e.payWithFaucetError,n=e.payWithFaucet,r=e.payWithFaucetTxId,o=e.isApiRequestingPayWithFaucet,i=e.isTestnet,s=e.paywallAddress,l=e.paywallAmount;return i?u.a.createElement("div",{className:"paywall-faucet"},u.a.createElement("div",{className:"paywall-faucet-testnet"},"Testnet"),u.a.createElement("p",null,"This DCC instance is running on Testnet, which means you can pay with the Demos faucet:"),r?null:u.a.createElement(ze.a,{className:"c-btn c-btn-primary float-right inverse",text:"Pay with Faucet",isLoading:o,onClick:function(){return n(s,l)}}),a?u.a.createElement(_.a,{type:"error",header:"Faucet error",body:a}):null,r?u.a.createElement(_.a,{type:"info",header:"Sent payment"},"Sent transaction"," ",u.a.createElement("a",{className:"paywall-payment-sent",href:(t=r,"".concat("https://testnet.doschain.org/explorer/tx","/").concat(t)),target:"_blank",rel:"noopener noreferrer"},r)," ","to the address; it may take a few minutes to be confirmed."):null):null},function(e){return u.a.createElement(Xo,Object(v.a)({},e,{Component:po}))})),Jo=function(e){var t=e.paywallAddress,a=e.paywallAmount,n=e.userPaywallStatus,r=e.userPaywallConfirmations,o=e.userPaywallTxid,i=e.isTestnet,s=n===T.T;return n===T.U?u.a.createElement(_.a,{type:"success",className:"account-page-message",header:"Payment received",body:u.a.createElement("p",null,"Thank you for your payment, your registration is complete!")}):u.a.createElement("div",{className:"paywall-wrapper",style:{padding:"10px"}},u.a.createElement("div",{className:"paywall-content"},s?u.a.createElement("p",{className:"paywall-paragraph"},"Your payment was detected and your registration will be complete once it reaches the required amount of confirmations."):u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{className:"paywall-paragraph"},"To participate on proposals and to submit your own, DCC requires you to pay a small registration fee. This helps keep DCC free of things like spam and vote manipulation."),u.a.createElement("p",{className:"paywall-paragraph highlight"},"To complete your registration please follow the instructions below:")),u.a.createElement(Zo,{paywallAddress:t,amount:a,paywallStatus:n,paywallConfirmations:r,paywallTxid:o,isTestnet:i}),s?null:u.a.createElement("div",{className:"paywall-payment-section"},u.a.createElement(Go,{paywallAddress:t,paywallAmount:a})),u.a.createElement("div",{style:{clear:"both"}})))},$o=Object(p.b)(S.Vd({loggedInAsEmail:S.Zc,paywallAddress:S.ud,paywallAmount:S.vd,paywallTxNotBefore:S.wd,userPaywallStatus:S.Fb,userPaywallConfirmations:S.Eb,userPaywallTxid:S.Gb,userAlreadyPaid:S.Ab,verificationToken:S.qe,isTestnet:S.Rc}),function(e){return Object(O.b)({onResetAppPaywallInfo:P.mb},e)})(function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={hasAttemptedSubmit:!1,isHidden:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.hasAttemptedSubmit,t=this.onSubmit,a=this.props,n=a.paywallAddress,r=a.paywallAmount;return n&&r&&u.a.createElement(Jo,Object(v.a)({},this.props,{hasAttemptedSubmit:e,onSubmit:t}))}}]),t}(u.a.Component)),ei=Object(Ao.a)(function(e){var t=e.closeModal;return u.a.createElement(Io,{title:"Complete your registration",onClose:t},u.a.createElement($o,null))}),ti=function(e){var t=e.proposalCreditPrice,a=e.proposalCreditPurchases,n=e.isTestnet,r=e.proposalPaywallPaymentTxid,o=e.proposalPaywallPaymentAmount,i=e.proposalPaywallPaymentConfirmations,s=a&&a.length>0;if(r){var l={numberPurchased:Math.round(1*o/(1e8*t)),txId:r,price:t,confirmations:i,confirming:!0,datePurchased:"just now"};a.push(l)}var c,m=a.slice(0).reverse();return u.a.createElement("div",{className:"proposal-credits-summary"},s?u.a.createElement("div",{className:"credits-purchase-menu"},u.a.createElement(go,{data:(c=a,c.filter(function(e){return!e.confirming}).map(function(e){return Object(v.a)({},e,{datePurchased:e.datePurchased?Object(Se.d)(e.datePurchased):"",price:"fee"===e.type?"":e.price,type:"fee"===e.type?"registration fee":"credits"})})),fields:["numberPurchased","price","txId","datePurchased","type"],filename:"payment_history"},u.a.createElement("button",{className:"inverse credits-purchase-menu__button"},"Export to CSV"))):null,a&&a.length?u.a.createElement("div",{className:"credit-purchase-table"},u.a.createElement("div",{className:"credit-purchase-header"},u.a.createElement("div",{className:"credit-purchase-row"},u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-number"},"Amount"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-price"},"Dos"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-tx"},"Transaction"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-status"},"Status"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-date"},"Date"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-type"},"Type"),u.a.createElement("div",{className:"clear"}))),u.a.createElement("div",{className:"credit-purchase-body"},m.map(function(e,t){return u.a.createElement("div",{className:"credit-purchase-row",key:t},u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-number"},e.numberPurchased),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-price"},"N/A"===e.numberPurchased?e.price:(e.numberPurchased*e.price).toFixed(2)+" DOS"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-tx"},u.a.createElement(Bo,{isTestnet:n,txId:e.txId,isTxId:"created_by_dbutil"!==e.txId})),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-status"},e.confirming?u.a.createElement("div",{className:"user-proposal-credits-cell",style:{color:"#ff8100"}},u.a.createElement("div",null,"waiting confirmations: "),"(",e.confirmations," of ",T.h,")"):u.a.createElement("div",{style:{color:"green"}},"confirmed")),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-date-text"},e.datePurchased?"just now"===e.datePurchased?"just now":Object(Se.d)(e.datePurchased):"-"),u.a.createElement("div",{className:"credit-purchase-cell credit-purchase-type"},"fee"===e.type?"registration fee":"credits"),u.a.createElement("div",{className:"clear"}))}))):null)},ai=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.onPurchaseProposalCredits()}},{key:"render",value:function(){var e=this.props,t=e.proposalCreditPrice,a=e.proposalCredits,n=e.isApiRequestingUserProposalCredits,r=e.isTestnet,o=e.proposalPaywallPaymentTxid,i=Object(y.a)(e,["proposalCreditPrice","proposalCredits","isApiRequestingUserProposalCredits","isTestnet","proposalPaywallPaymentTxid"]),s=this.props.proposalCreditPurchases.unshift({numberPurchased:"N/A",price:"click on the transaction link for more information",confirming:!1,type:"fee",txId:this.props.paywallTxid});return!n&&u.a.createElement("div",{className:"proposal-paywall-section"},u.a.createElement(ti,Object.assign({proposalCreditPrice:t,proposalCredits:a,proposalCreditPurchases:s,isTestnet:r},Object(v.a)({},i,{proposalPaywallPaymentTxid:o}))))}}]),t}(u.a.Component),ni=a(172),ri=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onUpdateCreditsToPurchase=function(e){var t=parseInt(e.target.value,10);t<1||a.setState({numCreditsToPurchase:t})},a.state={numCreditsToPurchase:1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.numCreditsToPurchase,t=this.onUpdateCreditsToPurchase;return u.a.createElement(ai,Object(v.a)({},this.props,{numCreditsToPurchase:e,onUpdateCreditsToPurchase:t}))}}]),t}(c.Component),oi=Object(ni.a)(ri),ii=Object(Ao.a)(Object(ni.a)(function(e){var t=e.closeAllModals;return!e.isApiRequestingUserProposalCredits&&u.a.createElement(Io,{title:"Account History",onClose:t},u.a.createElement(oi,null))})),si=a(89),li=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).openCreditsHistoryAfterApi=a.openCreditsHistoryAfterApi.bind(Object(si.a)(a)),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.onPurchaseProposalCredits(),this.props.onFetchProposalPaywallPayment()}},{key:"openCreditsHistoryAfterApi",value:function(){this.props.onUserProposalCredits(),this.props.openModal(Bt.e)}},{key:"render",value:function(){var e=this.props,t=e.closeModal,a=e.openModal,n=e.proposalCredits,r=e.isApiRequestingUserProposalCredits;return u.a.createElement(Io,{title:"Manage Credits",onClose:t},u.a.createElement("div",{className:"modal-content__wrapper"},u.a.createElement("p",null,"Proposal credits are needed to submit proposals, and each proposal requires 1 credit."),u.a.createElement("span",{style:{fontSize:"18px",padding:"20px 8px"}},"Proposal Credits: ",u.a.createElement("b",null,n)),u.a.createElement("div",{style:{display:"flex",width:"100%",justifyContent:"center"}},u.a.createElement("button",{onClick:function(){return a(Bt.k)}},"Purchase Credits"),u.a.createElement(ze.a,{onClick:this.openCreditsHistoryAfterApi,text:"Account History",isLoading:r,style:{overflow:"hidden"}}))))}}]),t}(u.a.Component),ci=Object(Ao.a)(Object(ni.a)(li)),ui=0,mi=1,di=function(e){var t=e.onUpdateCreditsToPurchase,a=e.numCreditsToPurchase,n=e.proposalCreditPrice;return u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{style:{fontSize:"16px"}},"How many credits do you want to buy?"),u.a.createElement("span",null,"*each proposal credit costs ",n,"dos"),u.a.createElement("input",{className:"proposal-credits-input",type:"number",value:a,onChange:t}))},pi=function(e){var t=e.address,a=e.amount,n=e.numCreditsToPurchase,r=e.paymentStatus,o=e.confirmations,i=e.proposalPaywallPaymentTxid,s=e.displayFaucet,l=e.isTestnet,c=r===T.T;return u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{style:{alignSelft:"left",fontSize:"16px",width:"100%",marginBottom:"20px"}},c?"Your payment has been detected. You proposal credits will be updated once it reaches the required number of confirmations.":"To complete the purchase of ".concat(n," credit(s), please follow the instructions below:")),u.a.createElement(Zo,{amount:a,paywallAddress:t,paywallStatus:r,paywallTxid:i,paywallConfirmations:o,isTestnet:l}),s?u.a.createElement(Go,{paywallAddress:t,paywallAmount:a}):null)},hi=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onUpdateCreditsToPurchase=function(e){var t=parseInt(e.target.value,10);t<1||a.setState({numCreditsToPurchase:t})},a.goToStep=function(e){return a.setState({step:e})};var n=e.proposalPaywallPaymentTxid;return a.state={step:n?mi:ui,numCreditsToPurchase:1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.pollyingCreditsPayment,r=a.proposalPaywallAddress,o=a.proposalPaymentReceived,i=t.step!==this.state.step&&this.state.step===mi,s=t.step!==this.state.step&&this.state.step===ui;i&&!n&&r&&this.props.toggleCreditsPaymentPolling(!0),s&&o&&this.props.toggleProposalPaymentReceived(!1)}},{key:"componentDidMount",value:function(){this.props.proposalPaymentReceived&&this.props.toggleProposalPaymentReceived(!1),this.props.proposalPaywallAddress&&!this.props.pollyingCreditsPayment&&this.props.toggleCreditsPaymentPolling(!0)}},{key:"render",value:function(){var e=this,t=this.state,a=t.step,n=t.numCreditsToPurchase,r=this.props,o=r.proposalCreditPrice,i=r.proposalPaywallAddress,s=r.proposalPaywallPaymentTxid,l=r.proposalPaywallPaymentConfirmations,c=r.isTestnet,m=r.proposalPaymentReceived,d=a===ui,p=a===mi,h=s?T.T:T.V,f=Object(Se.s)(o,n),b=s;return u.a.createElement("div",{className:"modal-content__wrapper purchase-credits"},u.a.createElement("div",{className:"purchase-credits__content"},d?u.a.createElement(di,{onUpdateCreditsToPurchase:this.onUpdateCreditsToPurchase,numCreditsToPurchase:n,proposalCreditPrice:o}):m?u.a.createElement(_.a,{type:"success",className:"account-page-message",header:"Payment received",body:u.a.createElement("p",null,"Thank you for your payment, your credits were updated!")}):u.a.createElement(pi,{amount:f,address:i,numCreditsToPurchase:n,paymentStatus:h,confirmations:l,displayFaucet:!b,proposalPaywallPaymentTxid:s,isTestnet:c})),u.a.createElement("div",{className:"purchase-credits__buttons"},p&&!m?u.a.createElement("button",{className:"left ".concat(b?"disabled":""),disabled:b,onClick:function(){return e.goToStep(ui)}},"Previous"):null,d?u.a.createElement("button",{className:"right",disabled:n<1,onClick:function(){return e.goToStep(mi)}},"Next"):null))}}]),t}(u.a.Component),fi=Object(ni.a)(hi),bi=Object(Ao.a)(function(e){var t=e.closeAllModals;return u.a.createElement(Io,{title:"Purchase Credits",onClose:t},u.a.createElement(fi,null))}),vi=Object(Ke.a)({form:"form/change-username"})(function(e){var t=e.error,a=e.isApiRequestingChangeUsername,n=e.policy,r=e.onChangeUsername,o=e.handleSubmit;return u.a.createElement("form",{className:"change-username-form",onSubmit:o(r)},t&&u.a.createElement(_.a,{type:"error",header:"Cannot change username",body:t}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"username"},"New Username:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"newUsername",name:"newUsername",component:"input",type:"username",placeholder:Object(Se.p)(n,"New Username"),tabIndex:3})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"password"},"Current Password:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"password",name:"password",component:"input",type:"password",placeholder:"Current Password",tabIndex:3})),u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement(ze.a,{className:"c-btn c-btn-primary c-pull-left",tabIndex:3,type:"submit",text:"Change Username",isLoading:a})))}),yi=Object(p.b)(S.Vd({policy:S.yd,isApiRequestingChangeUsername:Object(x.f)(S.kc,S.cc),changeUsernameResponse:S.g}),{onChangeUsername:P.tb,onFetchData:P.Q}),gi=function(e,t){if(!K(e.password)||!K(e.newUsername))throw new q.a({_error:"All fields are required"});if(!z(e.newUsername,t.minusernamelength,t.maxusernamelength))throw new q.a({_error:"Your username must be between "+t.minusernamelength+" and "+t.maxusernamelength+" characters."})},Ei=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.policy||this.props.onFetchData()}},{key:"onChangeUsername",value:function(e){var t=this.props.policy;return e=Object(v.a)({},e,{newUsername:e.newUsername&&e.newUsername.trim()}),gi(e,t),this.props.onChangeUsername(e).catch(function(e){throw new q.a({_error:e.message})})}},{key:"render",value:function(){return u.a.createElement("div",null,this.props.changeUsernameResponse&&u.a.createElement(_.a,{type:"success",header:"Username changed",body:"Your username was successfully changed."}),u.a.createElement(vi,Object(v.a)({},this.props,{onChangeUsername:this.onChangeUsername})))}}]),t}(c.Component);Object(Ue.a)(Ei);var Oi=yi(Ei),wi=Object(Ao.a)(function(e){var t=e.closeAllModals;return u.a.createElement(Io,{title:"Change Username",onClose:t},u.a.createElement(Oi,null))}),ji=Object(Ke.a)({form:"form/change-password"})(function(e){var t=e.error,a=e.isApiRequestingChangePassword,n=e.policy,r=e.onChangePassword,o=e.handleSubmit;return u.a.createElement("form",{className:"change-password-form",onSubmit:o(r)},t&&u.a.createElement(_.a,{type:"error",header:"Cannot change password",body:t}),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"existingPassword"},"Current Password:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"existingPassword",name:"existingPassword",component:"input",type:"password",placeholder:"Current Password",tabIndex:3})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"newPassword"},"New Password:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"newPassword",name:"newPassword",component:"input",type:"password",placeholder:Object(Se.m)(n,"New Password"),tabIndex:3})),u.a.createElement("div",{className:"c-form-group"},u.a.createElement("label",{className:"screenreader-only",htmlFor:"newPasswordVerify"},"Verify Password:"),u.a.createElement(Ye.a,{className:"c-form-control",id:"newPasswordVerify",name:"newPasswordVerify",component:"input",type:"password",placeholder:"Verify Password",tabIndex:3})),u.a.createElement("div",{className:"c-clearfix c-submit-group"},u.a.createElement(ze.a,{className:"c-btn c-btn-primary c-pull-left",tabIndex:3,type:"submit",text:"Change Password",isLoading:a})))}),Ci=Object(p.b)(S.Vd({policy:S.yd,isApiRequestingChangePassword:Object(x.f)(S.kc,S.bc),changePasswordResponse:S.f}),{onChangePassword:P.sb,onFetchData:P.Q}),ki=function(e,t){if(!K(e.existingPassword)||!K(e.newPassword)||!K(e.newPasswordVerify))throw new q.a({_error:"All fields are required"});if(!B(e.newPassword,e.newPasswordVerify))throw new q.a({_error:"Passwords do not match"});if(!z(e.newPassword,t.minpasswordlength))throw new q.a({_error:"Your new password must be at least "+t.minpasswordlength+" characters."})},xi=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.policy||this.props.onFetchData()}},{key:"onChangePassword",value:function(e){var t=this.props.policy;return ki(e,t),this.props.onChangePassword(e).catch(function(e){throw new q.a({_error:e.message})})}},{key:"render",value:function(){return u.a.createElement("div",null,this.props.changePasswordResponse&&u.a.createElement(_.a,{type:"success",header:"Password changed",body:"Your password was successfully changed."}),u.a.createElement(ji,Object(v.a)({},this.props,{onChangePassword:this.onChangePassword})))}}]),t}(c.Component);Object(Ue.a)(xi);var Si,Pi=Ci(xi),Ni=Object(Ao.a)(function(e){var t=e.closeAllModals;return u.a.createElement(Io,{title:"Change Password",onClose:t},u.a.createElement(Pi,null))}),Ii=Object(p.b)(S.Vd({proposalVoteResults:S.w,isLoading:S.xc,error:S.x}),function(e){return Object(O.b)({onFetchProposalVoteResults:P.E},e)}),Ai=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleSubmit=function(e){var t=e.token,n=a.props.proposalVoteResults&&a.props.proposalVoteResults.castvotes[t];return n?a.setState({result:t,option:"2"===n.votebit?"Yes":"No",error:!1}):a.setState({error:!0})},a.renderField=function(e){return u.a.createElement("div",null,u.a.createElement("input",Object.assign({},e.input,{name:"token",style:{width:"550px"},type:"text",placeholder:"search vote by ticket token"})),u.a.createElement("input",{type:"submit",value:""}))},a.state={result:null,option:"",error:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.onFetchProposalVoteResults&&this.props.onFetchProposalVoteResults(this.props.me.payload.id)}},{key:"handleCancel",value:function(){this.props.closeModal()}},{key:"render",value:function(){var e=this.props,t=e.error,a=e.isLoading,n=e.handleSubmit,r=!a&&this.state.result&&!this.state.error;return u.a.createElement(Io,{title:"Search votes - "+this.props.me.payload.title,onClose:this.props.closeModal},u.a.createElement("div",{className:"content",role:"main"},u.a.createElement("form",{className:"search-form",style:{display:"flex",justifyContent:"center",width:"100%"},onSubmit:n(this.handleSubmit)},a?u.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin right-margin-5",style:{fontSize:"26px"}}):u.a.createElement("div",null,u.a.createElement(Ye.a,{autoFocus:!0,name:"token",component:this.renderField,placeholder:"search by ticket token"}))),t&&u.a.createElement(_.a,{type:"error",header:"Cannot search for vote",body:t}),r&&u.a.createElement("div",{className:"search-results votes"},u.a.createElement("table",null,u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Ticket"),u.a.createElement("th",null,"Vote Option"))),u.a.createElement("tbody",null,u.a.createElement("tr",null,u.a.createElement("td",null,u.a.createElement(Bo,{isTestnet:this.props.isTestnet,txId:this.state.result})),u.a.createElement("td",null,this.state.option))))),this.state.error&&u.a.createElement("div",{className:"search-results votes"},u.a.createElement("h3",null,"No matches found with that ticket"))))}}]),t}(u.a.Component),Di=Object(Ke.a)({form:"form/vote-search"})(Ii(Object(Ao.a)(Ai))),Fi=function(e){var t=e.options,a=e.value,n=e.onChange,r=e.style,o=void 0===r?{}:r,i=function(e,n){return(0===e?"first ":"")+(e===t.length-1?"last ":"")+(n===a?"selected ":"")};return u.a.createElement("div",{className:"f-radio",style:o},t.map(function(e,t){return u.a.createElement("label",{className:i(t,e.value),key:"op-".concat(t),onClick:function(){return n(e.value)}},u.a.createElement("span",null,e.text))}))},Ti=[2016,2880,4032],Mi=function(e){var t=e?2:5;return Ti.map(function(e){return{value:e,text:"".concat(Math.round(e*t/60/24)," days")}})},Ri=20,Vi=100,Ui=60,Li=100,_i=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).onChangeDuration=function(e){return a.setState({duration:e})},a.onChangeQuorumPercentage=function(e){var t=parseInt(e.target.value,10);t>Vi||t<0||a.setState({quorumPercentage:t,quorumError:t<Ri||!t?"Quorum percentage must be a value between ".concat(Ri," and ").concat(Vi):""})},a.onChangePassPercentage=function(e){var t=parseInt(e.target.value,10);t>Li||t<0||a.setState({passPercentage:t,passError:t<Ui||!t?"Pass percentage must be a value between ".concat(Ui," and ").concat(Li):""})},a.handleSubmit=function(){var e=a.state,t=e.quorumPercentage,n=e.passPercentage,r=e.duration;a.props.me.callback(r,t,n),a.props.closeModal()},a.state={duration:Ti[0],quorumPercentage:20,passPercentage:60,quorumError:"",passError:""},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.closeModal,a=e.isTestnet,n=this.state,r=n.duration,o=n.quorumPercentage,i=n.passPercentage,s=n.quorumError,l=n.passError,c={display:"flex",width:"220px",justifyContent:"space-between",alignItems:"center",marginTop:"10px"},m=o>=Ri&&o<=Vi&&(i>=Ui&&i<=Li);return u.a.createElement(Io,{title:"Start Vote",onClose:t,onSubmit:this.handleSubmit,submitDisabled:!m,submitText:"Start Vote"},u.a.createElement("form",{style:{padding:"10px",display:"flex",flexDirection:"column",alignItems:"center"}},u.a.createElement("label",null,"Duration:"),u.a.createElement(Fi,{style:{marginTop:"5px"},options:Mi(a),value:r,onChange:this.onChangeDuration}),u.a.createElement("div",{style:c},u.a.createElement("label",null,"Quorum percentage:"),u.a.createElement("input",{className:"proposal-credits-input",type:"number",value:o,onChange:this.onChangeQuorumPercentage})),s?u.a.createElement("span",{className:"input-error"},s):null,u.a.createElement("div",{style:c},u.a.createElement("label",null,"Pass percentage:"),u.a.createElement("input",{className:"proposal-credits-input",type:"number",value:i,onChange:this.onChangePassPercentage})),l?u.a.createElement("span",{className:"input-error"},l):null))}}]),t}(u.a.Component),qi=Object(Ao.a)(_i),Wi=a(105),Hi=a.n(Wi),Yi=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).auditIdentity=function(e){var t=a.props.userPubkey;if(e.publicKey!==t)throw new Error(T.nb);if(!Vn.i(e))throw new Error(T.m)},a.onSelectFiles=function(e){var t=e.base64,n=a.props,r=n.onIdentityImported,o=n.closeModal;try{var i=Object(Se.l)(t);if(!i||!i.publicKey||!i.secretKey)throw new Error(T.l);a.auditIdentity(i),Vn.d(a.props.loggedInAsEmail,i).then(function(){r("Successfully imported identity")&&o()}).catch(function(e){console.error(e.stack),r(null,T.A)})}catch(s){console.error(s.stack),r(null,s)}},a.state={showErrorMessage:!1},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.identityImportError!==e.identityImportError&&this.setState({showErrorMessage:!0})}},{key:"componentDidMount",value:function(){var e=this;this.fetchKeys().then(function(t){e.unmounting||e.setState({keyData:t})})}},{key:"render",value:function(){return console.log(this.state.showErrorMessage&&this.props.identityImportError),u.a.createElement("div",{style:{width:"100%",padding:"1em",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},this.props.identityImportError&&this.state.showErrorMessage&&u.a.createElement(_.a,{type:"error",header:"Error importing identity",body:this.props.identityImportError}),u.a.createElement(Hi.a,{base64:!0,handleFiles:this.onSelectFiles.bind(this),multipleFiles:!1,fileTypes:"json"},u.a.createElement("button",{style:{marginRight:"0"}},"Upload JSON Identity File")))}},{key:"fetchKeys",value:function(){return Vn.c(this.props.loggedInAsEmail).then(function(e){return JSON.stringify(e,null,2)})}}]),t}(u.a.Component),zi=Ia(Yi),Bi="The provided public key doesn't match the key stored in the server.",Ki="The provided secret key does not meet the length requirement.",Zi="The provided key pair is not valid.",Qi="Sorry, something went wrong while importing the identity file, please try again. If the error persists, contact the DCC support.",Xi=function(e){return e&&e.toLowerCase()},Gi=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).checkFormInput=function(e){return!e},a.handleKeys=function(e){var t=a.props,n=t.onIdentityImported,r=t.closeModal;e=Object(v.a)({},e,{publicKey:e.publicKey&&e.publicKey.trim(),secretKey:e.secretKey&&e.secretKey.trim()});try{a.auditIdentity(e),Vn.d(a.props.loggedInAsEmail,e).then(function(){n("Successfully imported identity")&&r()}).catch(function(e){console.error(e.stack),n(null,Qi)})}catch(o){console.error(o.stack),n(null,o)}},a.auditIdentity=function(e){var t=a.props.userPubkey;if(e.publicKey!==t)throw new Error(Bi);if(e.secretKey.length<128)throw new Error(Ki);if(!Vn.i(e))throw new Error(Zi)},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement("form",{className:"import-identity-form",onSubmit:this.props.handleSubmit(this.handleKeys)},u.a.createElement("div",{style:{width:"45em"},className:"c-form-group"},u.a.createElement(Ye.a,{className:"c-form-control",id:"publicKey",name:"publicKey",placeholder:"Public Key",component:"input",validate:this.checkFormInput,normalize:Xi,type:"text"})),u.a.createElement("div",{style:{width:"45em"},className:"c-form-group"},u.a.createElement(Ye.a,{className:"c-form-control",id:"secretKey",name:"secretKey",placeholder:"Private Key",component:"input",validate:this.checkFormInput,normalize:Xi,type:"text"}),u.a.createElement("button",{type:"submit",disabled:this.props.submitting||this.props.pristine||this.props.invalid,style:{margin:"2em 0 2em 0"},className:"c-btn c-btn-primary c-pull-right"},"Submit Identity"),u.a.createElement("button",{type:"button",disabled:this.props.submitting||this.props.pristine,style:{margin:"2em 0 2em 0",background:"#bf4153"},onClick:this.props.reset,className:"c-btn c-btn-primary c-pull-left"},"Clear Values")))}}]),t}(u.a.Component),Ji=Ia(Object(Ke.a)({form:"form/import-identity"})(Gi)),$i=Object(Ao.a)(Ia(function(e){var t=e.closeAllModals;return u.a.createElement(Io,{title:"Import Identity",onClose:t},u.a.createElement("div",{style:{width:"100%",padding:"1em",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},u.a.createElement(zi,null),u.a.createElement("h2",{style:{fontSize:"1.25em",width:"100%",textAlign:"center",padding:"1em"}},"Or Paste in Your Own"),u.a.createElement(Ji,null)))})),es=a(39),ts=a.n(es),as=a(40),ns=a(549),rs=a(548),os=function(e){var t=e.userName,a=e.title,n=e.version,r=e.lastEdition,o=e.onClose,i=e.loading,s=e.enableFilesDiff,l=e.filesDiff,c=e.onToggleFilesDiff,m=e.isNewFile;return u.a.createElement("div",{className:"diff-header"},i?u.a.createElement("span",null,"Fetching proposal..."):u.a.createElement(u.a.Fragment,null,u.a.createElement("span",null,t&&r&&n&&a?"".concat(t," ").concat(r," - version ").concat(n," - ").concat(a):""),u.a.createElement("div",null,s?u.a.createElement("span",{className:"linkish",style:{marginRight:"10px"},onClick:c,href:""},l?"Text Changes":"Attachments changes",m&&u.a.createElement("span",{className:"new-file-indicator"})):null,u.a.createElement("span",{onClick:o,style:{cursor:"pointer"}},"\u2716"))))},is=function(e){var t=e.body,a=e.proposal,n=e.onToggleTextDiffPreview,r=e.preview,o=e.version;return u.a.createElement("div",null,u.a.createElement("div",{className:"diff-text-preview-toggle",onClick:n},u.a.createElement("div",{className:r?"":"diff-active-toggle",onClick:r?null:n},"View version ",o),u.a.createElement("div",{className:r?"diff-active-toggle":"",onClick:r?n:null},"Text changes")),u.a.createElement("div",{style:{padding:"16px"}},r?u.a.createElement("div",{className:"md"},t):u.a.createElement(rs.a,{body:a})))},ss=function(e){return Object(v.a)({},e,{added:!0})},ls=function(e){return Object(v.a)({},e,{removed:!0})},cs=function(e){return function(t){return!e.some(function(e){return e.name===t.name&&e.payload===t.payload})}},us=function(e){return function(t){return!cs(e)(t)}},ms={zIndex:9999,minWidth:"800px",margin:"0px 1px"},ds=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={filesDiff:!1,textDiffPreview:!1},a.handleToggleFilesDiff=function(e){e.preventDefault(),a.setState(function(e){return{filesDiff:!e.filesDiff}})},a.handleToggleTextDiffPreview=function(e){e.preventDefault(),a.setState(function(e){return{textDiffPreview:!e.textDiffPreview}})},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.newProposal,a=e.oldProposal,n=e.newFiles,r=e.oldFiles,o=e.title,i=e.version,s=e.userName,l=e.lastEdition,c=e.onClose,m=e.loading,d=e.error,p=this.state,h=p.filesDiff,f=p.textDiffPreview,b=function(e,t,a){return[].concat(Object(xe.a)(e.filter(a(t)).map(ss)),Object(xe.a)(t.filter(a(e)).map(ls)),Object(xe.a)(e.filter(us(t))))}(n,r,cs),v=function(e){return e.length>0&&e.filter(function(e){return e.added||e.removed}).length>0}(b);return u.a.createElement("div",{className:"modal-content",style:ms},u.a.createElement("div",{className:"diff-wrapper"},u.a.createElement(os,{title:o,version:i,loading:m,userName:s,lastEdition:l,onClose:c,filesDiff:h,isNewFile:v,onToggleFilesDiff:this.handleToggleFilesDiff,enableFilesDiff:r.length||n.length}),d?u.a.createElement(_.a,{body:d,type:"error"}):h?u.a.createElement(Zt.a,{files:b,readOnly:!0}):u.a.createElement(is,{body:Object(ns.c)(a,t),proposal:t,onToggleTextDiffPreview:this.handleToggleTextDiffPreview,preview:f,version:i})))}}]),t}(u.a.Component),ps=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={proposal:null,prevProposal:null,error:null,loading:!0},a.fetchProposalsVersions=function(){var e=Object(as.a)(ts.a.mark(function e(t,n){var r,o,i,s;return ts.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=null,e.next=4,Object(F.I)(t,n);case 4:if(o=e.sent,i=o.proposal,!(n>1)){e.next=11;break}return e.next=9,Object(F.I)(t,parseInt(n,10)-1);case 9:s=e.sent,r=s.proposal;case 11:a.setState({proposal:i,prevProposal:r,loading:!1}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),a.setState({error:e.t0,loading:!1});case 17:case"end":return e.stop()}},e,null,[[0,14]])}));return function(t,a){return e.apply(this,arguments)}}(),a.getProposalText=function(e){return e?Object(Se.o)(e.files.filter(function(e){return"index.md"===e.name})[0]):""},a.getProposalFilesWithourIndexMd=function(e){return e?e.files.filter(function(e){return"index.md"!==e.name}):[]},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.me.payload,t=e.token,a=e.version;this.fetchProposalsVersions(t,a)}},{key:"render",value:function(){var e=this.state,t=e.proposal,a=e.prevProposal,n=e.loading,r=e.error,o=this.props.closeModal,i=this.getProposalText(a),s=this.getProposalText(t),l=this.getProposalFilesWithourIndexMd(a),c=this.getProposalFilesWithourIndexMd(t);return u.a.createElement(ds,{userName:t?t.username:"",lastEdition:t?Object(Se.d)(t.timestamp):"",onClose:o,oldProposal:i,newProposal:s,oldFiles:l,newFiles:c,title:t?t.name:"",version:t?t.version:"",loading:n,error:r})}}]),t}(u.a.Component),hs=Object(Ao.a)(D(ps)),fs=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).openInNewTab=function(e){window.open(e,"_blank").focus()},a.handleCancel=function(){a.props.me.callback&&a.props.me.callback(!1),a.props.closeModal()},a.handleConfirm=function(){a.props.me.callback&&a.props.me.callback(!0),a.props.closeModal()&&a.openInNewTab(T.W)},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement(Io,{title:"Welcome to DCC!",submitText:"Yes, show me more",cancelText:"Maybe later",onCancel:this.handleCancel,onSubmit:this.handleConfirm},u.a.createElement("div",{style:{display:"grid",padding:"1em",fontSize:"1.15em"}},u.a.createElement("strong",{style:{textAlign:"center",fontSize:"1.05em",marginBottom:"1em",fontWeight:"1.2em"}},"Are you new to DCC? Would you like to read more on how all of this works?"),u.a.createElement("span",{style:{textAlign:"center",marginTop:".5em",fontStyle:"italic"}},"The following information can be reviewed by clicking 'Learn More about Politiea' in the sidebar.")))}}]),t}(u.a.Component),bs=Object(Ao.a)(fs),vs=(Si={},Object(ce.a)(Si,Bt.c,function(e){var t=e.modalData;return u.a.createElement(Fo,{me:t})}),Object(ce.a)(Si,Bt.d,function(e){var t=e.modalData;return u.a.createElement(Mo,{me:t})}),Object(ce.a)(Si,Bt.g,function(e){var t=e.location,a=e.modalData;return u.a.createElement(Uo,{me:a,pathname:t.pathname})}),Object(ce.a)(Si,Bt.i,function(){return u.a.createElement(ei,null)}),Object(ce.a)(Si,Bt.e,function(){return u.a.createElement(ii,null)}),Object(ce.a)(Si,Bt.h,function(){return u.a.createElement(ci,null)}),Object(ce.a)(Si,Bt.k,function(){return u.a.createElement(bi,null)}),Object(ce.a)(Si,Bt.b,function(){return u.a.createElement(wi,null)}),Object(ce.a)(Si,Bt.a,function(){return u.a.createElement(Ni,null)}),Object(ce.a)(Si,Bt.m,function(e){var t=e.modalData;return u.a.createElement(qi,{me:t})}),Object(ce.a)(Si,Bt.l,function(e){var t=e.modalData;return u.a.createElement(Di,{me:t})}),Object(ce.a)(Si,Bt.f,function(){return u.a.createElement($i,null)}),Object(ce.a)(Si,Bt.j,function(e){var t=e.modalData;return u.a.createElement(hs,{me:t})}),Object(ce.a)(Si,Bt.n,function(e){var t=e.modalData;return u.a.createElement(bs,{me:t})}),Si),ys=Object(m.a)(function(e){var t=e.modalData,a=e.location,n=vs[t.type];return n?n({modalData:t,location:a}):console.log("modal not mapped")}),gs=Object(p.b)(S.Vd({openedModals:S.Ob}),function(e){return Object(O.b)({closeModal:P.b,closeAllModals:P.a},e)}),Es=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={modals:[]},a.renderModalContent=function(e){return u.a.createElement(So,{key:e.type,onClose:a.props.closeAllModals,disableCloseOnClick:e.options.disableCloseOnClick,disableCloseOnEsc:e.options.disableCloseOnEsc},u.a.createElement(ys,{modalData:e}))},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.openedModals,n=t.location,r=t.closeAllModals,o=a.find(function(e){return e.type===Bt.n}),i=this.state.modals,s=!1;if(i.length>a.length)s=!0,i.pop();else if(i.length<a.length){s=!0;var l=a[a.length-1];i.push(this.renderModalContent(l))}s&&this.setState({modals:i},function(){0!==i.length?document.querySelector("body").style.overflowY="hidden":document.querySelector("body").style.overflowY="scroll"}),n.pathname===e.location.pathname||o||r()}},{key:"render",value:function(){return this.state.modals}}]),t}(u.a.Component),Os=Object(m.a)(gs(Es)),ws=a(61);a(1255),a(1256),a(1257),a(1258);a.d(t,"default",function(){return Ps});var js=Object(b.a)();js.subscribe(f()(function(){var e=js.getState();Object(Ta.d)(e),Object(Ta.c)(e),Object(Lt.b)(e)},1e3));var Cs=function(e){function t(e){var a;return Object(r.a)(this,t),a=Object(i.a)(this,Object(s.a)(t).call(this)),e.onInit(),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidUpdate",value:function(e){var t=0===this.props.lastLoginTime,a=!e.apiError&&this.props.apiError;if(!e.loggedInAsEmail&&this.props.loggedInAsEmail&&(this.props.isCMS?this.props.onLoadDraftInvoices(this.props.loggedInAsEmail):this.props.onLoadDraftProposals(this.props.loggedInAsEmail)),e.userPubkey&&this.props.userPubkey&&Object(Se.x)(this.props.loggedInAsEmail,this.props.userPubkey,this.props.keyMismatchAction),!e.onboardViewed&&t&&!this.props.isCMS){var n=this.props,r=n.setOnboardAsViewed,o=n.openModal;r(),o(Bt.n)}!e.apiInfoResponse&&this.props.apiInfoResponse&&this.props.onRequestMe(),a&&(this.props.apiError.internalError?this.props.history.push("/500"):console.error("ERROR:",this.props.apiError.message))}},{key:"componentDidMount",value:function(){var e;this.props.loggedInAsEmail&&Object(Se.x)(this.props.loggedInAsEmail,this.props.userPubkey,this.props.keyMismatchAction),this.storageListener=(e=js,function(t){return e.dispatch(Object(Vt.q)(t))}),window.addEventListener("storage",this.storageListener),document.title=this.context.title}},{key:"componentWillUnmount",value:function(){window.removeEventListener("storage",this.storageListener)}},{key:"render",value:function(){return this.props.isModeFetched&&u.a.createElement("div",{className:"appWrapper"},u.a.createElement(Os,null),this.props.children)}}]),t}(c.Component);Cs.contextType=ws.a;var ks=Object(m.a)(Co(Cs)),xs=function(){return Object(ws.c)().isStaging&&u.a.createElement("div",{className:"staging-alert"},"This is the dcc staging environment. DO NOT USE, YOU WILL LOSE YOUR DEMOS.")},Ss=Object(m.a)(Co(function(e){var t=e.location,a=e.loggedInAsEmail,n=e.keyMismatch,r=e.history,o=e.loggedInAsUserId,i=e.identityImportSuccess;return a&&n&&!i&&t.pathname!=="/user/".concat(o)?u.a.createElement(ja,{className:"action-needed-alert"},"You cannot currently submit proposals or comments, please visit your"," ",u.a.createElement("span",{className:"linkish",style:{cursor:"pointer"},onClick:function(){return r.push("/user/".concat(o))}},"account page")," ","to correct this problem."):null})),Ps=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement(p.a,{store:js},u.a.createElement(ws.b,null,u.a.createElement(d.a,null,u.a.createElement(ks,null,u.a.createElement(xs,null),u.a.createElement(Pa,null),u.a.createElement(Ss,null),u.a.createElement(ga,null,u.a.createElement(jo,null))))))}}]),t}(c.Component)},1237:function(e,t,a){},1238:function(e,t,a){},1244:function(e,t,a){},1245:function(e,t,a){"use strict";var n=a(12),r=a(13),o=a(15),i=a(14),s=a(16),l=a(0),c=a.n(l),u=a(172),m=a(219),d=a(562),p=a(170),h=a(54),f=a(23),b=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).onFinishInterval=function(){a.props.pollingCreditsPayment&&a.props.toggleCreditsPaymentPolling(!1)},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.proposalPaywallPaymentTxid;e.proposalPaywallPaymentTxid&&!t&&(this.props.onUserProposalCredits(),this.props.toggleProposalPaymentReceived(!0),this.props.toggleCreditsPaymentPolling(!1))}},{key:"render",value:function(){var e=this.props,t=e.onFetchProposalPaywallPayment,a=e.proposalCredits,n=e.userPaywallStatus,r=e.pollingCreditsPayment,o=e.openModal;return c.a.createElement(d.a,{intervalPeriod:5e3,onInterval:t,active:r,executeOnIntervalBeforeFirstInterval:!0,onFinishInterval:this.onFinishInterval},c.a.createElement(p.a,{text:"Proposal credits are purchased to submit proposals. Click here for more information.",position:"bottom"},c.a.createElement("div",{className:"user-proposal-credits",onClick:function(){return n!==f.U?o(h.i):o(h.h)}},c.a.createElement("div",{className:"proposal-credits-text"},(a||0)+" proposal credit"+(1!==a?"s":"")),c.a.createElement("span",{className:"proposalc-credits-click-here-text"},"Click here to buy and update credits"))))}}]),t}(c.a.Component);t.a=Object(u.a)(Object(m.a)(b))},1248:function(e,t,a){},1249:function(e,t,a){},1253:function(e,t,a){},1254:function(e,t,a){},1257:function(e,t,a){},1258:function(e,t,a){},132:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(27);t.a=function(e){var t=e.title,a=e.meta.error;return a?r.a.createElement(o.a,{type:"error",header:t,body:a}):null}},166:function(e,t,a){"use strict";a.d(t,"g",function(){return v}),a.d(t,"f",function(){return y}),a.d(t,"e",function(){return g}),a.d(t,"d",function(){return E}),a.d(t,"a",function(){return w}),a.d(t,"c",function(){return j}),a.d(t,"b",function(){return C});var n=a(44),r=a(35),o=a(17),i=a(41),s=a.n(i),l=a(262),c=a.n(l),u=a(440),m=a.n(u),d=a(38),p=a.n(d),h=a(1211),f=a.n(h),b=a(109),v=function(e,t){var a=e.name,n=e.timestamp,r=e.status,o=e.userid,i=e.username,s=e.numcomments,l=e.censorshiprecord,c=void 0===l?{}:l,u=e.draftId,m=void 0===u?"":u,d=e.version,p=e.statuschangemessage,h=e.publishedat,f=e.censoredat,b=e.abandonedat;return{kind:"t3",data:{authorid:o,author:i,numcomments:s,rank:t+1,title:a||"(Proposal name hidden)",id:c.token,name:"t3_"+c.token,review_status:r,created_utc:n,publishedat:h,censoredat:f,abandonedat:b,permalink:"/proposals/".concat(c.token),url:"/proposals/".concat(c.token||(m?"new?draftid=".concat(m):"")),is_self:!0,draftId:m,version:d,censorMessage:p}}},y=function(e,t){var a=e.userid,n=e.username,r=e.censorshiprecord,o=void 0===r?{}:r,i=e.status,s=e.timestamp,l=e.numcomments,c=e.input,u=e.version,m=e.draftId,d=void 0===m?"":m,p=e.month,h=e.year;return{kind:"t3",data:{authorid:a,author:n,numcomments:l,input:c,rank:t+1,title:d?"Draft for ".concat(p,"/").concat(h):"Invoice from ".concat(n," - ").concat(c&&c.month,"/").concat(c&&c.year),id:o.token,name:"t3_"+o.token,review_status:i,created_utc:s,permalink:"/invoices/".concat(o.token||(d?"new?draftid=".concat(d):"")),url:"/invoices/".concat(o.token||(d?"new?draftid=".concat(d):"")),is_self:!0,version:u,draftId:d}}},g=function(e,t){return v(e,t)},E=function(e,t){return y(e,t)},O=function e(t,a){var n=t.tree,r=t.comments;return c()(p()(function(t){return{kind:"t1",data:Object(o.a)({},t,{replies:{data:{children:t.id&&e({tree:n,comments:r},t.id)||[]}}})}},function(e){return r[e]}),s()(a||b.a,n)||[])},w=function(e,t,a){return p()(function(e){return function(e,t,a){var n=e.tree,i=e.comments,s={};if(t)return function e(t,a){s=Object(o.a)({},s,Object(r.a)({},a,t[a])),t[a]&&t[a].forEach(function(a){return e(t,a)})}(n,t),function e(t,a){Object.keys(t).forEach(function(n){t[n].find(function(e){return e===a})&&(s=Object(o.a)({},s,Object(r.a)({},n,[a])),e(t,n))})}(n,t),a&&Object.keys(a).forEach(function(e){s=Object(o.a)({},s,Object(r.a)({},e,f()(s[e],a[e])))}),{tree:s,comments:i};return{tree:n,comments:i}}(e,t,a)},m()(function(e,t){var a=t.commentid,i=t.userid,l=t.username,c=t.parentid,u=t.token,m=t.comment,d=t.timestamp,p=t.resultvotes,h=t.vote,f=t.censored;return Object(o.a)({},e,{comments:Object(o.a)({},e.comments,Object(r.a)({},a,{id:a,uservote:String(h),author:l,authorid:i,censored:f,score:p,score_hidden:!1,parent_id:c||b.a,name:a,body:m,created_utc:d,permalink:"/proposals/".concat(u,"/comments/").concat(a)})),tree:Object(o.a)({},e.tree,Object(r.a)({},c||b.a,[].concat(Object(n.a)(s()(["tree",c||b.a],e)||[]),[a])))})},{tree:{},comments:{}}))(e)},j=function(e,t,a){return p()(O,function(e){return w(e,t,a)})(e)},C=function(e){var t=new Set;return Object.keys(e).forEach(function(a){e[a]&&e[a].forEach(function(e){return e&&t.add(e)}),a&&"0"!==a&&t.add(a)}),t}},168:function(e,t,a){"use strict";a.d(t,"b",function(){return o}),a.d(t,"a",function(){return i});var n=a(0),r=a.n(n),o=function(e){var t=e.children;return r.a.createElement("div",{className:"tabs"},t,r.a.createElement("div",{className:"clear"}),r.a.createElement("div",{className:"tab-border"}))},i=function(e){var t,a=e.title,n=e.count,o=e.tabId,i=e.selected,s=e.onTabChange;return"undefined"!==typeof n&&(t=r.a.createElement("div",{className:"tab-count"},n)),""===n&&(t=null),r.a.createElement("span",{className:"tab"+(i?" tab-selected":""),onClick:function(){return s(o)}},a," ",t)}},169:function(e,t,a){"use strict";var n=a(12),r=a(13),o=a(15),i=a(14),s=a(89),l=a(16),c=a(0),u=a.n(c),m=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).getStyleForDiffMode=function(e,t){return{borderLeft:t?"4px solid green":e?"4px solid red":"0"}},a.onRemove=a.onRemove.bind(Object(s.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"onRemove",value:function(e){this.props.onChange({remove:e})}},{key:"render",value:function(){var e=this,t=this.props,a=t.files,n=t.readOnly;return u.a.createElement("div",{className:"attached-images"},a.map(function(t,a){var r=t.name,o=t.mime,i=t.payload,s=t.removed,l=void 0===s?null:s,c=t.added,m=void 0===c?null:c;return u.a.createElement("div",{key:"prop-image-".concat(a),style:e.getStyleForDiffMode(l,m),className:"attached-image-ct"},u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("h5",{className:"attached-image-title"},r),!n&&u.a.createElement("span",{className:"attached-image-remove",onClick:function(){return e.onRemove(a)},title:"Remove image"},"\u2716")),o.includes("image")?u.a.createElement("img",{className:"attached-image",alt:r,src:"data:".concat(o,";base64,").concat(i)}):null)}))}}]),t}(c.Component);m.defaultProps={readOnly:!1,files:[]},t.a=m},170:function(e,t,a){"use strict";var n=a(17),r=a(0),o=a.n(r);t.a=function(e){var t=e.position,a=void 0===t?"bottom":t,r=e.tipStyle,i=void 0===r?{}:r,s=e.wrapperStyle,l=void 0===s?{}:s,c=e.text,u=void 0===c?"tip":c,m=e.children;return o.a.createElement("div",{className:"tooltip-wrapper",style:l},o.a.createElement("div",{className:"tip tip-".concat(a),style:Object(n.a)({},i,{zIndex:"999"})},u),m)}},172:function(e,t,a){"use strict";var n=a(21),r=a(33),o=a(18),i=a(19);t.a=Object(n.b)(o.Vd({proposalPaywallAddress:o.Jd,proposalCreditPrice:o.Dd,proposalPaywallError:o.Kd,isApiRequestingProposalPaywall:o.zc,proposalCredits:o.Fd,proposalCreditPurchases:o.Ed,isApiRequestingUserProposalCredits:o.Jc,userCanExecuteActions:o.je,isTestnet:o.Rc,proposalPaywallPaymentTxid:o.A,proposalPaywallPaymentAmount:o.y,proposalPaywallPaymentConfirmations:o.z,pollingCreditsPayment:o.zd,proposalPaymentReceived:o.Id,paywallTxid:o.xd}),function(e){return Object(r.b)({onUserProposalCredits:i.Kb,onPurchaseProposalCredits:i.C,onFetchProposalPaywallPayment:i.D,toggleCreditsPaymentPolling:i.Zb,toggleProposalPaymentReceived:i.ac},e)})},218:function(e,t,a){"use strict";var n=a(548);t.a=n.a},219:function(e,t,a){"use strict";var n=a(21),r=a(33),o=a(18),i=a(19),s=Object(n.b)(o.Vd({loggedInAsEmail:o.Zc,loggedInAsUsername:o.ad,isAdmin:o.Yb,error:o.s,userPaywallStatus:o.Fb,userCanExecuteActions:o.je,proposalCredits:o.Fd,lastLoginTime:o.Yc,sessionMaxAge:o.Xd,loggedInAsUserId:o.pe,isCMS:o.Mc}),function(e){return Object(r.b)({onLogout:i.X,handleLogout:i.e,openModal:i.Ob},e)});t.a=s},313:function(e,t,a){"use strict";var n=a(21),r=a(18),o=a(19),i=a(41),s=a.n(i),l=a(38),c=a.n(l),u=a(36),m=Object(n.b)(r.Vd({commentid:c()(function(e){return e?e.toLowerCase():e},s()(["match","params","commentid"]),Object(u.b)(1)),isProposalStatusApproved:r.Pc,userId:r.pe,lastBlockHeight:r.Sc,isTestnet:r.Rc,getVoteStatus:r.tb,comments:r.Cd,invoiceComments:r.Tb,loggedInAsEmail:r.Zc,csrf:r.U,isCMS:r.Mc}),{confirmWithModal:o.c,onChangeProposalStatusApproved:o.k,getLastBlockHeight:o.d,onChangeDateFilter:o.j,onResetDateFilter:o.hb});t.a=m},314:function(e,t,a){"use strict";var n=a(55);t.a=n.Expando},321:function(e,t,a){"use strict";var n=a(21),r=a(18),o=a(19),i=Object(n.b)(r.Vd({loggedInAsEmail:r.Zc,email:r.cb,userid:r.pe,isAdmin:r.Yb,userHasPaid:r.ke,userCanExecuteActions:r.je,lastSubmitted:r.ob,setStatusProposalToken:r.ae,setStatusProposalError:r.Yd,authorizeVoteError:r.d,getVoteStatus:r.tb,authorizeVoteToken:r.e,userPaywallStatus:r.Fb,isRequestingAuthorizeVote:r.ac,startVoteToken:r.F,isRequestingStartVote:r.Fc,isApiRequestingSetProposalStatusByToken:r.Ec,startVoteError:r.E}),{onChangeStatus:o.Db,onDeleteDraftProposal:o.p,onStartVote:o.Hb,onAuthorizeVote:o.g,onRevokeVote:o.rb,openModal:o.Ob,onDeleteDraftInvoice:o.o});t.a=i},322:function(e,t,a){"use strict";a.d(t,"c",function(){return o}),a.d(t,"a",function(){return i}),a.d(t,"b",function(){return s});var n=a(35),r={MAX_SIZE:"max_size",MAX_IMAGES:"max_length",INVALID_MIME:"invalid_mime"};function o(e,t){var a={files:e,errors:[],policy:t};return c(u,m,d)(a,t)}function i(e){var t=e.base64,a=e.fileList;return Array.from(a).map(function(e,a){var n=e.name,r=e.size,o=e.type;return{name:n,mime:n.includes(".txt")?"".concat(o,"; charset=utf-8"):o,size:r,payload:t[a].split("base64,").pop()}})}function s(e,t){return e.size>t.maximagesize?{valid:!1,errorMsg:l(t,r.MAX_SIZE,e.name)}:t.validmimetypes.indexOf(e.mime)<0?{valid:!1,errorMsg:l(t,r.INVALID_MIME,e.name)}:{valid:!0,errorMsg:null}}function l(e,t){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(a={},Object(n.a)(a,r.MAX_SIZE,'The file "'.concat(o,'" exceeds the maximum size.')),Object(n.a)(a,r.MAX_IMAGES,"You can upload a maximum of ".concat(e.maximages," images per proposal.")),Object(n.a)(a,r.INVALID_MIME,'The file "'.concat(o,'" has an invalid MIME type.')),a)[t]}var c=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduce(function(e,t){return t(e)},e)}};function u(e){var t=e.files,a=e.errors,n=e.policy;return t.length>n.maximages?(a.push(l(n,r.MAX_IMAGES)),{files:t.slice(0,n.maximages),errors:a,policy:n}):{files:t,errors:a,policy:n}}function m(e){var t=e.files,a=e.errors,n=e.policy;return{files:t.filter(function(e){return!(e.size>n.maximagesize)||(a.push(l(n,r.MAX_SIZE,e.name)),!1)}),errors:a,policy:n}}function d(e){var t=e.files,a=e.errors,n=e.policy;return{files:t.filter(function(e){return!(n.validmimetypes.indexOf(e.mime)<0)||(a.push(l(n,r.INVALID_MIME,e.name)),!1)}),errors:a}}},50:function(e,t,a){"use strict";var n=a(21),r=a(33),o=a(18),i=a(19),s=a(202);t.a=Object(n.b)(o.Vd({isTestnet:o.Rc}),function(e){return Object(r.b)({closeModal:i.b,closeAllModals:i.a,openModal:i.Ob,confirmWithModal:s.c},e)})},51:function(e,t,a){"use strict";var n=a(17),r=a(24),o=a(0),i=a.n(o);t.a=function(e){var t=e.className,a=e.isLoading,o=e.text,s=e.loadingIconStyle,l=void 0===s?{}:s,c=Object(r.a)(e,["className","isLoading","text","loadingIconStyle"]);return i.a.createElement("button",Object.assign({className:"btn ".concat(a?"loading":""," ").concat(t)},c,{onClick:a?function(){return null}:c.onClick}),a?i.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin right-margin-5",style:Object(n.a)({fontSize:"14px"},l)}):null,i.a.createElement("div",{style:{whiteSpace:"normal"}},o),i.a.createElement("div",{style:{clear:"both"}}))}},548:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(25),i=a.n(o),s=a(270),l=a.n(s),c=a(549),u=a(50),m=function(e){var t=e.body,a=e.className,n=e.confirmWithModal,o=e.style,i=e.filterXss,s=void 0===i||i,u=e.displayExternalLikWarning,m=void 0===u||u,d=e.scapeHtml,p=void 0===d||d;return r.a.createElement("div",{className:a,style:o},r.a.createElement(l.a,{className:"md",escapeHtml:p,astPlugins:[c.b],renderers:Object(c.a)(s,m&&n),source:t}))};m.prototype={body:i.a.string,className:i.a.string,confirmWithModal:i.a.bool,style:i.a.object,filterXss:i.a.bool,displayExternalLikWarning:i.a.bool,scapeHtml:i.a.bool},t.a=Object(u.a)(m)},549:function(e,t,a){"use strict";a.d(t,"b",function(){return h}),a.d(t,"c",function(){return f}),a.d(t,"a",function(){return g});var n=a(24),r=a(17),o=a(44),i=a(0),s=a.n(i),l=a(1227),c=a(475),u=a.n(c),m=a(474),d=a.n(m),p=a(54),h=u()({isValidNode:function(e){return"script"!==e.type&&function(e){var t=e.attribs.classname;return"tag"===e.type&&"span"===e.name&&("diff-in"===t||"diff-out"===t)}(e)}}),f=function(e,t){var a=function(e){var t=e.added,a=void 0!==t&&t,n=e.removed,r=void 0!==n&&n,o=e.removedIndex,i=void 0===o?"":o,l=e.addedIndex,c=void 0===l?"":l,u=e.content,m=void 0===u?"":u;return s.a.createElement("tr",{className:"diff-line"+(a?"-added":r?"-removed":"")},s.a.createElement("td",{className:"diff-line-index"},i),s.a.createElement("td",{className:"diff-line-index"},c),s.a.createElement("td",{className:"diff-line-icon"},a?"+":r?"-":""),s.a.createElement("td",{className:"diff-line-content"},m))},n=function(e){return{value:e.value,lineIndex:e.index,removed:!1,added:!0}},r=function(e){return{lineIndex:e.index,removed:e.value,added:!1}},i=function(e){return{value:e.value,lineIndex:e.index,removed:!1,added:!1}},c=function(e){return function(t){return!e.some(function(e){return e.value===t.value})}},u=function(e){return function(t){return!c(e)(t)}},m=function(e){return e&&e.length?e.split("\n").map(function(e,t){return{value:e,index:t}}):[]},d=m(e),p=m(t),h=0,f=0,b=function(e,t,a){return[].concat(Object(o.a)(e.filter(a(t)).map(n)),Object(o.a)(t.filter(a(e)).map(r)),Object(o.a)(e.filter(u(t)).map(i)))}(p,d,c).sort(function(e,t){return e.lineIndex-t.lineIndex}).map(function(e,t){return""!==e.value||e.removed?(e.added?h+=1:e.removed?f+=1:(h+=1,f+=1),function(e,t,n,r){var o=e.removed,i=e.value,c=e.added,u=[],m=Object(l.diffWordsWithSpace)(o||"",i||"").map(function(e){return e.value});return o&&u.push(s.a.createElement(a,{removed:!0,content:m,removedIndex:n,key:t})),c&&u.push(s.a.createElement(a,{added:!0,content:m,addedIndex:r,key:t})),o||c||u.push(s.a.createElement(a,{content:i,addedIndex:r,removedIndex:n,key:t})),u}(e,t,f,h)):(h+=1,f+=1,s.a.createElement(a,{addedIndex:h,removedIndex:f,key:t}))});return s.a.createElement("table",{className:"diff-table",cellSpacing:"0",cellPadding:"0"},s.a.createElement("tbody",null,b))},b=function(e){if("string"===typeof e)return e;var t=e.props;if(!t)return e;var a=Object(r.a)({},t);return a.src&&(a.src=d.a.uriInDoubleQuotedAttr(t.src)),Object(r.a)({},e,{props:a})},v=function(e,t,a){e.preventDefault();var n=document.createElement("a");if(n.href=t,n.hostname&&n.hostname!==window.top.location.hostname){var r=document.title;document.title="Leaving DCC...",a(p.c,{style:{maxWidth:"600px",display:"flex",flexFlow:"column"},altStyle:{maxWidth:"98%",padding:"10px 9px",minHeight:"80px",alignItems:"center"},title:"Warning: Leaving DCC",message:s.a.createElement("div",{style:{textAlign:"left",alignItems:"center"}},s.a.createElement("p",{style:{marginBottom:"10px"}},"You are about to be sent to an external website. This can result in unintended consequences.",s.a.createElement("strong",null," DO NOT")," enter your DCC credentials or reveal any other sensitive information."),s.a.createElement("br",null),s.a.createElement("div",null,s.a.createElement("b",null,"External link:"),s.a.createElement("br",null),s.a.createElement("div",{style:{display:"inline-block",border:"1px solid #dcdcdc",padding:".5em",borderRadius:"6px",background:"#dcdcdc5c",width:"100%",marginTop:"1em"}},s.a.createElement("span",{style:{wordWrap:"break-word"}}," ",n.protocol+"//",s.a.createElement("strong",{className:"red"},n.hostname),n.pathname+n.search+n.hash))),s.a.createElement("br",null),s.a.createElement("p",{style:{marginTop:"12px",textAlign:"center"}},"Are you ",s.a.createElement("strong",null," sure")," you want to open this link?")),cancelText:"Cancel",submitText:"Proceed"}).then(function(e){if(e){var a=window.open();a.opener=null,a.location.href=t,a.target="_blank"}document.title=r})}else n.hostname?(window.location.href=t,document.title=(void 0).props.proposal.name):console.log("Blocked potentially malicious link: ",t)},y=function(e){return function(t){e&&(t=function e(t,a){var n=function(t){return s.a.Children.map(t,function(t){return e(t,a)})},o=null;if(t.children)o=Object(r.a)({},t,{children:n(t.children)});else if(t.props&&t.props.children){var i=n(t.props.children);o=Object(r.a)({},t,{props:Object(r.a)({},t.props,{children:i})})}return a(o||t)}(t,b));var a=t,o=a.children,i=Object(n.a)(a,["children"]);return s.a.createElement("div",i,o)}},g=function(e,t){var a=function(e){return function(t){var a=t.src,n=t.alt;return s.a.createElement("a",{target:"_blank",rel:"nofollow noopener noreferrer",onClick:function(t){return e&&v(t,a,e)},href:a},n)}}(t),n=function(e){return function(t){var a=t.href,n=t.children;return s.a.createElement("a",{target:"_blank",rel:"nofollow noopener noreferrer",onClick:function(t){return e&&v(t,a,e)},href:a},n[0])}}(t);return{image:a,imageReference:a,link:n,linkReference:n,root:y(e)}}},550:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(){return r.a.createElement("div",{className:"markhelp"},r.a.createElement("p",{style:{width:"100%"}},"We use a slightly-customized version of"," ",r.a.createElement("a",{href:"http://daringfireball.net/projects/markdown/syntax"},"Markdown")," ","for formatting. See below for some basics"),r.a.createElement("table",{className:"md"},r.a.createElement("tbody",null,r.a.createElement("tr",{style:{backgroundColor:"#ffff99",textAlign:"center"}},r.a.createElement("td",null,r.a.createElement("em",null,"you type:")),r.a.createElement("td",null,r.a.createElement("em",null,"you see:"))),r.a.createElement("tr",null,r.a.createElement("td",null,"*italics*"),r.a.createElement("td",null,r.a.createElement("em",null,"italics"))),r.a.createElement("tr",null,r.a.createElement("td",null,"**bold**"),r.a.createElement("td",null,r.a.createElement("b",null,"bold"))),r.a.createElement("tr",null,r.a.createElement("td",null,"[demos!](http://www.doschain.org)"),r.a.createElement("td",null,r.a.createElement("a",{href:"http://www.doschain.org"},"demos!"))),r.a.createElement("tr",null,r.a.createElement("td",null,"* item 1",r.a.createElement("br",null),"* item 2",r.a.createElement("br",null),"* item 3"),r.a.createElement("td",null,r.a.createElement("ul",null,r.a.createElement("li",null,"item 1"),r.a.createElement("li",null,"item 2"),r.a.createElement("li",null,"item 3")))),r.a.createElement("tr",null,r.a.createElement("td",null,"> quoted text"),r.a.createElement("td",null,r.a.createElement("blockquote",null,"quoted text"))),r.a.createElement("tr",null,r.a.createElement("td",null,"Lines starting with four spaces",r.a.createElement("br",null),"are treated like code:",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",{className:"spaces"},"\xa0\xa0\xa0\xa0"),"if 1 * 2 != 3:",r.a.createElement("br",null),r.a.createElement("span",{className:"spaces"},"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"),'print "hello, world!"',r.a.createElement("br",null)),r.a.createElement("td",null,"Lines starting with four spaces",r.a.createElement("br",null),"are treated like code:",r.a.createElement("br",null),r.a.createElement("pre",null,"if 1 * 2 != 3:",r.a.createElement("br",null),'print "hello, world!"',"\n"))),r.a.createElement("tr",null,r.a.createElement("td",null,"~~strikethrough~~"),r.a.createElement("td",null,r.a.createElement("strike",null,"strikethrough"))))))}},556:function(e,t,a){"use strict";var n=a(17),r=a(12),o=a(13),i=a(15),s=a(14),l=a(89),c=a(16),u=a(0),m=a.n(u),d=a(1),p=a.n(d),h=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={isopen:!1},a.handleTriggerClick=a.handleTriggerClick.bind(Object(l.a)(a)),a.handleClick=a.handleClick.bind(Object(l.a)(a)),a}return Object(c.a)(t,e),Object(o.a)(t,[{key:"handleTriggerClick",value:function(){this.props.disabled||this.setState(function(e){return{isopen:!e.isopen}})}},{key:"handleClick",value:function(e){p.a.findDOMNode(this).contains(e.target)||this.setState({isopen:!1})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClick,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick,!1)}},{key:"render",value:function(){var e=this.props,t=e.DropdownTrigger,a=e.DropdownContent,r=e.dropdownContentStyle,o=e.dropdownTriggerStyle,i=e.hideDropdownIcon,s=e.disabled,l=this.state.isopen,c=Object(n.a)({position:"absolute",top:"36px",right:"-16px",border:"1px solid rgba(255, 255, 255, .8)",backgroundColor:"#091440",width:"200px"},r),u=Object(n.a)({cursor:s?"normal":"pointer"},o),d=m.a.cloneElement(t,{style:u}),p=m.a.cloneElement(a,{style:c});return m.a.createElement("div",{className:"dropdown-ct"},m.a.createElement("div",{className:"dropdown",onClick:this.handleTriggerClick},d,i?null:m.a.createElement("span",{style:{marginLeft:"5px",position:"relative"}},"\u25be")),l&&p)}}]),t}(u.Component);t.a=h},561:function(e,t,a){"use strict";(function(e){var n=a(12),r=a(13),o=a(15),i=a(14),s=a(16),l=a(0),c=a.n(l),u=a(1275),m=a(162),d=a.n(m),p=a(219),h=a(556),f=a(1245);function b(){var e=window.location.host,t="login.doschain.org";return-1!==(void 0===e?"":e).indexOf("-testnet")&&(t="login-testnet.doschain.org"),"https://".concat(t)}var v=function(t){function a(){return Object(n.a)(this,a),Object(o.a)(this,Object(i.a)(a).apply(this,arguments))}return Object(s.a)(a,t),Object(r.a)(a,[{key:"render",value:function(){var t=this.props,a=t.history,n=t.loggedInAsEmail,r=t.loggedInAsUsername,o=t.userCanExecuteActions,i=t.onLogout,s=t.loggedInAsUserId,l=t.isCMS;return n?c.a.createElement("div",{id:"header-right"},c.a.createElement("div",{id:"header-right-content"},c.a.createElement(d.a,{className:"loggedin"}),!l&&c.a.createElement(f.a,null),c.a.createElement("div",{className:"user"},c.a.createElement(h.a,{DropdownTrigger:c.a.createElement("div",{className:"dropdown-trigger"},r),DropdownContent:c.a.createElement("ul",null,l?c.a.createElement("li",{className:"dropdown-list-item",onClick:function(){return a.push("/user/invoices")}},"Invoices"):c.a.createElement("li",{className:"dropdown-list-item",onClick:function(){return a.push("/user/proposals")}},"Proposals"),c.a.createElement("li",{className:"dropdown-list-item",onClick:function(){return a.push("/user/".concat(s))}},"Account"),c.a.createElement("li",{className:"dropdown-list-item ".concat(o?"":"disabled"),onClick:function(){return o?a.push("/".concat(l?"invoices":"proposals","/new")):null}},l?"Submit Invoice":"Submit Proposal"),c.a.createElement("li",{className:"dropdown-list-item logout-button",onClick:function(){a.push("/user/logout"),i()}},c.a.createElement("form",{className:"logout hover"}),"Log out"))})))):c.a.createElement("div",{id:"header-right"},c.a.createElement("div",{id:"header-right-content"},c.a.createElement("a",{href:"".concat(b(),"/login.html?redirect=").concat(encodeURIComponent(e.location.origin+"/api/v1/sign-in")),className:"login-required"},"Log in or sign up")))}}]),a}(c.a.Component);t.a=Object(u.a)(Object(p.a)(v))}).call(this,a(3))},562:function(e,t,a){"use strict";var n=a(12),r=a(13),o=a(15),i=a(14),s=a(16),l=a(0),c=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).interval=null,a.startInterval=function(){var e=a.props,t=e.intervalPeriod;e.executeOnIntervalBeforeFirstInterval&&a.onInterval(),a.interval=setInterval(a.onInterval,t)},a.onInterval=function(){var e=a.props,t=e.maxNumberOfExecutions,n=e.onInterval,r=a.state.numberOfExecutions;t&&r===t?a.finishInterval():(a.setState({numberOfExecutions:++r}),n())},a.finishInterval=function(){clearInterval(a.interval),a.setState({numberOfExecutions:0}),a.props.onFinishInterval&&a.props.onFinishInterval()},a.state={numberOfExecutions:0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.active;t.startOnMount||e.active||!a?e.active&&!a&&this.finishInterval():this.startInterval()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return this.props.children}}]),t}(a.n(l).a.Component);t.a=c},567:function(e,t,a){"use strict";var n,r=a(12),o=a(13),i=a(15),s=a(14),l=a(16),c=a(0),u=a.n(c),m=a(55),d=a(886),p=a(54),h=a(51),f=function(e){var t=e.message;return u.a.createElement("div",{style:{border:"1px solid rgb(187, 187, 187)",borderRadius:"8px",padding:"10px",marginTop:"10px"}},u.a.createElement("p",null,u.a.createElement("span",{style:{fontWeight:"bold"}},"Admin Censorship reason:"),u.a.createElement("br",null),t))},b=a(89),v=a(21),y=a(18),g=Object(v.b)(y.Vd({proposal:y.Ad,proposalComments:y.Cd,serverPubkey:y.Wd})),E=a(485),O=a.n(E),w=a(166),j=g(function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleDownloadProposal=a.handleDownloadProposal.bind(Object(b.a)(a)),a.handleDownloadComment=a.handleDownloadComment.bind(Object(b.a)(a)),a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"handleDownloadProposal",value:function(){var e=this.props,t=e.proposal,a=e.serverPubkey,n=t;n.serverPubkey=a;var r=JSON.stringify(n,null,2);O()(r,"".concat(t.censorshiprecord.token,".json"))}},{key:"handleDownloadComment",value:function(){var e=this.props,t=e.proposalComments,a=e.proposal,n=JSON.stringify(Object(w.c)(t),null,2);O()(n,"".concat(a.censorshiprecord.token,"-comments.json"))}},{key:"render",value:function(){var e=this.props.type;return"proposal"===e?u.a.createElement("span",{className:"linkish",onClick:this.handleDownloadProposal},this.props.message||"Download Proposal Bundle"):"comments"===e?u.a.createElement("span",{className:"linkish",onClick:this.handleDownloadComment},this.props.message||"Download Comments Bundle"):null}}]),t}(c.Component)),C=a(27),k=a(169),x=a(170),S=a(33),P=a(19),N=Object(v.b)(y.Vd({getVoteStatus:y.tb,lastBlockHeight:y.Sc,isTestnet:y.Rc}),function(e){return Object(S.b)({onFetchVoteStatus:P.F},e)}),I=a(17),A=a(35),D={display:"flex",height:"100%",fontWeight:"bold",textTransform:"uppercase",alignItems:"center"},F={position:"relative",height:0,width:0,top:"3px",left:"10px",fontWeight:"bold",textTransform:"uppercase",whiteSpace:"nowrap"},T={position:"relative",display:"flex",width:"100%",height:"24px",color:"grey",border:"1px solid #D6D6D6",borderRadius:"8px",overflow:"hidden"},M={borderRight:"1px solid",position:"absolute",display:"flex",justifyContent:"flex-end",left:"0px",fontSize:"11px",fontWeight:"normal"},R={position:"absolute",right:"-30px",borderRadius:"8px",height:"20px",width:"30px",display:"flex",justifyContent:"center",alignItems:"center",color:"green",fontWeight:"bold",fontSize:"12px"},V=function(e){var t=e.data,a=e.style,n=e.displayValuesForLabel,r=e.threeshold,o=n&&t.filter(function(e){return e.label===n})[0],i=o&&"".concat(o.label,": ").concat(o.value,"%");return u.a.createElement("div",{style:Object(I.a)({},T,a)},i&&u.a.createElement("span",{style:F},i),t.filter(function(e){return e.label===n}).map(function(e,t){return u.a.createElement("span",{key:"data-".concat(t),style:Object(I.a)({},D,{background:e.value<r?"linear-gradient(90deg, ".concat("#FFA07A"," 20%, ").concat("#a7f1eb",")"):"#a7f1eb",width:"".concat(e.value,"%")})})}),r?u.a.createElement("span",{style:Object(I.a)({},D,M,{width:"".concat(r,"%")})},u.a.createElement("span",{style:R},u.a.createElement(x.a,{tipStyle:{left:"24px",maxWidth:"105px",padding:"1px",fontWeight:"normal"},text:"pass percentage",position:"right"},r,"%"))):null)},U=a(286),L=a.n(U),_=a(34),q=a(23),W=(n={},Object(A.a)(n,q.jb,"Proposal voting active"),Object(A.a)(n,q.lb,"Proposal voting finished"),Object(A.a)(n,q.mb,"Author has not yet authorized the start of voting"),Object(A.a)(n,q.kb,"Waiting for administrator approval to start voting"),n),H=function(e){var t,a=e.status,n={fontWeight:"bold"};return(t={},Object(A.a)(t,q.jb,u.a.createElement("span",{style:Object(I.a)({},n,{color:"#41bf53"})},W[a])),Object(A.a)(t,q.lb,u.a.createElement("span",{style:Object(I.a)({},n,{color:"#091440"})},W[a])),Object(A.a)(t,q.mb,u.a.createElement("span",{style:Object(I.a)({},n,{color:"#8997a5"})},W[a])),Object(A.a)(t,q.kb,u.a.createElement("span",{style:Object(I.a)({},n,{color:"#d69400"})},W[a])),t)[a]||null},Y=function(e,t){return Number.parseFloat(e/t*100).toFixed(2)},z=function(e){return"yes"===e.id?-1:1},B=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).getColor=function(e){switch(e){case"yes":return"#def9f7";case"no":return"#FFF";default:return Object(_.n)()}},a.canShowStats=function(e,t){return(e===q.jb||e===q.lb)&&t>0},a.transformOptionsResult=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(t){var n=t.option,r=t.votesreceived;return{id:n.id,description:n.description,votesReceived:r,percentage:Y(r,e),color:a.getColor(n.id)}}).sort(z)},a.renderStats=function(e){var t={textTransform:"uppercase",fontWeight:"semibold",marginRight:"4px"};return u.a.createElement("span",{key:"option-".concat(e.id),style:{display:"flex",marginRight:"8px"}},"yes"===e.id?u.a.createElement(x.a,{tipStyle:{fontSize:"11px",top:"20px",left:"20px",width:"36px"},text:"Yes",position:"bottom"},u.a.createElement("span",null,u.a.createElement("span",{style:t}," \u2714 ".concat(e.votesReceived)))):u.a.createElement(x.a,{tipStyle:{fontSize:"11px",top:"20px",left:"20px",width:"29px"},text:"No",position:"bottom"},u.a.createElement("span",{style:{marginRight:"25px"}},u.a.createElement("span",{style:t}," \u2716 ".concat(e.votesReceived)))))},a.getChartData=function(e){return e.map(function(e){return{label:e.id,value:e.percentage,color:e.color}})},a.getTimeInBlocks=function(e,t){var n=e-t,r=a.props.isTestnet?2*n:5*n,o=new Date(6e4*r+Date.now()),i=L()(o,{addSuffix:!0}),s=u.a.createElement(x.a,{tipStyle:{fontSize:"11px",top:"20px",left:"20px",width:"90px"},text:"Voting ends at block #"+e,position:"bottom"},u.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"}},u.a.createElement("span",null,0===n?"last block left":n+" blocks left"),u.a.createElement("span",{style:{fontSize:"11px"}},"vote ends ",i)));return r>0?s:u.a.createElement("span",null,"finished")},a.renderOptionsStats=function(){var e=a.props,t=e.status,n=e.totalVotes,r=e.optionsResult,o=e.endHeight,i=e.currentHeight,s=e.quorumPercentage,l=e.passPercentage,c=e.numOfEligibleVotes,m=a.canShowStats(t,n),d=r?a.transformOptionsResult(n,r):[],p=t===q.mb||t===q.kb,h=Math.trunc(c*s/100),f={marginTop:"10px"};return u.a.createElement("div",null,u.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},u.a.createElement(H,{status:t}),m&&u.a.createElement("span",{style:{marginLeft:"20px"}},"Votes: "),p||m?null:u.a.createElement("div",{style:{color:"gray"}},u.a.createElement("p",null,"zero votes")),m&&d.map(function(e){return a.renderStats(e)}),o&&i&&!p?a.getTimeInBlocks(o,i):null),m?u.a.createElement("div",{style:f},u.a.createElement(V,{displayValuesForLabel:"yes",style:Object(I.a)({},f,{maxWidth:"500px"}),data:a.getChartData(d),threeshold:l}),u.a.createElement("div",{style:{marginTop:"10px",display:"flex"}},"Quorum:",u.a.createElement(x.a,{tipStyle:{left:"105px",top:"-2px",padding:"3px",textAlign:"center",minWidth:"300px"},text:"Quorum minimum is ".concat(s,"% of ").concat(c," elegible votes"),position:"right"},u.a.createElement("span",{style:{marginLeft:"5px",color:n<h?"#FFA07A":"green"}},"".concat(n,"/").concat(h," votes"))))):null)},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.renderOptionsStats()}}]),t}(u.a.Component),K=(a(1237),N(function(e){var t=e.token,a=e.lastBlockHeight,n=(0,e.getVoteStatus)(t)||{},r=n.optionsresult,o=n.status,i=n.totalvotes,s=n.endheight,l=n.quorumpercentage,c=n.passpercentage,m=n.numofeligiblevotes;return u.a.createElement("div",{className:"voteStatsWrapper"},u.a.createElement(B,{status:o,optionsResult:r,totalVotes:i,endHeight:s,quorumPercentage:l,passPercentage:c,numOfEligibleVotes:m,currentHeight:a}))})),Z=a(556),Q={display:"flex",flexDirection:"column",top:"20px",background:"white",zIndex:"99",width:"100px",fontSize:"14px",boxShadow:"0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)"},X={fontSize:"14px",display:"flex",alignItems:"center"},G={cursor:"pointer",textAlign:"center"},J=function(e){for(var t=e.version,a=e.onSelectVersion,n=[],r="1"===t,o=function(e){n.push(u.a.createElement("span",{key:e,className:"version-picker__item",style:G,onClick:function(){return a(e.toString())}},"version ".concat(e)))},i=parseInt(t,10);i>=1;i--)o(i);return u.a.createElement(Z.a,{dropdownContentStyle:Q,dropdownTriggerStyle:X,DropdownTrigger:u.a.createElement("span",null,"edited"),DropdownContent:u.a.createElement("div",null,n),hideDropdownIcon:r,disabled:r})},$=a(321),ee=a(313),te=a(314),ae=function(e,t){return u.a.createElement("div",{style:{width:"25px"}},u.a.createElement(x.a,{tipStyle:{fontSize:"14px",left:"30px",width:"145px"},text:"".concat("expand"===e?"Show":"Hide"," proposal body"),position:"right"},u.a.createElement("button",{className:"collapse-icon-button",onClick:t},u.a.createElement("i",{className:"fa fa-".concat(e)}))))},ne=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleExpandToggle=function(e){e&&e.preventDefault()&&e.stopPropagation(),a.setState(function(e){return{expanded:!e.expanded}})},a.state={expanded:!a.props.commentid},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.Expando,a=void 0===t?te.a:t,n=e.id,r=e.expanded,o=void 0!==r&&r,i=e.name,s=e.author,l=e.authorid,c=e.censorMessage,b=e.domain,v=e.rank,y=void 0===v?0:v,g=e.userid,E=e.draftId,O=e.version,w=e.subreddit,S=e.subreddit_id,P=e.created_utc,N=e.publishedat,I=e.abandonedat,A=e.censoredat,D=e.title,F=e.url,T=e.permalink,M=e.is_self,R=e.selftext,V=e.selftext_html,U=e.thumbnail,L=e.otherFiles,_=e.review_status,W=e.numcomments,H=e.lastSubmitted,Y=e.loggedInAsEmail,z=e.isAdmin,B=e.userCanExecuteActions,Z=e.onChangeStatus,Q=e.onStartVote,X=e.openModal,G=e.onAuthorizeVote,$=e.onRevokeVote,ee=e.setStatusProposalToken,ne=e.onDeleteDraftProposal,re=e.setStatusProposalError,oe=e.isTestnet,ie=e.getVoteStatus,se=e.confirmWithModal,le=e.userId,ce=e.comments,ue=e.authorizeVoteToken,me=e.isRequestingAuthorizeVote,de=e.authorizeVoteError,pe=e.isRequestingStartVote,he=e.startVoteToken,fe=e.startVoteError,be=e.isApiRequestingSetProposalStatusByToken,ve=e.commentid,ye=ie(n)&&ie(n).status,ge=_===q.bb,Ee=_===q.cb,Oe=_===q.eb||_===q.fb,we=_===q.db,je=O&&parseInt(O,10)>1&&_===q.db,Ce=ye===q.jb||ye===q.lb,ke=l===le&&!Ce&&!ge&&!Ee&&ye!==q.kb,xe=l===le&&ye===q.kb,Se=_===q.fb||parseInt(O,10)>1,Pe=l===le,Ne=Pe&&ye&&ye===q.mb&&!ge,Ie=Pe&&ye===q.kb,Ae=z&&!ge&&ye===q.kb&&(l!==g||oe),De=z&&Oe&&(l!==g||oe),Fe=we&&!Ce&&ye!==q.kb&&z&&!ge,Te=[ee===n&&re,ue===n&&de,he===n&&fe],Me=pe&&he===n,Re=me&&ue===n,Ve=be(n),Ue=Ve&&Ve===q.cb,Le=Ve&&Ve===q.db,_e=Ve&&Ve===q.bb,qe=!!E,We=ce.length,He=o&&We>W?We:W;return u.a.createElement("div",{className:"thing thing-proposal id-".concat(n," odd link ").concat(_===q.cb?"spam":ge?"abandoned":null),"data-author":s,"data-author-fullname":"","data-domain":b,"data-fullname":i,"data-rank":y,"data-subreddit":w,"data-subreddit-fullname":S,"data-timestamp":P,"data-type":"link","data-url":F,id:"thing_".concat(i)},u.a.createElement("p",{className:"parent"}),U&&!["image","default","nsfw","self"].find(function(e){return e===U})?u.a.createElement(d.a,{to:F,className:"thumbnail may-blank loggedin"},u.a.createElement("img",{alt:"Thumb",height:70,src:U,width:70})):null,M?u.a.createElement(d.a,{className:"thumbnail self may-blank",to:F}):null,u.a.createElement("div",{className:"entry unvoted"},u.a.createElement("span",{className:"title",style:{display:"flex",overflow:"visible",cursor:"pointer"}},u.a.createElement(d.a,{to:F,className:"right-margin-5"},D," ",_===q.fb?u.a.createElement("span",{className:"font-12 warning-color"},"edited"):null," "),o&&(je||ge)&&O>1?u.a.createElement(J,{onSelectVersion:function(e){X(p.j,{version:e,token:n})},version:O}):null,b?u.a.createElement("span",{className:"domain"},"(",u.a.createElement(d.a,{to:"/domain/".concat(b,"/")},b),")"):null,u.a.createElement("div",{style:{flex:"1",display:"flex",justifyContent:"flex-end",alignItems:"flex-start"}},ke?u.a.createElement(d.a,{to:"/proposals/".concat(n,"/edit"),className:"edit-proposal right-margin-10"},u.a.createElement("i",{className:"fa fa-edit right-margin-5"}),"Edit"):xe?u.a.createElement(x.a,{wrapperStyle:{marginRight:"10px"},tipStyle:{top:"20px",fontSize:"14px"},text:"Revoke vote authorization to edit your proposal again.",position:"bottom"},u.a.createElement("span",{style:{color:"#bbb",cursor:"not-allowed"}},u.a.createElement("i",{className:"fa fa-edit right-margin-5"}),"Edit")):null)),u.a.createElement("span",{style:{display:"flex",flexDirection:"column"},className:"tagline"},u.a.createElement("span",{className:"submitted-by"},s&&u.a.createElement("span",null," by ",u.a.createElement(d.a,{to:"/user/".concat(l)},s))),Oe?u.a.createElement("span",{className:"submitted-by"},Se?"edited ":"submitted ",u.a.createElement(m.DateTooltip,{createdAt:P})):null,u.a.createElement("span",{className:"submitted-by"},N?u.a.createElement(u.a.Fragment,null,"published ",u.a.createElement(m.DateTooltip,{createdAt:N})):null),u.a.createElement("span",{className:"submitted-by"},I?u.a.createElement(u.a.Fragment,null,"abandoned ",u.a.createElement(m.DateTooltip,{createdAt:I})):null),u.a.createElement("span",{className:"submitted-by"},A?u.a.createElement(u.a.Fragment,null,"censored ",u.a.createElement(m.DateTooltip,{createdAt:A})):null),u.a.createElement("span",{className:"submitted-by"},je?u.a.createElement(u.a.Fragment,null,"version ".concat(O," edited "),u.a.createElement(m.DateTooltip,{createdAt:P})):null)),E&&u.a.createElement("div",{className:"tagline proposal-draft"},"Saved as draft",u.a.createElement("span",{className:"delete-draft",onClick:function(){se(p.c,{message:"Are you sure you want to delete this draft?"}).then(function(e){return e&&ne(E)})}},u.a.createElement("i",{className:"fa fa-trash"}),"Delete")),4===_&&u.a.createElement(K,{token:n}),o&&(H===n?u.a.createElement(C.a,{type:"info"},u.a.createElement("span",null,u.a.createElement("p",{style:{marginTop:"0.4166667em",marginBottom:"0.4166667em"}},"Your proposal has been created, but it will not be public until an admin approves it. You can"," ",u.a.createElement(j,{message:"download your proposal",type:"proposal"})," ","and use the"," ",u.a.createElement("a",null,"dcc_verify tool")," ",'to prove that your submission has been accepted for review by DCC. Once approved, an "Authorize Voting to Start" button will appear. You will have 14 days to authorize a proposal vote. If you fail to do so, your proposal will be considered abandoned.'))):ce.length>0?u.a.createElement("div",null,u.a.createElement("div",{style:{marginTop:"15px",marginBottom:"15px"}},u.a.createElement(j,{type:"proposal"})),u.a.createElement("div",{style:{marginTop:"15px",marginBottom:"15px"}},u.a.createElement(j,{type:"comments"}))):u.a.createElement("div",{style:{marginTop:"15px",marginBottom:"15px"}},u.a.createElement(j,{type:"proposal"})," ",u.a.createElement("br",null))),c&&u.a.createElement(f,{message:c}),u.a.createElement(a,{expanded:this.state.expanded,collapseContent:!!ve,is_self:M,selftext:R,selftext_html:V,expandIcon:ae("expand",this.handleExpandToggle),compressIcon:ae("compress",this.handleExpandToggle)}),this.state.expanded&&u.a.createElement(k.a,{readOnly:!0,files:L}),De?u.a.createElement("ul",{style:{display:"flex"}},u.a.createElement("li",{key:"spam"},u.a.createElement(h.a,{className:"c-btn c-btn-primary".concat(B?"":" not-active disabled"),onClick:function(e){return se(p.d,{reasonPlaceholder:"Please provide a reason to censor this proposal"}).then(function(e){var t=e.reason;return e.confirm&&Z(l,Y,n,q.cb,t)})&&e.preventDefault()},text:"Spam","data-event-action":"spam",isLoading:Ue})),u.a.createElement("li",{key:"approve"},u.a.createElement(h.a,{className:"c-btn c-btn-primary".concat(B?"":" not-active disabled"),onClick:function(e){return se(p.c,{message:"Are you sure you want to publish this proposal?"}).then(function(e){return e&&Z(l,Y,n,q.db)})&&e.preventDefault()},text:"approve","data-event-action":"approve",isLoading:Le}))):null,Ae?u.a.createElement("li",{key:"start-vote"},u.a.createElement(h.a,{className:"c-btn c-btn-primary".concat(B?"":" not-active disabled"),onClick:function(e){return X(p.m,{},function(t,a,r){return Q(Y,n,t,a,r)&&e.preventDefault()})},text:"Start Vote","data-event-action":"start-vote",isLoading:Me})):null,Ne?u.a.createElement("li",null,u.a.createElement(h.a,{className:"c-btn c-btn-primary".concat(B?"":" not-active disabled"),onClick:function(e){return se(p.c,{message:u.a.createElement("span",null,"Are you sure you want to ",u.a.createElement("b",null,"authorize")," the admins to start the voting for this proposal?")}).then(function(e){return e&&G(Y,n,O)})&&e.preventDefault()},text:"Authorize voting to start","data-event-action":"authorize-vote",isLoading:Re})):Ie?u.a.createElement("li",null,u.a.createElement(h.a,{className:"c-btn c-btn-primary".concat(B?"":" not-active disabled"),onClick:function(e){return se(p.c,{message:u.a.createElement("span",null,"Are you sure you want to ",u.a.createElement("b",null,"revoke")," the start voting authorization for this proposal?")}).then(function(e){return e&&$(Y,n,O)})&&e.preventDefault()},text:"Revoke voting authorization","data-event-action":"revoke-vote",isLoading:Re})):null,Fe&&u.a.createElement("ul",{style:{display:"flex"}},u.a.createElement("li",{key:"spam"},u.a.createElement(h.a,{className:"c-btn c-btn-primary".concat(B?"":" not-active disabled"),onClick:function(e){return se(p.d,{reasonPlaceholder:"Please provide a reason for marking this proposal as abandoned"}).then(function(e){var t=e.reason;return e.confirm&&Z(l,Y,n,q.bb,t)})&&e.preventDefault()},text:"abandon","data-event-action":"abandon",isLoading:_e}))),u.a.createElement("ul",{className:"flat-list buttons",style:{display:"flex"}},we?u.a.createElement("li",null,u.a.createElement(d.a,{className:"bylink comments may-blank proposal-permalink","data-event-action":"comments",to:"".concat(F,"?comments=true")},He||""," ",He<=1?"comment":"comments")):null,!qe&&u.a.createElement("li",null,u.a.createElement(d.a,{className:"bylink comments may-blank proposal-permalink","data-event-action":"permalink",to:T},"permalink")),Ce&&u.a.createElement("li",null,u.a.createElement(d.a,{className:"bylink comments may-blank proposal-permalink",to:"",target:"_blank",onClick:function(e){e.preventDefault(),X(p.l,{id:n,title:D},null)}},"search votes"))),Te.map(function(e,t){return e?u.a.createElement(C.a,{key:"error-".concat(t),type:"error",header:"Error setting proposal status",body:e}):null})),u.a.createElement("div",{className:"child"}),u.a.createElement("div",{className:"clearleft"}))}}]),t}(u.a.Component);t.a=Object($.a)(Object(ee.a)(ne))},568:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(12),i=a(13),s=a(15),l=a(14),c=a(16),u=a(1213),m=a(217),d=(a(1223),a(1224),a(1225),a(1226),a(218)),p=function(e){var t=e.body,a=e.fullWidth;return r.a.createElement("div",{className:"mde-preview ".concat(a&&"fullwidth")},r.a.createElement(d.a,{body:t,className:"mde-preview-content"}))},h={newline:10},f=function(e){return{mistake:e,message:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""}};var b=[function(e){var t=h.newline,a=!1;return function(e,t){for(var a=0,n=e.length;a<n;a++)t(e.charCodeAt(a),a)}(e,function(n,r){var o=e.charCodeAt(r+1),i=e.charCodeAt(r-1);n===t&&o&&o!==t&&i!==t&&(a=!0)}),f(a,"You should press Enter twice to create separate paragraphs of text")}];function v(e){return function(e){return e.reduce(function(e,t){var a=t.childNodes,n=!0,r=!1,o=void 0;try{for(var i,s=a[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;"#text"===l.nodeName&&(e+=l.nodeValue)}}catch(c){r=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return e},"")}(function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value;"P"===s.nodeName&&t.push(s)}}catch(l){n=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}return t}(document.querySelector(".".concat(e)).firstChild.childNodes))}var y=a(27),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).interval=null,a.lookForMistakes=function(){var e=function(e){var t=b.map(function(t){return t(e)}),a=t.filter(function(e){return e.mistake}).length>0;return{findersResults:t,anyMistake:a}}(v(a.props.classToSelect)),t=e.findersResults,n=e.anyMistake;a.setState({show:n,findersResults:t})},a.renderMessages=function(e){return r.a.createElement("ul",{style:{paddingLeft:"20px"}},e.map(function(e,t){return r.a.createElement("li",{key:"rm-".concat(t)},e.message)}))},a.state={show:!1,findersResults:[]},a}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.lookForMistakes()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this.state,t=e.show,a=e.findersResults;return t?r.a.createElement(y.a,{body:this.renderMessages(a),type:"info"}):null}}]),t}(r.a.Component),E=function(e){var t=e.Toolbar,a=e.TextArea,n=e.Preview,o=e.LiveHelper;return r.a.createElement("div",{className:"react-mde"},t,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},a,n),r.a.createElement("div",{className:"mde-help"},o))},O=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={previewActive:!1},a}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.Preview,n=t.TextArea,o=t.Toolbar,i=t.value,s=this.state.previewActive,l={color:s?"#767676":"#0079d3",marginRight:"6px"},c={color:s?"#0079d3":"#767676"};return r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("div",{style:{marginTop:"12px",float:"right",marginBottom:"10px",cursor:"pointer",fontSize:"18px"}},r.a.createElement("span",{style:l,onClick:function(){return e.setState({previewActive:!1})}},"Write"),r.a.createElement("span",{style:c,onClick:function(){return e.setState({previewActive:!0})}},"Preview")),s?r.a.createElement("div",{style:{paddingTop:"48px",width:"100%",background:"white"}},i?a:r.a.createElement("span",{style:{fontSize:"18px",width:"100%",textAlign:"center"}},"Nothing to preview")):r.a.createElement("div",{className:"react-mde",style:{background:"white"}},o,n))}}]),t}(r.a.Component),w=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).getCustomCommands=function(){return[[u.ReactMdeCommands.makeHeaderCommand,u.ReactMdeCommands.makeBoldCommand,u.ReactMdeCommands.makeItalicCommand],[u.ReactMdeCommands.makeLinkCommand,u.ReactMdeCommands.makeQuoteCommand,u.ReactMdeCommands.makeCodeCommand],[u.ReactMdeCommands.makeUnorderedListCommand,u.ReactMdeCommands.makeOrderedListCommand]]},a.handleValueChange=function(e){a.props.toggledStyle||(a.textArea.style.height="auto",a.textArea.style.height=a.textArea.scrollHeight+"px"),(0,a.props.onChange)(e.text)},a.handleCommand=function(e){var t=a.props,n=t.value;(0,t.onChange)(e.execute(n,Object(m.getSelection)(a.textArea)).text)},a}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){if(!this.props.toggledStyle)for(var e=this.textArea,t=0;t<e.length;t++)e[t].setAttribute("style","height:"+e[t].scrollHeight+"px;");"undefined"!==typeof this.props.tabIndex&&this.textArea.setAttribute("tabindex",this.props.tabIndex)}},{key:"render",value:function(){var e=this,t=this.props,a=t.value,n=t.toggledStyle,o=r.a.createElement(u.ReactMdeToolbar,{commands:this.getCustomCommands(),onCommand:this.handleCommand}),i=r.a.createElement(u.ReactMdeTextArea,{onChange:this.handleValueChange,value:{text:a},textAreaRef:function(t){return e.textArea=t}}),s=r.a.createElement(p,{body:a}),l=r.a.createElement(g,{classToSelect:"mde-preview-content"});return n?r.a.createElement(O,{Toolbar:o,TextArea:r.a.createElement(u.ReactMdeTextArea,{onChange:this.handleValueChange,value:{text:a},textAreaProps:{style:{overflowY:"auto",resize:"vertical"}},textAreaRef:function(t){return e.textArea=t}}),Preview:r.a.createElement(p,{body:a,fullWidth:!0}),LiveHelper:l,value:a}):r.a.createElement(E,{Toolbar:o,TextArea:i,Preview:s,LiveHelper:l})}}]),t}(r.a.Component),j=(a(1228),a(1229),w);t.a=function(e){var t=e.input,a=e.disabled,n=e.error,o=e.touched,i=e.tabIndex,s=e.toggledStyle,l=e.meta,c=void 0===l?{}:l,u=n&&o&&!a||c.error&&c.touched,m=c.warning;return r.a.createElement("div",{className:"ffmarkdown-editor"},r.a.createElement("div",{className:"ffeditor usertext"},r.a.createElement(j,{value:t.value,onChange:t.onChange,tabIndex:i,toggledStyle:s})),r.a.createElement("div",{className:"input-subline"},u&&r.a.createElement("div",{className:"input-error"},c.error||n)||m&&r.a.createElement("div",{className:"input-warning"},m)))}},572:function(e,t,a){"use strict";var n=a(29),r=a(0),o=a.n(r),i=a(1239),s=a.n(i),l=a(1242),c=a.n(l),u=(a(1243),a(1244),a(134)),m=function(e){var t=e.value,a=e.onChange,i=e.readOnly,l=e.userRate,m=Object(r.useState)([]),d=Object(n.a)(m,2),p=d[0],h=d[1],f=Object(r.useState)(l),b=Object(n.a)(f,2),v=b[0],y=b[1],g=function(e){var t=Object(u.f)(p,e,l).grid,n=Object(u.b)(t);a(n)};v!==l&&(y(l),g([{col:u.a}]));Object(r.useEffect)(function(){var e=Object(u.c)(t,i);h(e)},[t,i]);var E=p&&p.length<=3;return o.a.createElement("div",{className:"sheet-container"},o.a.createElement(s.a,{data:p,valueRenderer:function(e){return e.value},onContextMenu:function(e,t){return t.readOnly?e.preventDefault():null},onCellsChanged:g}),!i&&o.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",marginTop:"1em"}},o.a.createElement("button",{className:"table-button add-row",onClick:function(e){e.preventDefault();var n=t.concat([Object(u.d)()]);a(n)}},"Add row"),o.a.createElement("button",{className:"table-button remove-row ".concat(E?"disabled":""),onClick:function(e){e.preventDefault(),p.length>3&&a(c()(t,1))}},"Remove row")))};m.defaultProps={readOnly:!1};var d=m;t.a=d}}]);
//# sourceMappingURL=App.b9c83e63.chunk.js.map