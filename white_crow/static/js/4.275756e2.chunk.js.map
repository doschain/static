{"version":3,"sources":["service/index.js","../node_modules/classnames/index.js","../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","pages/Matrix/matrix.js","pages/Matrix/contant.js","pages/Matrix/index.js"],"names":["hosts","window","location","host","getUser","address","demos","request","method","url","bindCode","code","data","activeUser","rawtx","getMatrixList","addr","type","doBuyMatrix","id","hasOwn","hasOwnProperty","classNames","classes","i","arguments","length","arg","argType","push","Array","isArray","inner","apply","key","call","join","module","exports","default","_toConsumableArray","arr","arr2","iter","Symbol","iterator","Object","prototype","toString","from","TypeError","MatrixX3","props","No","price","status","children","className","onTap","cx","onClick","cart","hide","lock","map","item","fill","MatrixX4","slice","MATRIX_X3_DATA","num","repeat","hash","MATRIX_X4_DATA","connect","useContext","GlobalContext","useState","matrix","setMatrix","showValidate","setData","useEffect","newData","index","Math","pow","switchMatrix","x","title","active","visible","showClose"],"mappings":"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","file":"static/js/4.275756e2.chunk.js","sourcesContent":["// import {axios} from '../utils'\n// import {toast} from \"../utils\"\nlet hosts = \"http://proxy-mainnet.doschain.org/insight\";\n// let hosts2 = \"http://mainnet.doschain.org/insight\";\nif (window.location.host !== \"games.doschain.org\") {\n  hosts = \"http://35.220.198.141:8087\";\n  // hosts = \"http://10.0.0.15:8083\";\n  // hosts2 = \"https://testnet.doschain.org/insight\";\n}\n\nasync function requestWrapper(request) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      var res = await request;\n      resolve(JSON.parse(res));\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\n/** 用户信息 **/\nexport const getUser = (address) => {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/user/${address}`,\n  });\n};\n\n/** 绑定 **/\nexport const bindCode = (address, code) => {\n  return window.demos.request({\n    method: \"POST\",\n    url: `${hosts}/v1/api/user/${address}/bind`,\n    data: { code },\n  });\n};\n\n/** 激活 **/\nexport const activeUser = (address, rawtx) => {\n  return window.demos.request({\n    method: \"POST\",\n    url: `${hosts}/v1/api/user/${address}/active`,\n    data: { rawtx },\n  });\n};\n\n/** 示例 **/\nexport const requestExample = (price, num, code) => {\n  return requestWrapper(window.demos.allin.submit(price, num - 0, code, \"\"));\n};\n\n/** 矩阵列表 **/\nexport const getMatrixList = ({ addr, type = 0 }) => {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/matrix/${addr}/${type}`,\n  });\n};\n\n/** 购买矩阵 **/\nexport const doBuyMatrix = ({ id, addr, type }) => {\n  return window.demos.request({\n    method: \"POST\",\n    url: `${hosts}/v1/api/matrix/${addr}/${type}/${id}/pay`,\n  });\n};\n","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}","export default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}","import React from \"react\";\nimport cx from \"classnames\";\nimport \"./matrix.scss\";\n\n// X3矩阵\nfunction MatrixX3(props) {\n  const {\n    No,\n    price = 0,\n    status = 1,\n    children,\n    className,\n    onTap = () => {},\n  } = props;\n\n  return (\n    <div className={`x3-x4__matrix ${className}`}>\n      <div\n        className={cx({\n          \"x-button\": 1,\n          [`status_${status}`]: 1,\n        })}\n        onClick={onTap}\n      >\n        <span className=\"No\">{No}</span>\n        <span className=\"price\">{price}</span>\n        <span className={cx({ cart: 1, hide: status !== 2 })}>BUY</span>\n        <i className={cx({ lock: 1, hide: status !== 1 })} />\n      </div>\n      <div className=\"x3-children\">\n        {children.map((item, i) => (\n          <div\n            key={i.toString()}\n            className={cx({ \"x-child\": 1, fill: item })}\n          />\n        ))}\n      </div>\n      <div className=\"x3-barnchs\">\n        <div>\n          <div className=\"top\" />\n          <div className=\"bottom\" />\n        </div>\n        <div />\n        <div>\n          <div className=\"top\" />\n          <div className=\"bottom\" />\n        </div>\n      </div>\n      <div className=\"x-info\">\n        <span>0</span>\n        <span>0</span>\n      </div>\n    </div>\n  );\n}\n\n// X4矩阵\nfunction MatrixX4(props) {\n  const {\n    No,\n    children,\n    status = 1,\n    price = 0,\n    className,\n    onTap = () => {},\n  } = props;\n\n  return (\n    <div className={`x3-x4__matrix ${className}`}>\n      <div\n        className={cx({\n          \"x-button\": 1,\n          [`status_${status}`]: 1,\n        })}\n        onClick={onTap}\n      >\n        <span className=\"No\">{No}</span>\n        <span className=\"price\">{price}</span>\n        <span className={cx({ cart: 1, hide: status !== 2 })}>BUY</span>\n        <i className={cx({ lock: 1, hide: status == 2 })} />\n      </div>\n      <div className=\"x4-branchs-level1\">\n        <div className=\"line\" />\n        <div className=\"rect\" />\n      </div>\n      <div className=\"x4-children__level1\">\n        {children.slice(0, 2).map((item, i) => (\n          <div\n            key={i.toString()}\n            className={cx({ \"x-child\": 1, fill: item })}\n          />\n        ))}\n      </div>\n      <div className=\"x4-branchs-level2\">\n        <div />\n        <div />\n        <div />\n        <div />\n      </div>\n      <div className=\"x4-children__level2\">\n        {children.slice(1).map((item, i) => (\n          <div\n            key={i.toString()}\n            className={cx({ \"x-child\": 1, fill: item })}\n          />\n        ))}\n      </div>\n      <div className=\"x-info\">\n        <span>0</span>\n        <span>0</span>\n      </div>\n    </div>\n  );\n}\n\nexport { MatrixX3, MatrixX4 };\n","// X3矩阵数据\nconst MATRIX_X3_DATA = [\n  {\n    id: 1,\n    No: 1, //矩阵ID\n    status: 1, //当前矩阵的状态1:不可以否买，2:可购买，3：已购买\n    children: [0, 0, 0],\n    num: 0, // 邀请人数\n    repeat: 0, // 轮询次数\n    hash: \"\", // 交易hash\n  },\n  {\n    id: 2,\n    No: 2,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 3,\n    No: 3,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 4,\n    No: 4,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 5,\n    No: 5,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 6,\n    No: 6,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 7,\n    No: 7,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 8,\n    No: 8,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 9,\n    No: 9,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 10,\n    No: 10,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 11,\n    No: 11,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 12,\n    No: 12,\n    status: 1,\n    children: [0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n];\n\n// X4矩阵数据\nconst MATRIX_X4_DATA = [\n  {\n    id: 1,\n    No: 1, //矩阵ID\n    status: 1, //当前矩阵的状态1:不可以否买，2:可购买，3：已购买\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0, // 邀请人数\n    repeat: 0, // 轮询次数\n    hash: \"\", // 交易hash\n  },\n  {\n    id: 2,\n    No: 2,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 3,\n    No: 3,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 4,\n    No: 4,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 5,\n    No: 5,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 6,\n    No: 6,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 7,\n    No: 7,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 8,\n    No: 8,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 9,\n    No: 9,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 10,\n    No: 10,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 11,\n    No: 11,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n  {\n    id: 12,\n    No: 12,\n    status: 1,\n    children: [0, 0, 0, 0, 0, 0],\n    num: 0,\n    repeat: 0,\n    hash: \"\",\n  },\n];\nexport { MATRIX_X3_DATA, MATRIX_X4_DATA };\n","import React, { useState, useEffect, useContext } from \"react\";\nimport cx from \"classnames\";\nimport { connect, Nav, Card, GlobalContext, Modal } from \"../../components\";\nimport { MatrixX3, MatrixX4 } from \"./matrix\";\nimport { MATRIX_X3_DATA, MATRIX_X4_DATA } from \"./contant\";\nimport { getMatrixList, doBuyMatrix } from \"../../service\";\nimport \"./style.scss\";\n\n// 点亮的节点数组\nconst genLightChildren = (len, num) => {\n  const children = new Array(len).fill(0);\n  for (let i = 0; i < len; i++) {\n    if (i < num) {\n      children[i] = 1;\n    }\n  }\n  return children;\n};\n\nfunction Matrix(props) {\n  const { address } = useContext(GlobalContext);\n  const [matrix, setMatrix] = useState(0);\n  const [showValidate, setShowValidate] = useState(0);\n  const [data, setData] = useState(() => {\n    return matrix === 0 ? [...MATRIX_X3_DATA] : [...MATRIX_X4_DATA];\n  });\n\n  useEffect(() => {\n    const basic_price = 0.25;\n    const newData = data.map((item, index) => {\n      item.price = basic_price * Math.pow(2, index);\n      return item;\n    });\n    setData(newData);\n  }, []);\n\n  // 获取矩阵列表数据\n  const fetch = async () => {\n    const { code, data: list = [] } = await getMatrixList({\n      address, // 钱包地址\n      type: matrix, // 0: X3、1:X4,\n    });\n\n    console.log(\"list\", list);\n\n    if (code !== 200 || list.length === 0) {\n      return;\n    }\n\n    const len = list.length;\n    if (len === 12) {\n      let _data = data.map((item, index) => {\n        if (index < 11) {\n          item.status = 3;\n        } else {\n          item.status = list[11].hash ? 4 : 3;\n        }\n        item.chidren = genLightChildren(matrix === 0 ? 3 : 6, list[index].num);\n        return item;\n      });\n      setData(_data);\n      return;\n    }\n\n    const _data = data.slice();\n    _data.forEach((item, index) => {\n      const current = list.find(({ id }) => id === item.id);\n      // 1:不可购买、2:可购买、3:已购买、4:已支付交易确认中\n      if (current) {\n        _data[index].status = current.hash ? 4 : 3;\n        _data[index] = { ...data[index], ...item };\n        _data.chidren = genLightChildren(matrix === 0 ? 3 : 6, current.num);\n      } else {\n        if (index === len) {\n          _data[index].status = list[len - 1].hash ? 4 : 2;\n        } else {\n          _data[index].status = 1;\n        }\n        _data[index].chidren = genLightChildren(matrix === 0 ? 3 : 6, 0);\n      }\n    });\n    setData(_data);\n  };\n\n  // 购买矩阵\n  const clickDoBuyMatrix = async ({ id, status }) => {\n    if (status === 1) {\n      return props.history(`/detail/${id}`);\n    }\n\n    if (status === 3) return;\n\n    if (status === 4) {\n      setShowValidate(true);\n      validateTrade(\"\");\n      return;\n    }\n\n    // 发起购买请求\n    const params = { addr: address, type: matrix, id };\n    const { code, data } = await doBuyMatrix(params);\n    if (code === 200) {\n      setShowValidate(true);\n      validateTrade(data?.hash);\n    }\n  };\n\n  // 确认交易数\n  const validateTrade = (hash) => {\n    if (!hash) return;\n    let _t = null;\n    try {\n      clearInterval(_t);\n      _t = setInterval(async () => {\n        const { confirmations } = await window.demos.dosdata.chain.transaction(\n          hash\n        );\n        if (confirmations && confirmations > 1) {\n          clearInterval(_t);\n          fetch();\n        }\n      }, 2000);\n    } catch (errMsg) {\n      console.error(errMsg);\n    }\n  };\n\n  const switchMatrix = (x) => {\n    if (x !== matrix) {\n      setMatrix(x);\n    }\n  };\n\n  return (\n    <>\n      <div className=\"matrix-page\">\n        <Nav title=\"矩阵列表\" {...props} />\n        <div className=\"main\">\n          <div className=\"tab\">\n            <button\n              className={cx({ active: matrix === 0 })}\n              onClick={() => switchMatrix(0)}\n            >\n              X3\n            </button>\n            <button\n              className={cx({ active: matrix === 1 })}\n              onClick={() => switchMatrix(1)}\n            >\n              X4\n            </button>\n          </div>\n          <Card className={cx({ \"p-r-20 p-l-20\": matrix == 1 })}>\n            <div className=\"info\">\n              <span>FORSAGE</span>\n              <span>{matrix === 0 ? \"X3\" : \"X4\"}</span>\n            </div>\n            <div className=\"matrix-list\">\n              {data.map((item) =>\n                matrix === 0 ? (\n                  <MatrixX3\n                    key={item.id}\n                    className=\"m-b-80 p-r-20 p-l-20\"\n                    {...item}\n                  />\n                ) : (\n                  <MatrixX4 key={item.id} className=\"m-b-80\" {...item} />\n                )\n              )}\n            </div>\n          </Card>\n        </div>\n      </div>\n      <Modal visible={showValidate} showClose className=\"validatting\">\n        <div className=\"text\">\n          <p>HASH:dsssdsdsndishid </p>\n          <p>校验校验hash数</p>\n        </div>\n        <div className=\"bar\" />\n      </Modal>\n    </>\n  );\n}\n\nexport default connect()(Matrix);\n"],"sourceRoot":""}