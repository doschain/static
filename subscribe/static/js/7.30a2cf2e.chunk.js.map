{"version":3,"sources":["services/network.js","hooks/useNow.js","page/history_detail/history_detail.module.scss","page/history_detail/index.js"],"names":["hosts","getDappList","addr","state","page","limit","category","queryStr","window","demos","request","method","url","getCategorites","getDappDevInfo","getDappInfo","id","fetchBuyDapp","rawtx","gain","code","mail","data","location","host","getOrders","address","getOrdersDetails","useNow","_now","timer","useState","now","setNow","time","clearInterval","setInterval","module","exports","row","label","value","className","styles","HistoryDetail","match","useContext","GlobalContext","wallet_address","params","setData","loading","setLoading","useEffect","then","ret","title","JSON","parse","sessionStorage","name","logo","price","order_time","status","key","e","renderCard","history_detail","hash","return"],"mappings":"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","file":"static/js/7.30a2cf2e.chunk.js","sourcesContent":["let hosts = \"http://proxy-mainnet.doschain.org/insight\";\n// let hosts2 = \"http://mainnet.doschain.org/insight\";\nif (window.location.host !== \"games.doschain.org\") {\n  hosts = \"http://35.220.198.141:8088\";\n  // hosts = \"http://10.0.0.11:8088\";\n  // hosts = \"http://10.0.0.15:8083\";\n  // hosts2 = \"https://testnet.doschain.org/insight\";\n}\n\n/**\n * @param {String} addr 钱包地址\n * @param {String} state 应用类别 0:待申购，1:已申购\n * @param {number} page 当前页码\n * @param {number} limit 一页显示的数量\n * @param {number} category 分类id\n * @description 首页请求dapp应用列表\n */\nexport function getDappList({ addr, state, page, limit, category }) {\n  let queryStr = `${hosts}/v1/api/apps/${addr}/${state}/?page=${page}&limit=${limit}`;\n  if (category) queryStr += `&category=${category}`;\n\n  return window.demos.request({\n    method: \"GET\",\n    url: queryStr,\n  });\n}\n\n/**\n *\n * @description 获取首页分类列表\n */\nexport function getCategorites() {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/category`,\n  });\n}\n\n/**\n *\n * @description 获取首页开发应用的信息\n */\nexport function getDappDevInfo() {\n  return window.demos.request({ method: \"GET\", url: `${hosts}/v1/api/state` });\n}\n\n/**\n *\n * @param {number} id 应用ID\n * @description 获取应用详情信息\n */\nexport function getDappInfo(id) {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/app/${id}`,\n  });\n}\n\n/**\n *\n * @param {String} addr 钱包地址\n * @param {String} raw  待广播交易哈希\n * @param {number} id   应用ID\n * @param {String} gain 收益地址\n * @param {String} code 邀请矿池地址 (非必填)\n * @param {String} mail 邮箱地址\n */\nexport function fetchBuyDapp({ addr, rawtx, id, gain, code, mail }) {\n  return window.demos.request({\n    method: \"POST\",\n    url: `${hosts}/v1/api/app/${addr}/pay`,\n    data: {\n      rawtx,\n      id,\n      gain,\n      code,\n      mail,\n    },\n  });\n}\n\n/**\n * @param {String} address 钱包地址\n * @description 获取订单记录\n */\nexport const getOrders = (address) => {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/orders/${address}`,\n  });\n};\n\n/**\n * @param {String} address 钱包地址\n * @param {String} id 订单id\n * @description 获取订单详情\n */\nexport const getOrdersDetails = (address, id) => {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/order/${address}/${id}`,\n  });\n};\n","import React, {useState, useEffect, useContext} from \"react\";\n\nconst useNow = (_now, timer) => {\n    const [now, setNow] = useState(_now);\n\n    function interval(time) {\n            clearInterval(timer);\n            setNow(time);\n            timer = setInterval(() => {\n                time ++;\n                setNow(time);\n            }, 1000);\n        }\n\n    return [now, interval];\n}\n\nexport default useNow;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"history_detail\":\"history_detail_history_detail__2-KGt\",\"row\":\"history_detail_row__3L5dS\"};","import React, {useContext, useEffect, useState} from \"react\";\nimport styles from \"./history_detail.module.scss\";\nimport {Spin, BasicLayout, DappCard, GlobalContext} from \"../../components\";\nimport {getOrdersDetails} from \"../../services/network\";\nimport useNow from \"../../hooks/useNow\";\nfunction row(label, value) {\n    return (\n        <div className={styles.row}>\n            <div>{label}:</div>\n            <div>{value}</div>\n        </div>\n    );\n}\nlet timer;\nconst HistoryDetail = ({match}) => {\n    const globalStore = useContext(GlobalContext);\n    let address = globalStore.wallet_address;\n    let id = match.params.id;\n    const [data, setData] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const [now, setNow] = useNow(0, timer);\n\n    useEffect( () => {\n        if (!address || !id) return;\n        initData();\n    }, [address]);\n\n    function initData() {\n        setLoading(true);\n        getOrdersDetails(address, id).then((data) => {\n            setLoading(false);\n            if (data.ret) {\n                setData(data.data);\n                setNow(data.time);\n            }\n        });\n    }\n\n    function renderCard () {\n        if (!address && !id) return null;\n        try {\n            let {name, logo, price, order_time, status} = JSON.parse(window.sessionStorage[`dapp_${address}_${id}`]);\n\n            return <DappCard\n                now={now}\n                key={1}\n                name={name}\n                logo={logo}\n                price={price}\n                time={order_time}\n                status={status}\n            />\n        }catch (e) {\n            return null;\n        }\n    }\n\n    return (\n        <BasicLayout title=\"申购详情\">\n            {loading ? <Spin /> : [\n                renderCard(),\n                data && <div className={styles.history_detail} key={2}>\n                    {row('申购hash', data.hash)}\n                    {row('合约地址', data.gain)}\n                    {row('推荐地址', data.code)}\n                    {row('联系邮箱', data.mail)}\n                    {row('回退hash', data.return)}\n                </div>\n                ]}\n        </BasicLayout>\n    );\n};\n\nexport default HistoryDetail;\n"],"sourceRoot":""}