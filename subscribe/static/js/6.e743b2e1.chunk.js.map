{"version":3,"sources":["services/network.js","hooks/useNow.js","page/history/history.module.scss","page/history/index.js"],"names":["hosts","getDappList","addr","state","page","limit","category","queryStr","window","demos","request","method","url","getCategorites","getDappDevInfo","getDappInfo","id","fetchBuyDapp","rawtx","gain","code","mail","data","location","host","getOrders","address","getOrdersDetails","useNow","_now","timer","useState","now","setNow","time","clearInterval","setInterval","module","exports","History","history","useContext","GlobalContext","wallet_address","setData","loading","setLoading","useEffect","then","ret","map","item","order_time","status","title","className","styles","name","logo","price","key","onClick","push","sessionStorage","JSON","stringify"],"mappings":"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","file":"static/js/6.e743b2e1.chunk.js","sourcesContent":["let hosts = \"http://proxy-mainnet.doschain.org/insight\";\n// let hosts2 = \"http://mainnet.doschain.org/insight\";\nif (window.location.host !== \"games.doschain.org\") {\n  hosts = \"http://35.220.198.141:8088\";\n  // hosts = \"http://10.0.0.11:8088\";\n  // hosts = \"http://10.0.0.15:8083\";\n  // hosts2 = \"https://testnet.doschain.org/insight\";\n}\n\n/**\n * @param {String} addr 钱包地址\n * @param {String} state 应用类别 0:待申购，1:已申购\n * @param {number} page 当前页码\n * @param {number} limit 一页显示的数量\n * @param {number} category 分类id\n * @description 首页请求dapp应用列表\n */\nexport function getDappList({ addr, state, page, limit, category }) {\n  let queryStr = `${hosts}/v1/api/apps/${addr}/${state}/?page=${page}&limit=${limit}`;\n  if (category) queryStr += `&category=${category}`;\n\n  return window.demos.request({\n    method: \"GET\",\n    url: queryStr,\n  });\n}\n\n/**\n *\n * @description 获取首页分类列表\n */\nexport function getCategorites() {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/category`,\n  });\n}\n\n/**\n *\n * @description 获取首页开发应用的信息\n */\nexport function getDappDevInfo() {\n  return window.demos.request({ method: \"GET\", url: `${hosts}/v1/api/state` });\n}\n\n/**\n *\n * @param {number} id 应用ID\n * @description 获取应用详情信息\n */\nexport function getDappInfo(id) {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/app/${id}`,\n  });\n}\n\n/**\n *\n * @param {String} addr 钱包地址\n * @param {String} raw  待广播交易哈希\n * @param {number} id   应用ID\n * @param {String} gain 收益地址\n * @param {String} code 邀请矿池地址 (非必填)\n * @param {String} mail 邮箱地址\n */\nexport function fetchBuyDapp({ addr, rawtx, id, gain, code, mail }) {\n  return window.demos.request({\n    method: \"POST\",\n    url: `${hosts}/v1/api/app/${addr}/pay`,\n    data: {\n      rawtx,\n      id,\n      gain,\n      code,\n      mail,\n    },\n  });\n}\n\n/**\n * @param {String} address 钱包地址\n * @description 获取订单记录\n */\nexport const getOrders = (address) => {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/orders/${address}`,\n  });\n};\n\n/**\n * @param {String} address 钱包地址\n * @param {String} id 订单id\n * @description 获取订单详情\n */\nexport const getOrdersDetails = (address, id) => {\n  return window.demos.request({\n    method: \"GET\",\n    url: `${hosts}/v1/api/order/${address}/${id}`,\n  });\n};\n","import React, {useState, useEffect, useContext} from \"react\";\n\nconst useNow = (_now, timer) => {\n    const [now, setNow] = useState(_now);\n\n    function interval(time) {\n            clearInterval(timer);\n            setNow(time);\n            timer = setInterval(() => {\n                time ++;\n                setNow(time);\n            }, 1000);\n        }\n\n    return [now, interval];\n}\n\nexport default useNow;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"history\":\"history_history__2fjli\"};","import React, {useState, useEffect, useContext} from \"react\";\nimport styles from \"./history.module.scss\";\nimport {Spin, BasicLayout, DappCard, GlobalContext} from \"../../components\";\nimport { getOrders } from \"../../services/network\";\nimport useNow from \"../../hooks/useNow\";\nlet timer;\nconst History = ({history}) => {\n    const globalStore = useContext(GlobalContext);\n    let address = globalStore.wallet_address;\n    const [data, setData] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [now, setNow] = useNow(0, timer);\n\n    useEffect( () => {\n        if (!address) return;\n        initData();\n    }, [address]);\n\n    function initData() {\n        setLoading(true);\n        getOrders(address).then((data) => {\n            setLoading(false);\n            if (data.ret) {\n\n                setData((data.data || []).map((item) => {\n                    // item.status; // 0: 申购中 1: 申购成功 2: 申购失败\n                    if (item.order_time >= 0) {\n                        item.status = 0;\n                    } else {\n                        item.status = 1;\n                    }\n                    if(item.state === 1) {\n                        item.status = 2\n                    }\n                    return item;\n                }));\n                setNow(data.time);\n            }\n        });\n    }\n\n    return (\n        <BasicLayout title=\"DAPP申购记录\">\n            {loading ? <Spin /> : <div className={styles.history}>\n                {data.map((item) => {\n                    let {id, name, logo, price, order_time, status} = item;\n                    return <DappCard\n                        now={now}\n                        key={id}\n                        id={id}\n                        name={name}\n                        logo={logo}\n                        price={price}\n                        time={order_time}\n                        status={status}\n                        onClick={(id) => {\n                            history.push(`/history_detail/${id}`);\n                            window.sessionStorage[`dapp_${address}_${id}`] = JSON.stringify(item);\n                        }}\n                    />\n                })}\n            </div>}\n\n        </BasicLayout>\n    );\n};\n\nexport default History;\n"],"sourceRoot":""}